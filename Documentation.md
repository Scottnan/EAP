# Documentation

## Module

### portfolio_analysis

This package is used for portfolio analysis  including 4 steps:

1. select breakpoints
2. distribute the assets into groups
3. calculate the average and difference of groups
4. present the result

#### class ptf_analysis()

This class is for portfolio analysis containing few functions.

##### def select_breakpoints(self, character, number, perc=*None*):

This function, corresponding to the step 1,  selects the breakpoints of the sample.

**input : ** 

 *character :*  The asset characteristic by which the assets are grouped. 

 *number :* The number of the breakpoint and the number of interval is *number+1*. Once the number is given, the assets would be grouped into *number+1* groups by the average partition of the asset characteristic.  

*perc* : That perc is a list of number, represents the percentiles of the characteristic by which group the assets. Once it is set, then  *number* is invalid.     

**output :** 

*breakpoint :*  The breakpoint is the percentiles of the asset characteristic, ranging from 0% to 100%, whose in length is *number+2*.

**Example**

```python
from EAP.portfolio_analysis import Ptf_analysis as ptfa
import matplotlib.pyplot as plt
import numpy as np

# generate characteristics
character = np.random.normal(0, 100, 10000)
# generate breakpoint
breakpoint = ptfa().slect_breakpoint(character=character, number=9)
print('Breakpoint:', breakpoint)
# comapre with the true breakpoint
for i in np.linspace(0, 100, 11):
        print('True breakpoint', i, '%:', np.percentile(character,i))

========================================================================
Generated breakpoint: [-418.25352494 -127.85494153  -84.90868131  -53.27163604  -25.2394311   1.74938872   25.93867426   50.87047751   84.42711213  128.52009426  334.42181608]
True breakpoint 0.0 %: -418.25352493659074
True breakpoint 10.0 %: -127.85494153240666
True breakpoint 20.0 %: -84.90868130631613
True breakpoint 30.0 %: -53.271636036097135
True breakpoint 40.0 %: -25.239431099072657
True breakpoint 50.0 %: 1.7493887248228535
True breakpoint 60.0 %: 25.938674261710755
True breakpoint 70.0 %: 50.870477505977846
True breakpoint 80.0 %: 84.42711212754239
True breakpoint 90.0 %: 128.5200942602427
True breakpoint 100.0 %: 334.42181607589504
========================================================================
```



##### def distribute(self, character, breakpoint):

This function, corresponding to the step 2, distributes the assets into groups by characteristics  grouped by the breakpoint.

**input :**  

*character :* The characteristic by which the assets are grouped.

*breakpoint :*  The breakpoint of the characteristic.

**output : **

*label :*  an array containing the group number of each asset.

**Example**

```python
# continue the previous code
# generate the groups     
print('The Label of unique value:\n', np.sort(np.unique(ptfa().distribute(character, breakpoint))))
# plot the histogram of the label 
# each group have the same number of samples
plt.hist(ptfa().distribute(character, breakpoint))
label = ptfa().distribute(character, breakpoint)[:, 0]
# print the label
print('Label:\n', ptfa().distribute(character, breakpoint))
========================================================================
The Label of unique value:
 [0. 1. 2. 3. 4. 5. 6. 7. 8. 9.]
Label:
 [[2.]
 [8.]
 [1.]
 ...
 [1.]
 [4.]
 [8.]]
```



##### def average(self, sample_return, label):

This function, corresponding to the step 3, calculates the average return for each group.

**input :**

*sample_return :* The return of each asset

*label :* The group label of each asset

**output :**

*average_return :* The average return of each group

**Example**

```python
# continue the previous code
# generate the future sample return
sample_return = character/100 + np.random.normal()
ave_ret = ptfa().average(sample_return, label)
# print the groups return
print('average return for groups:\n', ave_ret)
========================================================================
average return for groups:
 [[-1.47855293]
 [-0.75343815]
 [-0.39540537]
 [-0.0971466 ]
 [ 0.17474793]
 [ 0.42303036]
 [ 0.68905747]
 [ 0.95962212]
 [ 1.33445632]
 [ 2.03728439]]
```



#### class Univariate(ptf_analysis):

This class is designed for univariate portfolio analysis.

##### def \__init__ (self, sample, number, perc=None, factor=None, maxlag=12):

The initialization function

**input :**

*sample :*  The samples to be analyzed. Samples usually contain the future return, characteristics, time. The **DEFAULT** setting is the *1th* column is the forecast return, the *2nd* column is the characteristic, the *3rd* column or the index(if data type is Dataframe) is time label.

*number :*  The breakpoint number.

*perc :*  The breakpoint percentiles.

*factor :* The risk factor used to adjust the asset return.

*maxlag :*  The maximum lag for Newey-West adjustment.

##### def divide_by_time(self):

This function groups the sample by time.

**output :** 

*groups_by_time :* The samples group by time.

##### def average_by_time(self):

This function, using the sample group by time from function *divide_by_time*, groups the sample by the characteristic, and then calculate average return of each group samples at every time point. 

**output :** 

*average_group_time(matrix: N_T) :* The average return of groups by each characteristic-time pair.

**Example**

```python
import numpy as np
from portfolio_analysis import Univariate as uni
    
# generate time 
year=np.ones((3000,1),dtype=int)*2020
for i in range(19):
    year=np.append(year,(2019-i)*np.ones((3000,1),dtype=int))
    
# generate character
character=np.random.normal(0,1,20*3000)
# generate future return
ret=character*-0.5+np.random.normal(0,1,20*3000)
# create sample containing future return, character, time
sample=np.array([ret,character,year]).T
# initializ the univariate object
exper=uni(sample,9)
# 
data=exper.average_by_time()
print(data)
==========================================================================================================================
[[ 0.82812256  0.87549215  0.81043114  0.77480366  0.85232487  0.85599445   0.90860961  0.76600211  0.91360546  0.85921985  0.96717798  0.77677131   0.88669273  0.86895145  0.97832435  0.88494486  0.82571951  0.84777939   0.89373487  0.95906454]
 [ 0.51155724  0.4963439   0.6100762   0.47351625  0.46844971  0.53303287   0.52087477  0.43934316  0.51169633  0.61918844  0.56254028  0.50949226   0.39033219  0.49685445  0.5844816   0.48723354  0.49861094  0.43197525   0.40040156  0.57529228]
 [ 0.41566251  0.3421546   0.27117215  0.35550346  0.28884636  0.43710998   0.33146264  0.27860032  0.35956881  0.34818479  0.35692361  0.42462374   0.16909231  0.33823117  0.31762348  0.44863438  0.42785283  0.20093775   0.29664738  0.31509963]
 [ 0.21972246  0.24685649  0.29933776  0.09880866  0.13564638  0.17673649   0.14251437  0.12188551  0.1567432   0.20428427  0.15009782  0.08488247   0.20489871  0.10598241  0.12591301  0.17287433  0.11180376  0.09941738   0.22635281  0.22828588]
 [ 0.01851548  0.05771421  0.0624163   0.05368921  0.15247324  0.05839522   0.05864669  0.01863668 -0.08367879  0.09273579  0.18374921  0.12331214   0.03635538  0.05804576  0.0116589  -0.04158565  0.11655945  0.09727234   0.14038867  0.13594649]
 [-0.07910789 -0.04670755  0.08732773 -0.07361966 -0.00232509 -0.08546681  -0.15020487 -0.05302521 -0.07922696 -0.1088824  -0.01700017 -0.06742183   0.00190131  0.00961174 -0.05953252 -0.09504501 -0.0958816  -0.00355493  -0.08553405 -0.05343558]
 [-0.13094033 -0.23888179 -0.11046595 -0.11176528 -0.14017103 -0.17184142  -0.26587781 -0.14426219 -0.15687278 -0.15962335 -0.18586504 -0.2367552  -0.26761165 -0.16169935 -0.26608677 -0.16202763 -0.24272797 -0.17049684  -0.21470737 -0.13520545]
 [-0.35621842 -0.28111488 -0.42057927 -0.37219582 -0.25449753 -0.36362452  -0.34165952 -0.28564624 -0.29936621 -0.32545156 -0.28208242 -0.36730096  -0.24269836 -0.31584032 -0.34207757 -0.35185102 -0.35515763 -0.32239715  -0.2803911  -0.36334961]
 [-0.58529295 -0.54329245 -0.52006031 -0.49856708 -0.44262707 -0.4464171  -0.58846501 -0.56725297 -0.35845646 -0.52923391 -0.42119445 -0.55659388  -0.47716067 -0.4574991  -0.52123094 -0.54767832 -0.50289813 -0.45529132  -0.58429513 -0.48110405]
 [-0.81992395 -0.95766159 -0.92069685 -0.92906348 -0.84891875 -0.81670916  -0.90281776 -0.84845902 -0.90479169 -0.86860559 -0.96790821 -0.9464988  -0.88176205 -0.96118242 -0.92402295 -0.81623283 -0.81560442 -0.85841478  -0.87337267 -0.8070857 ]]
```



##### def difference(self, average_group):

This functions calculates the difference of group return, which, in detail, is the last group average return minus the first group average return. 

 **input :** 

*average_group :* The average return of groups by each characteristic-time pair.

**output :**

*result :* The matrix added with the difference of average group return.

##### def factor_adjustment(self, result):

This function calculates the group return adjusted by risk factors.

**input :**

*result :* The return table with difference sequence.

**output :**

*alpha :* The anomaly

*ttest :* The t-value of the anomaly.

##### def summary_and_test(self):

This function summarizes the result and take t-test.

**output : **

*self.average :* The average of the portfolio return across time.

*self.ttest :* The t-value of the portfolio return across time.

##### def print_summary_by_time(self, export):

This function print the summary grouped by time.

**input :**

*export :* Export the table or not. The table is exported in form of Dataframe. The default setting is **False.**

**output :**

*df :* The table exported in form of Dataframe.

##### def print_summary(self, export):

This function print the summary grouped by characteristic and averaged by time.

**input :**

*export :* Export the table or not. The table is exported in form of Dataframe. The default setting is **False.**

**output :**

*df :* The table exported in form of Dataframe.

**Example**

```python
# continue the previous code
exper.summary_and_test()
exper.print_summary_by_time()
========================================================================================================
+--------+-------+-------+-------+-------+--------+--------+--------+--------+--------+--------+--------+
|  Time  |   1   |   2   |   3   |   4   |   5    |   6    |   7    |   8    |   9    |   10   |  diff  |
+--------+-------+-------+-------+-------+--------+--------+--------+--------+--------+--------+--------+
| 2001.0 | 0.828 | 0.512 | 0.416 |  0.22 | 0.019  | -0.079 | -0.131 | -0.356 | -0.585 | -0.82  | -1.648 |
| 2002.0 | 0.875 | 0.496 | 0.342 | 0.247 | 0.058  | -0.047 | -0.239 | -0.281 | -0.543 | -0.958 | -1.833 |
| 2003.0 |  0.81 |  0.61 | 0.271 | 0.299 | 0.062  | 0.087  | -0.11  | -0.421 | -0.52  | -0.921 | -1.731 |
| 2004.0 | 0.775 | 0.474 | 0.356 | 0.099 | 0.054  | -0.074 | -0.112 | -0.372 | -0.499 | -0.929 | -1.704 |
| 2005.0 | 0.852 | 0.468 | 0.289 | 0.136 | 0.152  | -0.002 | -0.14  | -0.254 | -0.443 | -0.849 | -1.701 |
| 2006.0 | 0.856 | 0.533 | 0.437 | 0.177 | 0.058  | -0.085 | -0.172 | -0.364 | -0.446 | -0.817 | -1.673 |
| 2007.0 | 0.909 | 0.521 | 0.331 | 0.143 | 0.059  | -0.15  | -0.266 | -0.342 | -0.588 | -0.903 | -1.811 |
| 2008.0 | 0.766 | 0.439 | 0.279 | 0.122 | 0.019  | -0.053 | -0.144 | -0.286 | -0.567 | -0.848 | -1.614 |
| 2009.0 | 0.914 | 0.512 |  0.36 | 0.157 | -0.084 | -0.079 | -0.157 | -0.299 | -0.358 | -0.905 | -1.818 |
| 2010.0 | 0.859 | 0.619 | 0.348 | 0.204 | 0.093  | -0.109 | -0.16  | -0.325 | -0.529 | -0.869 | -1.728 |
| 2011.0 | 0.967 | 0.563 | 0.357 |  0.15 | 0.184  | -0.017 | -0.186 | -0.282 | -0.421 | -0.968 | -1.935 |
| 2012.0 | 0.777 | 0.509 | 0.425 | 0.085 | 0.123  | -0.067 | -0.237 | -0.367 | -0.557 | -0.946 | -1.723 |
| 2013.0 | 0.887 |  0.39 | 0.169 | 0.205 | 0.036  | 0.002  | -0.268 | -0.243 | -0.477 | -0.882 | -1.768 |
| 2014.0 | 0.869 | 0.497 | 0.338 | 0.106 | 0.058  |  0.01  | -0.162 | -0.316 | -0.457 | -0.961 | -1.83  |
| 2015.0 | 0.978 | 0.584 | 0.318 | 0.126 | 0.012  | -0.06  | -0.266 | -0.342 | -0.521 | -0.924 | -1.902 |
| 2016.0 | 0.885 | 0.487 | 0.449 | 0.173 | -0.042 | -0.095 | -0.162 | -0.352 | -0.548 | -0.816 | -1.701 |
| 2017.0 | 0.826 | 0.499 | 0.428 | 0.112 | 0.117  | -0.096 | -0.243 | -0.355 | -0.503 | -0.816 | -1.641 |
| 2018.0 | 0.848 | 0.432 | 0.201 | 0.099 | 0.097  | -0.004 | -0.17  | -0.322 | -0.455 | -0.858 | -1.706 |
| 2019.0 | 0.894 |  0.4  | 0.297 | 0.226 |  0.14  | -0.086 | -0.215 | -0.28  | -0.584 | -0.873 | -1.767 |
| 2020.0 | 0.959 | 0.575 | 0.315 | 0.228 | 0.136  | -0.053 | -0.135 | -0.363 | -0.481 | -0.807 | -1.766 |
+--------+-------+-------+-------+-------+--------+--------+--------+--------+--------+--------+--------+

exper.print_summary()
==================================================================================================================
+---------+--------+--------+--------+--------+-------+--------+---------+---------+---------+---------+---------+
|  Group  |   1    |   2    |   3    |   4    |   5   |   6    |    7    |    8    |    9    |    10   |   Diff  |
+---------+--------+--------+--------+--------+-------+--------+---------+---------+---------+---------+---------+
| Average | 0.867  | 0.506  | 0.336  | 0.166  | 0.068 | -0.053 |  -0.184 |  -0.326 |  -0.504 |  -0.883 |  -1.75  |
|  T-Test | 63.706 | 35.707 | 20.199 | 12.637 |  4.6  | -4.463 | -15.616 | -32.172 | -36.497 | -73.162 | -92.152 |
+---------+--------+--------+--------+--------+-------+--------+---------+---------+---------+---------+---------+

# generate factor
factor=np.random.normal(0,1.0,(20,1))
exper=uni(sample,9,factor=factor,maxlag=12)
# print(exper.summary_and_test()) # if needed
exper.print_summary()
====================================================================================================================
+---------+--------+--------+--------+--------+-------+---------+---------+---------+---------+---------+----------+
|  Group  |   1    |   2    |   3    |   4    |   5   |    6    |    7    |    8    |    9    |    10   |   Diff   |
+---------+--------+--------+--------+--------+-------+---------+---------+---------+---------+---------+----------+
| Average | 0.867  | 0.506  | 0.336  | 0.166  | 0.068 |  -0.053 |  -0.184 |  -0.326 |  -0.504 |  -0.883 |  -1.75   |
|  T-Test | 63.706 | 35.707 | 20.199 | 12.637 |  4.6  |  -4.463 | -15.616 | -32.172 | -36.497 | -73.162 | -92.152  |
|  Alpha  | 0.869  | 0.507  | 0.336  | 0.164  | 0.067 |  -0.054 |  -0.184 |  -0.326 |  -0.503 |  -0.883 |  -1.752  |
| Alpha-T | 62.39  | 69.24  | 43.377 | 16.673 | 8.204 | -12.372 | -16.679 | -65.704 | -87.618 | -93.223 | -139.881 |
+---------+--------+--------+--------+--------+-------+---------+---------+---------+---------+---------+----------+
```

 

#### class Bivariate(ptf_analysis):

##### def \__init__(self, sample, number, perc=*None*, factor=*None*, maxlag=*12*):

This function initializes the class Bivariate

**input :**

*sample :* The samples to be analyzed. Samples usually contain the future return, characteristics, time. The **DEFAULT** setting is the *1th* column is the forecast return, the *2nd* column is the first characteristic, the *3rd* column is the second characteristic, the *4th* column or the index(if data type is Dataframe) is time label.

*number :*  The breakpoint number.

*perc :*  The breakpoint percentiles.

*factor :* The risk factor used to adjust the asset return.

*maxlag :*  The maximum lag for Newey-West adjustment.

##### def divide_by_time(self):

This function groups the sample by time.

**output :** 

*groups_by_time :* The samples group by time.

##### def average_by_time(self):

This function, using the sample group by time from function *divide_by_time*, groups the sample by the characteristic, and then calculate average return of each group samples at every time point. 

**output :** 

*average_group_time(matrix: N_N_T) :* The average return of groups by each characteristic pair indexed by time.

**Example**

```python
import numpy as np
from portfolio_analysis import Bivariate as bi
    
# generate time 
year = np.ones((3000,1), dtype=int)*2020
for i in range(19):
    year = np.append(year, (2019-i)*np.ones((3000,1), dtype=int))
    
# generate character
character_1 = np.random.normal(0, 1, 20*3000)
character_2 = np.random.normal(0, 1, 20*3000)

# generate future return
ret=character_1*-0.5 + character_2*0.5 + np.random.normal(0,1,20*3000)
# create sample containing future return, character, time
sample=np.array([ret,character_1, character_2, year]).T
print(sample)
# generate the Univiriate Class
exper=bi(sample,9)
# test function divide_by_time
group_by_time = exper.divide_by_time()
print(group_by_time)
# test function average_by_time
average_group_time = exper.average_by_time()
print(average_group_time)
print(np.shape(average_group_time))
========================================================================
[[-1.248 -0.723 -0.526 2020.000]
 [0.739 0.058 1.388 2020.000]
 [1.711 -1.081 0.348 2020.000]
 ...
 [-0.906 1.128 -2.996 2001.000]
 [-1.240 0.781 -0.451 2001.000]
 [-0.216 0.907 -1.086 2001.000]]
group by time: 
 [array([[0.522, 0.420, -1.185, 2001.000],
       [0.381, -0.954, -2.045, 2001.000],
       [1.086, -1.116, 1.017, 2001.000],
       ...,
       [-0.906, 1.128, -2.996, 2001.000],
       [-1.240, 0.781, -0.451, 2001.000],
       [-0.216, 0.907, -1.086, 2001.000]]), array([[-1.170, 1.635, 0.001, 2002.000],
       [0.852, -1.479, 0.878, 2002.000],
       [-0.080, 0.403, 0.547, 2002.000],
       ...,
       [0.308, -0.107, 0.261, 2002.000],
       [0.301, -2.221, 1.165, 2002.000],
       [-2.017, 0.576, 0.726, 2002.000]]), array([[-0.371, 1.792, 1.310, 2003.000],
       [0.815, -1.668, 0.022, 2003.000],
       [2.301, 0.324, 0.586, 2003.000],
       ...,
       [1.337, -1.082, -0.890, 2003.000],
       [-0.447, 1.330, 0.707, 2003.000],
       [2.666, -1.206, 0.232, 2003.000]]), array([[-0.430, 0.654, 0.543, 2004.000],
       [1.787, 0.772, 1.571, 2004.000],
       [2.241, -0.778, 1.403, 2004.000],
       ...,
       [0.290, -0.513, 0.026, 2004.000],
       [1.303, -0.173, 2.936, 2004.000],
       [-0.064, 0.986, 0.777, 2004.000]]), array([[-0.966, -0.162, -0.747, 2005.000],
       [1.395, 1.247, 0.257, 2005.000],
       [0.850, -2.563, -1.314, 2005.000],
       ...,
       [-1.148, -0.395, -1.396, 2005.000],
       [-2.013, 1.442, -2.360, 2005.000],
       [0.753, -0.533, -0.829, 2005.000]]), array([[-0.351, 0.771, 0.764, 2006.000],
       [-0.338, 0.545, 0.719, 2006.000],
       [-0.853, -0.271, 0.107, 2006.000],
       ...,
       [-1.302, 1.416, -0.656, 2006.000],
       [1.233, 0.318, 0.925, 2006.000],
       [0.169, 0.571, 0.703, 2006.000]]), array([[-1.335, 0.054, -1.674, 2007.000],
       [-1.760, -0.648, -1.320, 2007.000],
       [-0.783, -0.507, -0.527, 2007.000],
       ...,
       [0.703, -0.111, -0.153, 2007.000],
       [-1.252, 0.056, 1.051, 2007.000],
       [-1.914, 1.627, -2.030, 2007.000]]), array([[1.767, -0.743, 1.614, 2008.000],
       [0.364, -0.737, 0.141, 2008.000],
       [-0.691, -0.299, -1.860, 2008.000],
       ...,
       [-0.490, -0.202, -0.279, 2008.000],
       [0.982, -0.508, -0.415, 2008.000],
       [0.380, -0.796, -0.756, 2008.000]]), array([[-1.207, 1.881, -1.727, 2009.000],
       [0.848, -0.094, 0.782, 2009.000],
       [-1.822, 1.992, 0.239, 2009.000],
       ...,
       [1.484, -2.619, 0.840, 2009.000],
       [0.530, 0.929, 0.644, 2009.000],
       [-1.095, 2.209, -0.606, 2009.000]]), array([[-1.747, 0.447, -1.597, 2010.000],
       [-1.092, 0.321, 1.201, 2010.000],
       [-0.398, 0.282, 0.574, 2010.000],
       ...,
       [3.040, -0.083, 1.477, 2010.000],
       [1.221, 0.182, 2.531, 2010.000],
       [0.722, -0.342, -0.096, 2010.000]]), array([[0.134, 0.632, -0.437, 2011.000],
       [0.679, 0.649, 0.097, 2011.000],
       [-0.440, -0.798, -1.114, 2011.000],
       ...,
       [-2.137, 2.317, -1.015, 2011.000],
       [0.792, 0.309, 0.440, 2011.000],
       [1.685, -0.949, -0.092, 2011.000]]), array([[-0.727, 0.941, 1.412, 2012.000],
       [-0.052, 0.951, -1.023, 2012.000],
       [0.781, 0.434, 0.105, 2012.000],
       ...,
       [1.158, 1.810, 0.118, 2012.000],
       [1.382, -0.029, 0.234, 2012.000],
       [0.297, -1.016, -0.231, 2012.000]]), array([[-1.071, 0.400, 1.490, 2013.000],
       [-0.559, 1.989, 0.298, 2013.000],
       [0.324, -0.078, 0.512, 2013.000],
       ...,
       [-1.160, 0.799, -0.191, 2013.000],
       [1.542, -1.006, 0.835, 2013.000],
       [-0.160, -0.608, 1.218, 2013.000]]), array([[1.760, 1.303, 0.584, 2014.000],
       [0.308, 1.184, 0.710, 2014.000],
       [-0.916, -1.485, 0.717, 2014.000],
       ...,
       [-0.839, -1.420, -0.786, 2014.000],
       [0.625, -0.289, 0.914, 2014.000],
       [-1.393, -0.144, 0.389, 2014.000]]), array([[-0.371, 2.836, 1.156, 2015.000],
       [0.625, -0.812, 0.517, 2015.000],
       [1.683, -0.697, 0.316, 2015.000],
       ...,
       [-1.519, -0.195, -1.427, 2015.000],
       [1.141, -0.541, 1.434, 2015.000],
       [1.491, -0.605, 0.456, 2015.000]]), array([[0.396, 1.153, 1.451, 2016.000],
       [1.124, -0.064, -1.265, 2016.000],
       [0.047, 0.038, 1.536, 2016.000],
       ...,
       [-1.715, 1.981, 0.622, 2016.000],
       [-0.997, -0.048, -0.100, 2016.000],
       [4.086, -0.561, 1.430, 2016.000]]), array([[-2.620, 1.302, -0.624, 2017.000],
       [-3.629, 0.548, -0.361, 2017.000],
       [-1.450, 0.024, -1.406, 2017.000],
       ...,
       [0.035, -0.252, -1.975, 2017.000],
       [1.145, -1.471, -0.003, 2017.000],
       [-1.875, -0.794, -0.484, 2017.000]]), array([[-0.199, 0.571, -1.849, 2018.000],
       [-0.535, 0.408, -1.257, 2018.000],
       [-1.629, -0.315, 0.223, 2018.000],
       ...,
       [1.010, -0.382, 0.335, 2018.000],
       [-2.577, 0.425, -1.771, 2018.000],
       [0.316, -0.722, -1.370, 2018.000]]), array([[-0.323, -0.139, -0.376, 2019.000],
       [0.105, 0.439, -0.103, 2019.000],
       [0.394, 0.929, -1.189, 2019.000],
       ...,
       [0.617, 0.686, -0.222, 2019.000],
       [-2.545, 0.752, -1.271, 2019.000],
       [2.016, -0.663, 2.025, 2019.000]]), array([[-1.248, -0.723, -0.526, 2020.000],
       [0.739, 0.058, 1.388, 2020.000],
       [1.711, -1.081, 0.348, 2020.000],
       ...,
       [-2.098, -0.131, -1.182, 2020.000],
       [2.356, 0.722, -0.356, 2020.000],
       [0.703, -0.360, -0.386, 2020.000]])]
average_group_time: 
 [[[-0.006 0.056 -0.214 ... 0.008 -0.440 0.230]
  [-0.025 0.134 0.298 ... 0.432 0.475 0.022]
  [0.416 0.685 0.884 ... 0.384 0.925 0.614]
  ...
  [1.206 1.389 1.050 ... 1.180 1.053 1.124]
  [1.458 1.319 1.620 ... 1.101 1.226 1.273]
  [1.558 1.582 1.733 ... 1.392 1.841 1.867]]

 [[-0.294 -0.542 -0.319 ... -0.468 -0.204 -0.196]
  [0.120 -0.160 0.077 ... 0.012 0.260 -0.132]
  [0.305 0.077 0.027 ... 0.307 0.102 0.246]
  ...
  [0.971 0.836 1.196 ... 0.867 0.775 0.851]
  [0.988 0.800 1.467 ... 0.985 1.328 1.197]
  [1.713 1.087 1.665 ... 1.551 1.262 1.628]]

 [[-0.686 -0.606 -0.273 ... -0.361 -0.532 -0.435]
  [-0.449 -0.263 -0.432 ... -0.168 -0.638 -0.397]
  [0.169 -0.096 0.029 ... -0.177 -0.119 -0.089]
  ...
  [0.568 0.623 0.594 ... 0.664 0.517 0.740]
  [0.671 0.831 1.049 ... 0.963 0.850 1.072]
  [1.214 1.414 1.283 ... 1.040 1.187 1.295]]

 ...

 [[-1.160 -1.274 -1.352 ... -1.244 -1.537 -0.719]
  [-0.918 -0.634 -0.714 ... -0.855 -0.798 -1.014]
  [-0.732 -0.565 -0.556 ... -0.769 -0.790 -1.063]
  ...
  [0.186 0.032 -0.331 ... 0.512 0.143 0.205]
  [0.029 0.107 0.098 ... 0.116 0.275 0.223]
  [0.927 0.506 0.767 ... 0.444 0.667 0.860]]

 [[-1.694 -1.812 -1.452 ... -1.498 -1.312 -1.729]
  [-0.973 -1.123 -0.965 ... -1.175 -1.003 -1.054]
  [-0.928 -0.770 -0.845 ... -0.727 -0.961 -0.891]
  ...
  [-0.051 0.025 -0.158 ... 0.210 0.221 0.048]
  [0.223 0.166 0.475 ... 0.266 -0.050 -0.149]
  [0.218 0.157 -0.182 ... 0.416 0.225 0.479]]

 [[-1.693 -1.962 -1.773 ... -1.600 -1.497 -1.749]
  [-1.580 -1.482 -1.580 ... -1.337 -1.629 -1.711]
  [-1.384 -0.927 -1.158 ... -1.390 -1.010 -1.213]
  ...
  [-0.747 -0.601 -0.499 ... -0.831 -0.348 -0.404]
  [-0.238 -0.269 -0.472 ... -0.031 -0.502 -0.356]
  [-0.322 0.136 0.020 ... -0.202 -0.066 -0.342]]]
shape of average_group_time: 
 (10, 10, 20)
```



##### def difference(self, average_group):

This functions calculates the difference of group return, which, in detail, is the last group average return minus the first group average return. 

 **input :** 

*average_group :* The average return of groups by each characteristic-time pair.

**output :**

*result :* The matrix added with the difference of average group return.

##### def factor_adjustment(self, result):

This function calculates the group return adjusted by risk factors.

**input :**

*result :* The return table with difference sequence.

**output :**

*alpha :* The anomaly

*ttest :* The t-value of the anomaly.

##### def summary_and_test(self):

This function summarizes the result and take t-test.

**output : **

*self.average :* The average of the portfolio return across time.

*self.ttest :* The t-value of the portfolio return across time.

##### def fit(self):

This function run the function **summary_and_test().**

##### def print_summary_by_time(self, export=False):

This function print the summary grouped by time.

**input :** 

*export :* Export the table or not. The table is exported in form of Dataframe. The default setting is **False.**

**output :**

*df :* The table exported in form of Dataframe.

##### def print_summary(self, export=False):

This function print the summary grouped by characteristic and averaged by time.

**input :**

*export :* Export the table or not. The table is exported in form of Dataframe. The default setting is **False.**

**output :**

*df :* The table exported in form of Dataframe.

**Example**

```python
# Continue the above code
# test function difference
result = exper.difference(average_group_time)
print('result :\n', result)
print('difference matrix :\n', np.shape(result))
# test function summary_and_test
average, ttest = exper.summary_and_test()
print('average :\n', average)
print(' shape of average :', np.shape(average))
print('ttest :\n', ttest)
print('shape of ttest :', np.shape(ttest))
# test function print_summary_by_time()
exper.print_summary_by_time()
# test function print_summary
exper.print_summary()
    
# generate factor
factor=np.random.normal(0,1.0,(20,1))
exper=bi(sample,9,factor=factor,maxlag=12)
exper.fit()
exper.print_summary()
========================================================================
result :
 [[[-0.006 0.056 -0.214 ... 0.008 -0.440 0.230]
  [-0.025 0.134 0.298 ... 0.432 0.475 0.022]
  [0.416 0.685 0.884 ... 0.384 0.925 0.614]
  ...
  [1.458 1.319 1.620 ... 1.101 1.226 1.273]
  [1.558 1.582 1.733 ... 1.392 1.841 1.867]
  [1.564 1.526 1.947 ... 1.384 2.281 1.637]]

 [[-0.294 -0.542 -0.319 ... -0.468 -0.204 -0.196]
  [0.120 -0.160 0.077 ... 0.012 0.260 -0.132]
  [0.305 0.077 0.027 ... 0.307 0.102 0.246]
  ...
  [0.988 0.800 1.467 ... 0.985 1.328 1.197]
  [1.713 1.087 1.665 ... 1.551 1.262 1.628]
  [2.007 1.629 1.983 ... 2.019 1.466 1.824]]

 [[-0.686 -0.606 -0.273 ... -0.361 -0.532 -0.435]
  [-0.449 -0.263 -0.432 ... -0.168 -0.638 -0.397]
  [0.169 -0.096 0.029 ... -0.177 -0.119 -0.089]
  ...
  [0.671 0.831 1.049 ... 0.963 0.850 1.072]
  [1.214 1.414 1.283 ... 1.040 1.187 1.295]
  [1.900 2.020 1.556 ... 1.401 1.720 1.730]]

 ...

 [[-1.694 -1.812 -1.452 ... -1.498 -1.312 -1.729]
  [-0.973 -1.123 -0.965 ... -1.175 -1.003 -1.054]
  [-0.928 -0.770 -0.845 ... -0.727 -0.961 -0.891]
  ...
  [0.223 0.166 0.475 ... 0.266 -0.050 -0.149]
  [0.218 0.157 -0.182 ... 0.416 0.225 0.479]
  [1.912 1.969 1.270 ... 1.914 1.536 2.208]]

 [[-1.693 -1.962 -1.773 ... -1.600 -1.497 -1.749]
  [-1.580 -1.482 -1.580 ... -1.337 -1.629 -1.711]
  [-1.384 -0.927 -1.158 ... -1.390 -1.010 -1.213]
  ...
  [-0.238 -0.269 -0.472 ... -0.031 -0.502 -0.356]
  [-0.322 0.136 0.020 ... -0.202 -0.066 -0.342]
  [1.372 2.098 1.793 ... 1.398 1.431 1.407]]

 [[-1.687 -2.018 -1.559 ... -1.608 -1.057 -1.979]
  [-1.554 -1.615 -1.879 ... -1.769 -2.103 -1.733]
  [-1.799 -1.612 -2.043 ... -1.773 -1.934 -1.827]
  ...
  [-1.696 -1.588 -2.092 ... -1.132 -1.727 -1.629]
  [-1.879 -1.446 -1.713 ... -1.594 -1.907 -2.209]
  [-0.192 0.572 -0.153 ... 0.014 -0.850 -0.230]]]
difference matrix :
 (11, 11, 20)
average :
 [[-0.009 0.307 0.487 0.670 0.808 0.870 1.121 1.170 1.395 1.763 1.771]
 [-0.348 0.025 0.155 0.353 0.500 0.556 0.791 0.923 1.013 1.426 1.774]
 [-0.492 -0.264 -0.008 0.144 0.248 0.429 0.543 0.663 0.854 1.249 1.741]
 [-0.712 -0.379 -0.135 -0.027 0.132 0.207 0.361 0.552 0.753 1.011 1.723]
 [-0.864 -0.470 -0.229 -0.095 0.010 0.096 0.225 0.395 0.562 0.876 1.740]
 [-0.936 -0.588 -0.369 -0.266 -0.109 -0.043 0.104 0.292 0.524 0.769 1.706]
 [-1.166 -0.700 -0.531 -0.455 -0.250 -0.162 0.061 0.113 0.331 0.596 1.762]
 [-1.206 -0.863 -0.702 -0.530 -0.408 -0.195 -0.072 -0.033 0.139 0.587
  1.794]
 [-1.418 -1.080 -0.907 -0.827 -0.537 -0.401 -0.280 -0.108 0.087 0.384
  1.803]
 [-1.740 -1.428 -1.208 -1.037 -0.882 -0.800 -0.722 -0.563 -0.264 -0.020
  1.720]
 [-1.732 -1.735 -1.695 -1.707 -1.689 -1.670 -1.843 -1.733 -1.659 -1.782
  -0.051]]
 shape of average : (11, 11)
ttest :
 Ttest_1sampResult(statistic=array([[-0.210, 9.363, 10.040, 14.328, 19.642, 19.275, 32.422, 31.651,
        32.548, 36.339, 30.879],
       [-8.735, 0.554, 4.106, 9.711, 15.652, 17.688, 18.663, 21.424,
        24.727, 25.303, 27.968],
       [-14.510, -5.950, -0.196, 3.603, 4.279, 10.713, 11.675, 15.120,
        28.222, 30.641, 33.960],
       [-13.954, -12.731, -3.512, -0.734, 4.065, 3.896, 10.159, 11.573,
        19.965, 33.017, 27.068],
       [-22.685, -10.826, -5.787, -2.676, 0.240, 3.617, 4.984, 8.858,
        12.281, 22.043, 35.963],
       [-17.923, -13.135, -7.587, -8.412, -3.183, -1.094, 2.233, 6.425,
        14.503, 19.564, 22.897],
       [-23.358, -18.494, -11.156, -12.058, -6.798, -3.088, 1.608, 2.929,
        9.236, 12.340, 25.862],
       [-29.779, -21.416, -16.812, -12.196, -9.915, -4.330, -1.904,
        -0.730, 4.491, 14.137, 32.595],
       [-28.227, -28.724, -24.521, -19.015, -10.798, -8.905, -6.847,
        -2.320, 2.612, 8.876, 32.366],
       [-58.707, -35.555, -33.894, -25.661, -22.006, -19.782, -17.041,
        -13.409, -6.740, -0.442, 30.899],
       [-29.798, -36.048, -35.280, -26.596, -33.752, -24.635, -42.514,
        -31.417, -26.573, -25.966, -0.585]]), pvalue=array([[0.836, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000],
       [0.000, 0.586, 0.001, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000],
       [0.000, 0.000, 0.847, 0.002, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.000],
       [0.000, 0.000, 0.002, 0.472, 0.001, 0.001, 0.000, 0.000, 0.000,
        0.000, 0.000],
       [0.000, 0.000, 0.000, 0.015, 0.813, 0.002, 0.000, 0.000, 0.000,
        0.000, 0.000],
       [0.000, 0.000, 0.000, 0.000, 0.005, 0.288, 0.038, 0.000, 0.000,
        0.000, 0.000],
       [0.000, 0.000, 0.000, 0.000, 0.000, 0.006, 0.124, 0.009, 0.000,
        0.000, 0.000],
       [0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.072, 0.474, 0.000,
        0.000, 0.000],
       [0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.032, 0.017,
        0.000, 0.000],
       [0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.664, 0.000],
       [0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
        0.000, 0.565]]))
shape of ttest : (2, 11, 11)
+--------+-------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
|  Time  | Group |   1    |   2    |   3    |   4    |   5    |   6    |   7    |   8    |   9    |   10   |  Diff  |
+--------+-------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
| 2001.0 |   1   | -0.006 | -0.025 | 0.416  | 0.536  | 0.896  | 0.852  | 1.127  | 1.206  | 1.458  | 1.558  | 1.564  |
|        |   2   | -0.294 |  0.12  | 0.305  | 0.324  | 0.419  | 0.637  | 0.349  | 0.971  | 0.988  | 1.713  | 2.007  |
|        |   3   | -0.686 | -0.449 | 0.169  | -0.136 | -0.057 |  0.23  | 0.503  | 0.568  | 0.671  | 1.214  |  1.9   |
|        |   4   | -1.005 | -0.287 | -0.135 |  0.05  | 0.196  | 0.587  |  0.36  | 0.707  |  0.68  | 1.066  | 2.071  |
|        |   5   | -0.669 | -0.713 | -0.364 | 0.075  | -0.345 | 0.085  | 0.265  | 0.364  | 0.569  | 0.922  | 1.591  |
|        |   6   | -1.136 | -0.535 | -0.669 | -0.325 | -0.265 | -0.137 | 0.041  | 0.571  | 0.444  | 1.052  | 2.188  |
|        |   7   | -1.34  | -0.766 | -0.515 | -0.439 | -0.201 | -0.342 | 0.211  | -0.107 | 0.369  | 0.231  | 1.571  |
|        |   8   | -1.16  | -0.918 | -0.732 | -0.563 | -0.625 | -0.182 | -0.06  | 0.186  | 0.029  | 0.927  | 2.086  |
|        |   9   | -1.694 | -0.973 | -0.928 | -0.63  | -0.557 | -0.391 | -0.531 | -0.051 | 0.223  | 0.218  | 1.912  |
|        |   10  | -1.693 | -1.58  | -1.384 | -0.712 | -0.67  | -0.707 | -0.803 | -0.747 | -0.238 | -0.322 | 1.372  |
|        |  Diff | -1.687 | -1.554 | -1.799 | -1.248 | -1.566 | -1.559 | -1.93  | -1.953 | -1.696 | -1.879 | -0.192 |
| 2002.0 |   1   | 0.056  | 0.134  | 0.685  | 0.891  | 1.142  | 0.668  | 1.173  | 1.389  | 1.319  | 1.582  | 1.526  |
|        |   2   | -0.542 | -0.16  | 0.077  | 0.046  | 0.603  | 0.746  | 0.779  | 0.836  |  0.8   | 1.087  | 1.629  |
|        |   3   | -0.606 | -0.263 | -0.096 | 0.235  | -0.006 | 0.273  |  0.79  | 0.623  | 0.831  | 1.414  |  2.02  |
|        |   4   | -0.634 | -0.419 | 0.107  | -0.265 | 0.193  | 0.035  |  0.15  | 0.514  | 0.694  | 0.999  | 1.633  |
|        |   5   | -1.139 | -0.555 | -0.269 | 0.015  | -0.198 |  0.13  | -0.018 | 0.496  | 0.657  | 0.763  | 1.902  |
|        |   6   | -0.587 | -0.192 | -0.27  | -0.348 | 0.291  | -0.125 | -0.091 | 0.103  | 0.489  | 0.949  | 1.536  |
|        |   7   | -0.916 | -0.847 | -0.781 | -0.223 | -0.065 | -0.498 | -0.066 | 0.277  |  0.37  | 0.383  | 1.299  |
|        |   8   | -1.274 | -0.634 | -0.565 | -0.773 | -0.335 | -0.161 | -0.002 | 0.032  | 0.107  | 0.506  | 1.779  |
|        |   9   | -1.812 | -1.123 | -0.77  | -0.67  | -0.922 | -0.32  | -0.569 | 0.025  | 0.166  | 0.157  | 1.969  |
|        |   10  | -1.962 | -1.482 | -0.927 | -1.269 | -0.649 | -0.576 | -0.869 | -0.601 | -0.269 | 0.136  | 2.098  |
|        |  Diff | -2.018 | -1.615 | -1.612 | -2.16  | -1.791 | -1.243 | -2.042 | -1.99  | -1.588 | -1.446 | 0.572  |
| 2003.0 |   1   | -0.214 | 0.298  | 0.884  | 0.701  | 0.773  | 0.705  |  1.12  |  1.05  |  1.62  | 1.733  | 1.947  |
|        |   2   | -0.319 | 0.077  | 0.027  | 0.399  | 0.495  | 0.534  | 0.922  | 1.196  | 1.467  | 1.665  | 1.983  |
|        |   3   | -0.273 | -0.432 | 0.029  |  0.3   | 0.726  | 0.243  | 0.655  | 0.594  | 1.049  | 1.283  | 1.556  |
|        |   4   | -0.643 | -0.531 | -0.149 | 0.124  | 0.086  | -0.055 | 0.186  | 0.563  | 0.696  | 1.047  |  1.69  |
|        |   5   | -0.922 |  -0.1  | -0.214 | -0.203 | 0.229  | 0.024  | -0.049 | 0.283  | 0.895  | 0.965  | 1.888  |
|        |   6   | -0.492 | -0.802 | -0.234 | -0.392 | -0.198 | -0.148 | 0.083  | 0.348  |  0.61  | 0.702  | 1.194  |
|        |   7   | -1.483 | -0.691 | -0.522 | -0.633 | -0.409 | -0.008 | 0.193  | 0.292  | -0.001 | 0.835  | 2.317  |
|        |   8   | -1.352 | -0.714 | -0.556 | -0.788 | -0.063 | -0.393 | -0.047 | -0.331 | 0.098  | 0.767  | 2.119  |
|        |   9   | -1.452 | -0.965 | -0.845 | -0.935 | -0.38  | -0.281 | -0.293 | -0.158 | 0.475  | -0.182 |  1.27  |
|        |   10  | -1.773 | -1.58  | -1.158 | -1.133 | -0.702 | -1.006 | -0.465 | -0.499 | -0.472 |  0.02  | 1.793  |
|        |  Diff | -1.559 | -1.879 | -2.043 | -1.833 | -1.475 | -1.711 | -1.585 | -1.548 | -2.092 | -1.713 | -0.153 |
| 2004.0 |   1   | -0.176 | 0.258  | 0.289  | 0.622  | 0.792  | 1.224  | 1.096  | 1.166  | 1.604  | 1.758  | 1.934  |
|        |   2   | -0.342 | 0.185  | 0.181  | 0.413  | 0.552  | 0.689  | 1.024  | 1.149  | 0.971  | 1.626  | 1.967  |
|        |   3   | -0.363 |  0.12  | -0.258 | 0.258  | -0.219 | 0.244  | 0.817  | 0.795  | 0.942  | 1.121  | 1.485  |
|        |   4   | -0.956 | -0.466 | -0.361 | -0.046 | 0.217  | 0.052  | 0.652  |  0.6   | 0.776  | 0.872  | 1.829  |
|        |   5   | -1.072 | -0.247 | -0.348 | 0.101  | 0.185  | 0.061  | 0.476  | 0.288  | 0.292  | 0.871  | 1.943  |
|        |   6   | -0.782 | -0.744 | -0.451 | -0.449 | -0.116 | -0.059 | 0.442  |  0.26  | 0.297  | 0.406  | 1.188  |
|        |   7   | -1.011 | -0.523 | -0.174 | -0.264 | -0.209 | 0.018  | -0.09  | -0.152 | 0.406  | 0.771  | 1.782  |
|        |   8   | -1.064 | -1.185 | -0.958 | -0.314 | -0.714 | -0.096 | -0.343 | -0.017 | 0.205  | 0.427  | 1.491  |
|        |   9   | -1.272 | -1.341 | -0.932 | -0.839 | -0.425 | -0.452 | -0.498 | -0.107 | 0.153  | 0.259  | 1.532  |
|        |   10  | -1.551 | -1.152 | -1.257 | -1.175 | -0.789 | -0.613 | -0.566 | -0.606 | 0.003  |  0.16  | 1.712  |
|        |  Diff | -1.376 | -1.41  | -1.547 | -1.797 | -1.581 | -1.837 | -1.662 | -1.772 |  -1.6  | -1.598 | -0.222 |
| 2005.0 |   1   | 0.292  | 0.185  | 0.793  | 0.676  | 0.866  | 0.658  | 0.898  | 1.312  | 1.711  | 1.957  | 1.664  |
|        |   2   | -0.351 | -0.267 | 0.235  | 0.484  | 0.402  | 0.517  | 0.938  |  0.5   | 1.084  | 1.604  | 1.955  |
|        |   3   | -0.492 | -0.213 |  0.28  | 0.022  | 0.338  | 0.221  | 0.903  | 0.862  | 0.848  | 1.144  | 1.635  |
|        |   4   | -0.425 | -0.268 | -0.228 | 0.014  | 0.252  |  0.27  | 0.453  | 0.612  | 0.911  | 0.999  | 1.424  |
|        |   5   | -0.673 | -0.538 | -0.462 | -0.144 | -0.027 | 0.154  | 0.409  | -0.003 | 0.414  | 0.774  | 1.447  |
|        |   6   | -1.109 | -0.604 | -0.465 | -0.06  | -0.048 | 0.104  | -0.058 | 0.212  | 0.749  | 1.172  | 2.282  |
|        |   7   | -1.106 | -0.633 | -0.221 | -0.54  | -0.558 | -0.036 | 0.076  | -0.037 |  0.14  | 0.895  | 2.001  |
|        |   8   | -1.485 | -1.188 | -0.414 | -0.21  | -0.223 | -0.556 | 0.016  | 0.029  | 0.234  | 0.521  | 2.006  |
|        |   9   | -1.199 | -1.172 | -1.14  | -0.85  | -0.706 | -0.571 | -0.217 | -0.066 | 0.055  |  0.49  | 1.689  |
|        |   10  | -1.876 | -1.479 | -1.317 | -1.205 | -1.136 | -0.596 | -1.07  | -0.469 | -0.376 | 0.321  | 2.197  |
|        |  Diff | -2.168 | -1.664 | -2.11  | -1.881 | -2.002 | -1.254 | -1.968 | -1.781 | -2.087 | -1.635 | 0.533  |
| 2006.0 |   1   | -0.006 | 0.369  | 0.611  | 0.916  | 0.818  | 0.894  | 1.053  | 1.307  | 1.403  | 1.791  | 1.797  |
|        |   2   | -0.597 | -0.006 | 0.287  | 0.339  | 0.519  | 0.422  | 0.971  | 0.978  | 0.995  | 1.383  |  1.98  |
|        |   3   | -0.662 | -0.362 | -0.057 |  0.17  | 0.198  | 0.369  | 0.781  | 1.019  | 0.817  | 1.337  | 1.999  |
|        |   4   | -1.05  | -0.16  | 0.006  | 0.179  | -0.003 | -0.07  | 0.039  | 0.602  | 0.701  | 1.133  | 2.184  |
|        |   5   | -0.966 | -0.898 | 0.001  | 0.046  | 0.031  | 0.178  | 0.454  | 0.281  | 0.479  | 0.663  | 1.629  |
|        |   6   | -0.757 |  -0.6  | -0.35  | -0.201 | -0.069 | -0.236 | 0.408  | 0.476  | 0.838  | 0.652  | 1.409  |
|        |   7   | -1.058 | -0.532 | -0.504 | -0.384 | -0.417 | -0.004 | -0.082 | -0.06  | 0.311  | 0.522  |  1.58  |
|        |   8   | -1.148 | -0.962 | -0.734 | -0.498 | -0.527 | 0.101  | -0.373 | -0.033 | 0.389  | 0.735  | 1.884  |
|        |   9   | -1.473 | -0.956 | -0.508 | -0.85  | -0.689 | -0.417 | -0.198 | -0.285 | 0.005  | 0.284  | 1.757  |
|        |   10  | -1.494 | -1.458 | -1.18  | -1.087 | -0.525 | -1.031 | -0.547 | -0.41  | -0.092 | 0.256  |  1.75  |
|        |  Diff | -1.488 | -1.827 | -1.792 | -2.003 | -1.344 | -1.924 | -1.601 | -1.716 | -1.495 | -1.535 | -0.047 |
| 2007.0 |   1   | -0.123 | 0.481  | 0.258  | 0.852  | 1.025  | 0.964  | 1.239  | 0.922  | 1.271  | 1.566  | 1.689  |
|        |   2   | -0.425 | 0.048  | -0.015 | 0.031  | 0.277  |  0.5   | 0.746  | 0.831  | 1.023  | 1.435  | 1.861  |
|        |   3   | -0.495 | 0.105  | 0.106  | -0.066 | 0.553  | 0.421  | 0.491  | 0.851  |  0.83  | 0.951  | 1.446  |
|        |   4   | -0.595 | -0.274 | -0.412 | 0.034  | -0.059 | 0.189  | 0.594  | 0.278  | 1.072  | 0.971  | 1.566  |
|        |   5   | -0.888 | -0.202 | -0.076 |  0.01  | -0.195 | 0.265  | 0.346  | 0.696  | 0.097  | 1.018  | 1.906  |
|        |   6   | -1.027 | -0.787 | -0.022 | -0.213 | -0.181 | -0.109 | 0.147  | 0.205  | 0.118  | 0.798  | 1.825  |
|        |   7   | -1.302 | -1.056 | -0.662 | -0.689 | -0.457 |  0.04  | 0.059  | 0.069  |  0.3   | 0.425  | 1.727  |
|        |   8   | -1.333 | -0.748 | -0.862 | -0.387 | -0.526 | -0.571 | -0.221 | -0.04  |  0.0   | 0.551  | 1.884  |
|        |   9   | -0.981 | -0.873 | -1.158 | -0.487 | -0.287 | -0.094 | -0.132 | -0.17  | 0.071  | 0.416  | 1.397  |
|        |   10  | -1.842 | -1.518 | -1.186 | -0.903 | -0.762 | -0.558 | -0.743 | -0.43  | -0.455 | 0.242  | 2.084  |
|        |  Diff | -1.719 | -1.999 | -1.444 | -1.754 | -1.787 | -1.521 | -1.982 | -1.351 | -1.726 | -1.325 | 0.395  |
| 2008.0 |   1   | -0.098 | 0.303  | 0.088  | 0.747  | 0.614  | 0.964  | 1.201  | 1.296  | 1.374  | 1.807  | 1.905  |
|        |   2   | -0.602 | -0.213 | 0.199  | 0.435  | 0.603  | 0.781  | 0.739  | 1.198  | 0.876  | 0.948  |  1.55  |
|        |   3   | -0.607 | -0.182 | 0.041  | 0.394  |  0.28  | 0.617  | 0.472  | 0.661  | 1.057  | 1.099  | 1.706  |
|        |   4   | -0.394 | -0.623 | 0.087  | -0.195 | 0.018  | -0.299 | 0.508  |  0.65  | 0.721  | 0.878  | 1.272  |
|        |   5   | -0.837 | -0.421 | -0.008 | -0.168 | -0.132 | -0.049 | 0.384  | 0.486  | 0.573  | 0.728  | 1.565  |
|        |   6   | -0.996 | -0.694 | -0.157 | -0.295 | 0.108  | 0.004  | 0.307  |  0.11  | 0.604  |  0.8   | 1.796  |
|        |   7   | -0.842 | -0.59  | -0.517 | -0.619 | -0.429 | -0.233 | 0.302  | 0.106  | 0.414  | 0.541  | 1.383  |
|        |   8   | -1.337 | -1.116 | -0.813 | -0.695 | -0.061 | -0.409 | -0.136 | -0.352 | 0.222  |  0.71  | 2.047  |
|        |   9   | -1.193 | -1.169 | -0.754 | -0.77  | -0.284 | -0.354 | -0.131 | -0.069 | 0.118  | 0.631  | 1.825  |
|        |   10  | -1.847 | -1.415 | -1.344 | -0.984 | -0.846 | -0.686 | -0.583 | -0.694 | -0.077 | 0.003  |  1.85  |
|        |  Diff | -1.749 | -1.718 | -1.432 | -1.731 | -1.459 | -1.649 | -1.784 | -1.99  | -1.451 | -1.804 | -0.055 |
| 2009.0 |   1   | 0.004  |  0.41  | 0.595  | 0.964  | 0.871  | 0.773  | 0.991  | 1.168  | 1.108  | 1.644  |  1.64  |
|        |   2   | 0.028  | -0.482 | 0.104  | 0.088  | 0.597  | 0.706  | 0.974  | 0.825  |  0.79  | 1.275  | 1.247  |
|        |   3   | -0.386 | -0.29  | -0.234 |  0.33  | 0.229  | 0.582  | 0.577  | 0.727  | 0.614  | 1.094  | 1.481  |
|        |   4   | -0.637 | -0.508 | -0.199 | -0.332 | -0.074 | 0.255  | 0.284  | 0.096  | 0.439  | 1.158  | 1.794  |
|        |   5   | -0.723 | -0.472 | 0.157  | -0.091 |  0.04  | 0.133  | 0.102  |  0.35  | 0.496  | 0.852  | 1.575  |
|        |   6   | -1.057 | -0.643 | -0.585 | -0.612 | -0.204 | 0.115  |  0.32  |  0.33  | 0.603  | 0.667  | 1.723  |
|        |   7   | -0.863 | -0.911 | -0.952 | -0.353 | -0.174 | -0.03  | -0.055 | 0.114  | 0.405  | 0.857  | 1.719  |
|        |   8   | -1.121 | -0.646 | -0.564 | -0.685 | -0.477 | -0.235 | 0.039  | 0.048  | 0.211  | 0.168  |  1.29  |
|        |   9   | -1.336 | -1.282 | -1.043 | -0.84  | -0.532 | -0.551 | -0.331 | -0.215 | 0.067  | 0.438  | 1.774  |
|        |   10  | -1.727 | -1.131 | -1.202 | -0.873 | -1.011 | -0.627 |  -0.7  | -0.537 | -0.467 | 0.101  | 1.828  |
|        |  Diff | -1.731 | -1.541 | -1.797 | -1.837 | -1.882 |  -1.4  | -1.691 | -1.705 | -1.575 | -1.543 | 0.188  |
| 2010.0 |   1   | 0.398  | 0.232  | 0.344  | 0.271  | 0.476  | 0.836  | 1.238  |  1.36  | 1.652  | 1.797  | 1.399  |
|        |   2   | -0.324 | 0.262  | 0.119  | 0.492  |  0.53  | 0.695  | 0.681  | 0.693  | 0.927  | 1.509  | 1.833  |
|        |   3   | -0.438 | -0.564 | -0.147 | 0.335  | 0.688  | 0.283  | 0.359  | 0.804  | 0.797  | 1.339  | 1.777  |
|        |   4   | -0.582 | -0.318 | -0.246 | -0.045 | 0.266  | 0.529  | 0.367  | 0.539  | 0.559  | 1.126  | 1.708  |
|        |   5   | -1.221 | -0.754 | -0.498 |  0.03  | -0.185 | -0.02  | 0.324  | 0.695  | 0.711  | 0.862  | 2.084  |
|        |   6   | -1.001 | -0.697 | -0.32  | -0.427 | -0.047 | 0.352  | 0.018  | 0.329  | 0.554  |  0.62  | 1.621  |
|        |   7   | -0.948 | -0.484 | -0.402 | -0.555 |  -0.1  | -0.253 | -0.326 | 0.218  | 0.242  | 0.401  | 1.349  |
|        |   8   | -1.214 | -0.57  | -0.531 | -0.58  | -0.383 | -0.304 | -0.024 | -0.187 | -0.011 | 0.663  | 1.877  |
|        |   9   | -1.187 | -0.866 | -0.827 | -1.277 | -0.418 | -0.583 | -0.491 | 0.196  | -0.153 | 0.566  | 1.753  |
|        |   10  | -1.815 | -1.309 | -1.377 | -1.038 | -0.939 | -0.781 | -0.335 | -0.757 | -0.224 | -0.121 | 1.694  |
|        |  Diff | -2.213 | -1.541 | -1.721 | -1.309 | -1.415 | -1.617 | -1.573 | -2.117 | -1.876 | -1.919 | 0.295  |
| 2011.0 |   1   | 0.118  | 0.372  | 0.283  | 0.764  | 0.693  | 0.581  | 1.095  | 1.004  | 1.381  |  2.34  | 2.222  |
|        |   2   | -0.12  | -0.056 | 0.197  | 0.623  | 0.528  | 0.429  | 1.032  | 0.995  | 0.792  | 1.525  | 1.645  |
|        |   3   | -0.727 | -0.498 | 0.392  | -0.075 | 0.101  |  0.42  | 0.886  | 0.547  | 0.744  | 1.446  | 2.172  |
|        |   4   | -0.743 | -0.357 | -0.019 | -0.137 | 0.228  | 0.258  | 0.283  | 0.824  | 0.982  | 0.807  |  1.55  |
|        |   5   | -0.762 | -0.51  | -0.224 | 0.031  | 0.244  | 0.032  | 0.252  | 0.406  | 0.877  | 1.207  | 1.969  |
|        |   6   | -1.281 | -0.633 | -0.157 | -0.182 | 0.031  | -0.15  | -0.177 | 0.459  | 0.495  | 0.794  | 2.075  |
|        |   7   | -1.463 | -0.75  | -0.557 | -0.396 | -0.311 | 0.082  | -0.033 | 0.155  | 0.569  | 0.505  | 1.968  |
|        |   8   | -1.224 | -0.942 | -1.001 | -0.362 | -0.396 | -0.274 | -0.03  | -0.247 | 0.136  | 0.574  | 1.798  |
|        |   9   | -1.545 | -0.878 | -0.998 | -0.706 | -0.379 | -0.32  | -0.212 | 0.023  | 0.162  | 0.527  | 2.072  |
|        |   10  | -1.606 | -1.534 | -1.321 | -0.935 | -1.014 | -0.947 | -0.52  | -0.564 | -0.12  | -0.016 |  1.59  |
|        |  Diff | -1.725 | -1.907 | -1.604 | -1.699 | -1.707 | -1.528 | -1.614 | -1.568 | -1.501 | -2.356 | -0.631 |
| 2012.0 |   1   | 0.007  | 0.437  | 0.364  |  0.65  | 0.744  | 0.871  | 0.846  | 1.401  | 1.454  | 1.942  | 1.935  |
|        |   2   | -0.211 | 0.347  | 0.334  | 0.474  | 0.388  | 0.553  | 0.609  |  1.23  | 1.096  | 1.132  | 1.344  |
|        |   3   | -0.593 | -0.204 | 0.255  | 0.025  | 0.188  | 0.467  | 0.501  | 0.876  |  1.01  | 1.093  | 1.686  |
|        |   4   |  -0.8  | -0.355 | -0.228 | -0.071 | 0.162  | 0.032  | 0.527  | 0.331  | 0.865  | 0.778  | 1.578  |
|        |   5   | -0.686 | -0.649 | -0.231 | -0.307 | 0.045  | 0.356  | 0.535  | 0.464  | 0.571  | 1.283  | 1.969  |
|        |   6   | -0.937 | -0.828 | -0.39  | -0.22  | -0.177 |  0.17  | 0.229  | 0.407  | 0.525  | 0.794  | 1.732  |
|        |   7   | -1.389 | -0.866 | -0.569 | -0.473 | -0.265 | -0.039 | 0.233  | 0.029  | 0.113  | 0.725  | 2.114  |
|        |   8   | -0.986 | -0.783 | -0.699 | -0.509 | -0.592 | -0.219 | 0.232  | -0.225 | 0.145  | 0.466  | 1.453  |
|        |   9   | -1.321 | -1.27  | -0.977 | -0.913 | -0.673 | -0.394 | -0.46  | -0.266 | -0.082 | 0.417  | 1.738  |
|        |   10  | -1.775 | -1.274 | -1.423 | -1.141 | -1.174 | -0.84  | -0.887 | -0.78  | -0.291 | -0.13  | 1.645  |
|        |  Diff | -1.782 | -1.711 | -1.787 | -1.79  | -1.917 | -1.711 | -1.732 | -2.181 | -1.745 | -2.072 | -0.29  |
| 2013.0 |   1   | -0.048 | 0.324  |  0.48  | 0.571  | 0.748  | 0.703  |  1.18  | 1.111  | 1.442  | 1.638  | 1.686  |
|        |   2   | -0.562 | 0.103  | -0.179 | 0.233  | 0.691  | 0.473  | 0.932  | 1.174  | 0.961  | 1.348  |  1.91  |
|        |   3   | -0.398 | -0.175 | -0.166 | 0.234  |  0.4   | 0.682  | 0.489  | 0.469  |  0.74  | 1.726  | 2.124  |
|        |   4   | -0.738 | -0.619 | -0.418 | -0.073 | -0.108 |  0.24  | 0.276  | 0.373  | 0.468  | 1.071  | 1.809  |
|        |   5   | -0.863 | -0.377 | -0.39  | -0.113 | -0.033 | 0.235  | 0.186  | 0.682  | 0.684  |  0.81  | 1.673  |
|        |   6   | -1.077 | -0.916 | -0.246 | -0.251 | -0.21  | -0.143 |  0.18  | 0.216  | 0.254  | 0.814  | 1.891  |
|        |   7   | -1.058 | -0.795 | -0.693 | -0.696 | -0.014 | -0.276 | 0.019  | 0.193  | 0.325  | 0.614  | 1.672  |
|        |   8   | -1.311 | -1.051 | -0.623 | -0.405 | -0.395 | -0.427 | -0.012 | -0.002 | 0.087  | 0.423  | 1.734  |
|        |   9   | -1.397 | -1.082 | -0.901 | -0.708 | -0.414 | -0.726 | -0.495 | -0.321 | 0.057  |  0.26  | 1.657  |
|        |   10  | -1.667 | -1.489 | -1.047 | -1.229 | -1.01  | -0.663 | -0.617 | -0.362 | -0.299 | -0.169 | 1.498  |
|        |  Diff | -1.619 | -1.813 | -1.527 | -1.799 | -1.758 | -1.366 | -1.796 | -1.473 | -1.741 | -1.807 | -0.187 |
| 2014.0 |   1   | -0.034 | 0.241  | 0.419  | 0.757  | 0.858  | 0.525  | 1.198  | 1.045  |  1.02  | 1.699  | 1.733  |
|        |   2   | -0.408 |  0.19  | -0.119 | 0.337  | 0.591  | 0.377  | 0.904  | 0.903  | 0.883  |  1.41  | 1.818  |
|        |   3   | -0.409 | -0.099 | 0.102  | -0.019 | -0.073 | 0.459  | 0.414  | 0.252  | 0.845  | 1.126  | 1.535  |
|        |   4   | -0.512 | -0.355 | 0.119  | 0.074  |  0.43  | 0.225  | 0.139  | 0.802  | 0.797  |  0.88  | 1.392  |
|        |   5   | -1.035 | -0.427 | -0.468 | -0.243 | 0.106  | -0.02  | -0.197 | 0.573  | 0.423  | 0.553  | 1.588  |
|        |   6   | -0.499 | -0.515 | -0.074 | -0.169 | -0.163 |  -0.3  | -0.116 | 0.761  | 0.447  | 0.751  | 1.249  |
|        |   7   | -1.057 | -0.442 | -0.697 | -0.293 | -0.076 | -0.288 | -0.158 | -0.161 | 0.508  | 0.707  | 1.764  |
|        |   8   | -0.999 | -0.741 | -0.487 | -0.661 | -0.527 | 0.079  | 0.098  | -0.015 |  0.3   | 0.619  | 1.618  |
|        |   9   | -1.416 | -0.84  | -0.994 | -0.848 | -0.619 | -0.711 | -0.267 |  0.02  | -0.047 | 0.582  | 1.998  |
|        |   10  | -1.844 | -1.085 | -1.056 | -0.792 | -1.005 | -0.656 | -0.896 | -0.854 | 0.081  | 0.034  | 1.878  |
|        |  Diff | -1.81  | -1.326 | -1.475 | -1.549 | -1.863 | -1.181 | -2.094 | -1.899 | -0.939 | -1.665 | 0.145  |
| 2015.0 |   1   | -0.102 | 0.472  | 0.353  |  0.39  | 0.892  | 1.007  | 0.944  |  1.42  | 1.429  | 1.755  | 1.857  |
|        |   2   | -0.089 | 0.226  | 0.475  | 0.355  |  0.74  | 0.802  | 0.882  | 0.944  | 1.093  | 1.243  | 1.331  |
|        |   3   | -0.556 | -0.277 | 0.071  | -0.042 | 0.272  | 0.659  | 0.171  | 0.743  | 0.942  | 1.302  | 1.858  |
|        |   4   | -0.575 | -0.359 | -0.347 | 0.069  | 0.077  |  0.37  | 0.366  | 0.779  | 0.873  | 0.916  | 1.491  |
|        |   5   | -0.694 | -0.451 | -0.051 | -0.235 | -0.243 | 0.179  | 0.247  | 0.142  | 0.391  | 0.725  | 1.418  |
|        |   6   | -1.202 | -0.162 | -0.674 | -0.078 | -0.235 | -0.062 | 0.205  | 0.275  | 0.616  | 0.691  | 1.893  |
|        |   7   | -1.446 | -0.757 | -0.59  | -0.406 | -0.359 | 0.124  | 0.106  | 0.449  | 0.247  | 0.399  | 1.845  |
|        |   8   | -1.208 | -0.749 | -0.583 | -0.524 | -0.355 | -0.074 | -0.097 | -0.111 | -0.251 | 0.833  | 2.041  |
|        |   9   | -1.29  | -1.283 | -0.671 | -0.799 | -0.689 | 0.015  | 0.018  | -0.311 | 0.217  | 0.559  | 1.849  |
|        |   10  | -1.864 | -1.381 | -1.103 | -0.893 | -0.727 | -1.004 | -0.913 | -0.132 | -0.472 | 0.081  | 1.944  |
|        |  Diff | -1.762 | -1.853 | -1.457 | -1.283 | -1.619 | -2.01  | -1.857 | -1.552 |  -1.9  | -1.674 | 0.087  |
| 2016.0 |   1   | -0.049 | 0.267  | 0.437  | 0.574  | 1.052  | 0.797  | 1.475  | 1.057  | 1.621  | 2.096  | 2.144  |
|        |   2   | -0.385 | -0.062 | -0.086 | 0.358  | 0.585  | 0.521  | 0.623  | 0.743  | 0.793  | 2.004  | 2.389  |
|        |   3   | -0.141 | -0.174 | -0.067 | 0.258  | 0.383  | 0.591  |  0.5   | 0.695  | 0.816  | 1.503  | 1.644  |
|        |   4   | -1.209 | -0.191 | -0.135 | -0.375 |  0.25  | 0.226  | 0.472  |  0.19  | 0.625  | 1.256  | 2.466  |
|        |   5   | -0.779 |  -0.3  | -0.227 | -0.264 | 0.101  | 0.066  |  0.08  | 0.286  | 0.469  | 0.917  | 1.696  |
|        |   6   | -0.917 |  -0.6  | -0.65  | -0.345 | -0.301 | 0.188  | 0.083  | -0.182 | 0.615  | 0.608  | 1.526  |
|        |   7   | -1.478 | -0.925 | -0.501 | -0.582 | -0.114 | -0.603 | -0.066 | -0.055 | 0.614  | 0.535  | 2.013  |
|        |   8   | -1.171 | -0.774 | -0.448 | -0.626 | -0.555 | -0.03  | -0.336 | -0.17  | 0.222  | 0.496  | 1.666  |
|        |   9   | -1.861 | -0.947 | -0.966 | -0.679 | -0.868 | -0.535 | -0.165 | -0.605 | 0.078  |  0.37  | 2.232  |
|        |   10  | -1.829 | -1.318 | -0.905 | -1.276 | -0.799 | -0.802 | -0.785 | -0.527 | -0.28  | -0.392 | 1.437  |
|        |  Diff | -1.78  | -1.584 | -1.342 | -1.85  | -1.851 | -1.599 | -2.261 | -1.583 | -1.901 | -2.488 | -0.707 |
| 2017.0 |   1   | 0.011  | 0.448  | 0.522  |  0.26  | 0.508  | 1.239  | 1.196  | 0.836  | 1.442  | 1.491  | 1.479  |
|        |   2   | -0.55  | 0.057  | 0.314  | 0.301  | 0.169  |  0.32  | 0.844  | 0.798  |  1.21  | 1.167  | 1.716  |
|        |   3   | -0.68  | -0.113 | -0.196 | -0.14  | 0.102  |  0.14  | 0.175  | 0.248  | 0.639  |  1.27  |  1.95  |
|        |   4   | -0.374 | -0.539 | -0.147 | 0.189  | 0.187  | 0.574  | 0.384  | 0.713  | 0.945  | 1.278  | 1.652  |
|        |   5   | -0.881 | -0.352 | -0.322 | -0.16  | 0.276  | -0.108 | 0.277  | 0.097  | 0.836  | 0.817  | 1.699  |
|        |   6   | -0.874 | -0.436 | -0.232 | -0.06  | -0.278 | 0.051  | 0.179  | 0.216  | 0.568  | 0.901  | 1.775  |
|        |   7   | -1.164 | -0.722 | -0.315 | -0.685 | -0.425 | -0.446 | 0.235  | 0.311  | 0.389  | 0.842  | 2.006  |
|        |   8   | -1.241 | -0.877 | -0.857 | -0.97  | -0.498 | -0.112 | 0.059  | -0.083 |  0.05  | 0.389  |  1.63  |
|        |   9   | -1.399 | -1.35  | -1.142 | -0.936 | -0.252 | -0.369 | -0.156 | -0.276 | 0.114  | 0.575  | 1.974  |
|        |   10  | -1.788 |  -1.7  | -1.365 | -0.75  | -0.811 | -0.979 | -0.596 | -0.708 | -0.339 | 0.011  | 1.799  |
|        |  Diff | -1.799 | -2.148 | -1.886 | -1.01  | -1.319 | -2.218 | -1.792 | -1.544 | -1.781 | -1.48  |  0.32  |
| 2018.0 |   1   | 0.008  | 0.432  | 0.384  | 0.844  | 0.812  | 0.936  | 1.029  |  1.18  | 1.101  | 1.392  | 1.384  |
|        |   2   | -0.468 | 0.012  | 0.307  | 0.623  | 0.365  |  0.51  | 0.678  | 0.867  | 0.985  | 1.551  | 2.019  |
|        |   3   | -0.361 | -0.168 | -0.177 |  0.34  | 0.501  | 0.448  | 0.516  | 0.664  | 0.963  |  1.04  | 1.401  |
|        |   4   | -0.615 | -0.416 | -0.068 | -0.069 | 0.191  | -0.086 | 0.502  | 0.559  | 0.686  | 0.978  | 1.593  |
|        |   5   | -0.837 | -0.41  | -0.226 | -0.388 | 0.277  | 0.209  | -0.095 |  0.29  |  0.83  |  1.08  | 1.917  |
|        |   6   | -1.293 | -0.31  | -0.482 | -0.24  | 0.118  | 0.133  | 0.139  | 0.027  | 0.563  | 0.959  | 2.252  |
|        |   7   |  -1.1  | -0.543 | -0.849 | -0.144 | -0.267 | 0.051  | 0.122  |  0.21  | 0.074  | 0.187  | 1.286  |
|        |   8   | -1.244 | -0.855 | -0.769 | -0.346 | -0.521 | 0.072  | -0.271 | 0.512  | 0.116  | 0.444  | 1.688  |
|        |   9   | -1.498 | -1.175 | -0.727 | -1.168 | -0.162 | -0.464 |  0.05  |  0.21  | 0.266  | 0.416  | 1.914  |
|        |   10  |  -1.6  | -1.337 | -1.39  | -0.975 | -1.115 | -0.983 | -0.877 | -0.831 | -0.031 | -0.202 | 1.398  |
|        |  Diff | -1.608 | -1.769 | -1.773 | -1.819 | -1.927 | -1.92  | -1.906 | -2.011 | -1.132 | -1.594 | 0.014  |
| 2019.0 |   1   | -0.44  | 0.475  | 0.925  |  0.48  | 1.048  | 1.155  | 1.371  | 1.053  | 1.226  | 1.841  | 2.281  |
|        |   2   | -0.204 |  0.26  | 0.102  | 0.299  | 0.613  | 0.416  | 0.424  | 0.775  | 1.328  | 1.262  | 1.466  |
|        |   3   | -0.532 | -0.638 | -0.119 | 0.308  | 0.423  | 0.775  | 0.427  | 0.517  |  0.85  | 1.187  |  1.72  |
|        |   4   | -0.93  | -0.281 |  0.02  | 0.134  | 0.224  |  0.44  | 0.321  | 0.863  | 0.927  | 1.049  | 1.979  |
|        |   5   | -1.019 | -0.393 |  -0.3  | 0.244  | 0.094  | -0.029 | 0.351  | 0.646  | 0.458  | 0.969  | 1.988  |
|        |   6   | -0.765 | -0.487 | -0.181 | -0.323 | -0.04  | -0.275 | -0.429 | 0.413  | 0.534  |  0.63  | 1.395  |
|        |   7   | -0.918 | -0.659 | -0.149 | -0.239 | -0.002 | 0.076  | 0.273  | 0.309  | 0.355  | 0.676  | 1.594  |
|        |   8   | -1.537 | -0.798 | -0.79  | -0.386 | -0.164 | -0.058 | -0.127 | 0.143  | 0.275  | 0.667  | 2.205  |
|        |   9   | -1.312 | -1.003 | -0.961 | -0.559 | -0.569 | -0.486 | -0.378 | 0.221  | -0.05  | 0.225  | 1.536  |
|        |   10  | -1.497 | -1.629 | -1.01  | -1.305 | -0.99  | -0.801 | -0.715 | -0.348 | -0.502 | -0.066 | 1.431  |
|        |  Diff | -1.057 | -2.103 | -1.934 | -1.785 | -2.038 | -1.957 | -2.086 | -1.401 | -1.727 | -1.907 | -0.85  |
| 2020.0 |   1   |  0.23  | 0.022  | 0.614  | 0.927  | 0.523  | 1.044  | 0.959  | 1.124  | 1.273  | 1.867  | 1.637  |
|        |   2   | -0.196 | -0.132 | 0.246  |  0.41  | 0.343  | 0.486  | 0.765  | 0.851  | 1.197  | 1.628  | 1.824  |
|        |   3   | -0.435 | -0.397 | -0.089 | 0.152  | -0.056 |  0.45  | 0.429  |  0.74  | 1.072  | 1.295  |  1.73  |
|        |   4   | -0.823 | -0.261 | 0.059  |  0.19  | -0.096 | 0.364  | 0.348  | 0.438  | 0.645  | 0.952  | 1.775  |
|        |   5   | -0.614 | -0.623 | -0.055 | -0.146 | -0.07  |  0.04  | 0.166  | 0.375  | 0.511  | 0.746  |  1.36  |
|        |   6   | -0.933 | -0.574 | -0.774 | -0.133 | -0.194 | -0.236 | 0.176  | 0.301  | 0.547  | 0.627  |  1.56  |
|        |   7   | -1.388 | -0.506 | -0.445 | -0.479 | -0.142 | -0.575 |  0.27  |  0.09  | 0.466  | 0.863  | 2.251  |
|        |   8   | -0.719 | -1.014 | -1.063 | -0.313 | -0.218 | -0.042 | 0.194  | 0.205  | 0.223  |  0.86  | 1.578  |
|        |   9   | -1.729 | -1.054 | -0.891 | -1.075 | -0.912 | -0.011 | -0.14  | 0.048  | -0.149 | 0.479  | 2.208  |
|        |   10  | -1.749 | -1.711 | -1.213 | -1.071 | -0.96  | -1.143 | -0.949 | -0.404 | -0.356 | -0.342 | 1.407  |
|        |  Diff | -1.979 | -1.733 | -1.827 | -1.998 | -1.483 | -2.187 | -1.909 | -1.528 | -1.629 | -2.209 | -0.23  |
+--------+-------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+

+-------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+--------+
| Group |    1    |    2    |    3    |    4    |    5    |    6    |    7    |    8    |    9    |    10   |  Diff  |
+-------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+--------+
|   1   |  0.001  |  0.404  |  0.582  |  0.692  |  0.813  |  0.926  |  0.991  |  1.186  |  1.436  |  1.735  | 1.734  |
|       |  0.023  |  10.409 |  12.521 |  12.719 |  21.586 |  28.711 |  25.342 |  30.539 |  40.084 |  50.195 | 31.306 |
|   2   |  -0.329 |  -0.065 |  0.156  |  0.261  |  0.429  |   0.51  |  0.709  |  0.908  |  1.065  |   1.39  | 1.719  |
|       |  -5.829 |  -1.779 |  3.245  |  5.842  |  10.537 |  11.431 |  14.92  |  21.006 |  24.647 |  33.373 | 23.585 |
|   3   |  -0.538 |  -0.193 |  -0.021 |  0.183  |   0.3   |  0.453  |  0.533  |  0.646  |  0.851  |  1.242  |  1.78  |
|       | -13.214 |  -5.684 |  -0.454 |   6.47  |  12.997 |  11.485 |  13.978 |  17.107 |  27.073 |  25.137 | 21.695 |
|   4   |  -0.691 |  -0.332 |  -0.065 |  0.055  |  0.142  |  0.313  |  0.369  |  0.503  |  0.736  |  1.034  | 1.725  |
|       | -20.494 | -10.105 |  -1.874 |  1.247  |  3.242  |  9.129  |  9.121  |  12.057 |  15.833 |  24.654 | 26.702 |
|   5   |  -0.824 |  -0.439 |  -0.292 |  -0.184 |  0.028  |  0.137  |  0.242  |  0.407  |  0.639  |   0.93  | 1.755  |
|       | -19.074 |  -8.937 |  -8.189 |  -3.622 |  0.598  |  3.632  |  5.026  |   9.74  |  14.213 |  19.002 | 29.906 |
|   6   |  -0.999 |  -0.557 |  -0.383 |  -0.256 |  -0.102 |  0.019  |  0.078  |  0.255  |  0.506  |  0.711  |  1.71  |
|       |  -24.83 | -12.412 |  -9.966 |  -8.078 |  -2.96  |  0.627  |  1.588  |  4.753  |  13.01  |  16.397 | 24.858 |
|   7   |  -1.043 |  -0.701 |  -0.57  |  -0.472 |  -0.349 |  -0.163 |  -0.009 |  0.234  |  0.408  |  0.674  | 1.717  |
|       |  -22.39 | -18.651 | -15.173 |  -7.718 |  -8.648 |  -4.423 |  -0.261 |  5.529  |  12.285 |  13.125 | 28.054 |
|   8   |  -1.168 |  -0.845 |  -0.703 |  -0.513 |  -0.445 |  -0.338 |  -0.19  |  -0.023 |  0.114  |  0.617  | 1.786  |
|       | -37.234 | -18.681 | -14.622 | -11.528 | -11.526 |  -7.705 |  -4.063 |  -0.463 |  3.978  |  19.966 | 35.299 |
|   9   |  -1.419 |  -1.109 |  -0.998 |  -0.789 |  -0.593 |  -0.429 |  -0.291 |  -0.197 |  0.015  |  0.423  | 1.843  |
|       | -36.366 | -29.646 | -17.698 | -23.854 | -18.852 | -11.099 |  -7.294 |  -4.962 |  0.321  |  10.342 | 43.131 |
|   10  |  -1.796 |  -1.401 |  -1.233 |  -1.072 |  -0.943 |  -0.807 |  -0.669 |  -0.51  |  -0.271 |  -0.083 | 1.714  |
|       | -42.272 | -33.192 | -30.341 |  -35.35 | -22.034 | -17.648 | -14.833 | -10.624 |  -6.58  |  -1.658 | 26.054 |
|  Diff |  -1.798 |  -1.804 |  -1.815 |  -1.764 |  -1.756 |  -1.734 |  -1.66  |  -1.696 |  -1.707 |  -1.818 | -0.02  |
|       | -24.606 | -25.698 | -37.732 |  -26.27 | -33.109 | -28.342 | -30.244 | -24.987 | -26.689 | -30.782 | -0.234 |
+-------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+--------+
+-------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+--------+
| Group |    1    |    2    |    3    |    4    |    5    |    6    |    7    |    8    |    9    |    10   |  Diff  |
+-------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+--------+
|   1   |  0.001  |  0.404  |  0.582  |  0.692  |  0.813  |  0.926  |  0.991  |  1.186  |  1.436  |  1.735  | 1.734  |
|       |  0.023  |  10.409 |  12.521 |  12.719 |  21.586 |  28.711 |  25.342 |  30.539 |  40.084 |  50.195 | 31.306 |
| alpha |  0.001  |  0.393  |  0.588  |  0.695  |  0.814  |  0.928  |  0.994  |  1.182  |  1.431  |   1.73  |  1.73  |
|       |  0.023  |  15.172 |  16.757 |  18.333 |  25.684 |  52.337 |  53.463 |  33.971 |  32.144 | 120.675 | 64.353 |
|   2   |  -0.329 |  -0.065 |  0.156  |  0.261  |  0.429  |   0.51  |  0.709  |  0.908  |  1.065  |   1.39  | 1.719  |
|       |  -5.829 |  -1.779 |  3.245  |  5.842  |  10.537 |  11.431 |  14.92  |  21.006 |  24.647 |  33.373 | 23.585 |
| alpha |  -0.328 |  -0.067 |  0.168  |  0.257  |  0.433  |  0.526  |  0.708  |   0.9   |  1.064  |  1.385  | 1.712  |
|       |  -6.882 |  -4.699 |  5.144  |  5.719  |  9.258  |  16.709 |  46.722 |  30.124 |  48.315 |   54.9  | 33.901 |
|   3   |  -0.538 |  -0.193 |  -0.021 |  0.183  |   0.3   |  0.453  |  0.533  |  0.646  |  0.851  |  1.242  |  1.78  |
|       | -13.214 |  -5.684 |  -0.454 |   6.47  |  12.997 |  11.485 |  13.978 |  17.107 |  27.073 |  25.137 | 21.695 |
| alpha |  -0.532 |  -0.187 |  -0.021 |  0.179  |  0.299  |   0.45  |  0.523  |  0.654  |  0.847  |  1.227  |  1.76  |
|       | -15.226 | -10.095 |  -0.443 |  12.856 |  25.329 |  18.972 |  12.407 |  18.425 |  31.055 |  24.734 | 21.164 |
|   4   |  -0.691 |  -0.332 |  -0.065 |  0.055  |  0.142  |  0.313  |  0.369  |  0.503  |  0.736  |  1.034  | 1.725  |
|       | -20.494 | -10.105 |  -1.874 |  1.247  |  3.242  |  9.129  |  9.121  |  12.057 |  15.833 |  24.654 | 26.702 |
| alpha |  -0.695 |  -0.335 |  -0.063 |  0.049  |  0.146  |  0.317  |  0.365  |  0.508  |  0.749  |  1.039  | 1.735  |
|       | -34.692 |  -8.032 |  -2.253 |  1.587  |  4.982  |  8.723  |  19.073 |  18.714 |  10.766 |  59.53  | 53.763 |
|   5   |  -0.824 |  -0.439 |  -0.292 |  -0.184 |  0.028  |  0.137  |  0.242  |  0.407  |  0.639  |   0.93  | 1.755  |
|       | -19.074 |  -8.937 |  -8.189 |  -3.622 |  0.598  |  3.632  |  5.026  |   9.74  |  14.213 |  19.002 | 29.906 |
| alpha |  -0.828 |  -0.441 |  -0.289 |  -0.196 |  0.034  |  0.141  |  0.242  |  0.402  |  0.633  |  0.924  | 1.752  |
|       |  -50.38 |  -17.93 | -14.905 |  -6.066 |  1.608  |  5.277  |   6.61  |  16.518 |  12.557 |  21.612 | 44.153 |
|   6   |  -0.999 |  -0.557 |  -0.383 |  -0.256 |  -0.102 |  0.019  |  0.078  |  0.255  |  0.506  |  0.711  |  1.71  |
|       |  -24.83 | -12.412 |  -9.966 |  -8.078 |  -2.96  |  0.627  |  1.588  |  4.753  |  13.01  |  16.397 | 24.858 |
| alpha |  -1.001 |  -0.553 |  -0.385 |  -0.264 |  -0.106 |  0.026  |  0.094  |  0.266  |  0.507  |  0.717  | 1.718  |
|       | -69.664 | -17.632 |  -7.841 | -11.507 |  -4.864 |  1.416  |  2.265  |  8.531  |  13.376 |  32.65  | 60.333 |
|   7   |  -1.043 |  -0.701 |  -0.57  |  -0.472 |  -0.349 |  -0.163 |  -0.009 |  0.234  |  0.408  |  0.674  | 1.717  |
|       |  -22.39 | -18.651 | -15.173 |  -7.718 |  -8.648 |  -4.423 |  -0.261 |  5.529  |  12.285 |  13.125 | 28.054 |
| alpha |  -1.036 |  -0.695 |  -0.58  |  -0.467 |  -0.348 |  -0.161 |  -0.013 |  0.236  |  0.413  |   0.68  | 1.716  |
|       | -15.761 | -26.285 | -30.789 |  -9.662 | -21.064 |  -10.49 |  -0.54  |  11.513 |  13.003 |  16.793 | 26.971 |
|   8   |  -1.168 |  -0.845 |  -0.703 |  -0.513 |  -0.445 |  -0.338 |  -0.19  |  -0.023 |  0.114  |  0.617  | 1.786  |
|       | -37.234 | -18.681 | -14.622 | -11.528 | -11.526 |  -7.705 |  -4.063 |  -0.463 |  3.978  |  19.966 | 35.299 |
| alpha |  -1.165 |  -0.866 |  -0.695 |  -0.521 |  -0.441 |  -0.334 |  -0.192 |  -0.014 |  0.117  |  0.612  | 1.777  |
|       | -68.442 | -47.472 | -16.293 | -18.214 | -13.313 | -20.344 |  -6.396 |  -0.495 |  8.054  |  37.427 | 74.827 |
|   9   |  -1.419 |  -1.109 |  -0.998 |  -0.789 |  -0.593 |  -0.429 |  -0.291 |  -0.197 |  0.015  |  0.423  | 1.843  |
|       | -36.366 | -29.646 | -17.698 | -23.854 | -18.852 | -11.099 |  -7.294 |  -4.962 |  0.321  |  10.342 | 43.131 |
| alpha |  -1.421 |  -1.101 |  -0.999 |  -0.796 |  -0.586 |  -0.43  |  -0.297 |  -0.208 |  0.008  |  0.422  | 1.843  |
|       | -58.572 | -36.794 | -24.981 | -57.723 | -40.075 | -22.395 | -11.038 |  -8.076 |  0.188  |  12.12  | 79.95  |
|   10  |  -1.796 |  -1.401 |  -1.233 |  -1.072 |  -0.943 |  -0.807 |  -0.669 |  -0.51  |  -0.271 |  -0.083 | 1.714  |
|       | -42.272 | -33.192 | -30.341 |  -35.35 | -22.034 | -17.648 | -14.833 | -10.624 |  -6.58  |  -1.658 | 26.054 |
| alpha |  -1.792 |  -1.396 |  -1.235 |  -1.075 |  -0.934 |  -0.802 |  -0.676 |  -0.504 |  -0.27  |  -0.078 | 1.714  |
|       | -94.079 | -29.367 | -24.322 | -49.929 | -18.363 | -22.423 | -17.282 | -12.055 |  -6.679 |  -2.087 | 64.666 |
|  Diff |  -1.798 |  -1.804 |  -1.815 |  -1.764 |  -1.756 |  -1.734 |  -1.66  |  -1.696 |  -1.707 |  -1.818 | -0.02  |
|       | -24.606 | -25.698 | -37.732 |  -26.27 | -33.109 | -28.342 | -30.244 | -24.987 | -26.689 | -30.782 | -0.234 |
| alpha |  -1.792 |  -1.789 |  -1.823 |  -1.77  |  -1.749 |  -1.73  |  -1.671 |  -1.686 |   -1.7  |  -1.808 | -0.016 |
|       | -68.889 | -25.304 | -35.662 | -49.993 | -23.566 | -35.304 | -39.998 | -48.493 | -20.813 | -57.675 | -0.471 |
+-------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+--------+
```



### fama_macbeth

This module is designed for Fama_Macbeth regression(1976). 

Fama-Macbeth Regression follows two steps:

1.  Specify the model and take cross-sectional regression.
2.  Take the time-series average of regression coefficient

For more details, please read Empirical Asset Pricing: The Cross Section of Stock Returns. Bali, Engle, Murray, 2016.



#### class Fama_macbeth_regress():

Package Needed: numpy, statsmodels, scipy, prettytable.

##### def \__init__(self, sample):

**input :**

*sample :* data for analysis. The structure of the sample : 

​                The first column is dependent variable/ test portfolio return.

​                The second to the last-1 columns are independent variable/ factor loadings.

​                The last column is the time label.

##### def divide_by_time(self, sample):

This function group the sample by time.

**input :**

*sample :* The data for analysis in the \__init__ function.

**output :**

*groups_by_time :* The sample grouped by time.



##### def cross_sectional_regress(self, add_constant=True):

This function conducts the first step of Fama-Macebth Regression Fama-Macbeth, that taking the cross-sectional regression for each period.

**input :** 

*add_constant :* whether add intercept when take the cross-sectional regression

**output :**

*parameters :* The regression coefficient/factor risk premium, whose rows are the group coefficient and columns are regression variable.

*tvalue :* t value for the coefficient.

*rsquare :* The r-square.

*adjrsq :*  The adjust r-square.

*n :* The sample quantity in each group.



##### def time_series_average(self, **kwargs):

This function conducts the second step of Fama-Macbeth regression, take the time series average of cross section regression.



##### def fit(self, **kwargs):

This function fits the model by running the time_series_average function.

**Example**

```
import numpy as np
from fama_macbeth import Fama_macbeth_regress
    
# construct sample
year=np.ones((3000,1),dtype=int)*2020
for i in range(19):
    year=np.append(year,(2019-i)*np.ones((3000,1),dtype=int))
character=np.random.normal(0,1,(2,20*3000))
# print('Character:',character)
ret=np.array([-0.5,-1]).dot(character)+np.random.normal(0,1,20*3000)
sample=np.array([ret,character[0],character[1],year]).T    
# print('Sample:',sample)
# print(sample.shape)

model = Fama_macbeth_regress(sample)
result = model.fit(add_constant=False)
print(result)
=========================================================================
para_average: [-0.501 -1.003]
tvalue: [-111.857 -202.247]
R: 0.5579113793318332
ADJ_R: 0.5576164569698131
sample number N: 3000.0
```



##### def summary_by_time(self):

This function summarize the cross-section regression result at each time.

Package needed: prettytable.

**Example**

```
# continue the previous code
model.summary_by_time()
==========================================================================
+--------+-----------------+----------+--------------+---------------+
|  Year  |      Param      | R Square | Adj R Square | Sample Number |
+--------+-----------------+----------+--------------+---------------+
| 2001.0 | [-0.499 -0.990] |   0.53   |     0.53     |      3000     |
| 2002.0 | [-0.524 -0.987] |   0.56   |     0.56     |      3000     |
| 2003.0 | [-0.544 -1.015] |   0.58   |     0.58     |      3000     |
| 2004.0 | [-0.474 -0.948] |   0.53   |     0.53     |      3000     |
| 2005.0 | [-0.502 -1.007] |   0.57   |     0.57     |      3000     |
| 2006.0 | [-0.497 -0.981] |   0.55   |     0.55     |      3000     |
| 2007.0 | [-0.526 -1.020] |   0.57   |     0.57     |      3000     |
| 2008.0 | [-0.476 -1.024] |   0.56   |     0.56     |      3000     |
| 2009.0 | [-0.533 -1.011] |   0.57   |     0.57     |      3000     |
| 2010.0 | [-0.493 -1.029] |   0.57   |     0.57     |      3000     |
| 2011.0 | [-0.504 -0.975] |   0.55   |     0.55     |      3000     |
| 2012.0 | [-0.508 -1.002] |   0.56   |     0.56     |      3000     |
| 2013.0 | [-0.474 -1.015] |   0.56   |     0.56     |      3000     |
| 2014.0 | [-0.503 -0.998] |   0.55   |     0.55     |      3000     |
| 2015.0 | [-0.485 -1.034] |   0.55   |     0.55     |      3000     |
| 2016.0 | [-0.514 -1.005] |   0.57   |     0.57     |      3000     |
| 2017.0 | [-0.498 -1.016] |   0.58   |     0.58     |      3000     |
| 2018.0 | [-0.475 -0.994] |   0.55   |     0.55     |      3000     |
| 2019.0 | [-0.487 -0.974] |   0.54   |     0.54     |      3000     |
| 2020.0 | [-0.511 -1.031] |   0.56   |     0.56     |      3000     |
+--------+-----------------+----------+--------------+---------------+

```



##### def summary(self, charactername=None):

This function summarize the final result.

**input :**

*charactername :* The factors' name in the cross-section regression model.

**Example**

```python
# continue the previous code
model.summary()
================================================================================
+-----------------+---------------------+-----------+---------------+-----------+
|      Param      |     Param Tvalue    | Average R | Average adj R | Average n |
+-----------------+---------------------+-----------+---------------+-----------+
| [-0.501 -1.003] | [-111.857 -202.247] |   0.558   |     0.558     |   3000.0  |
+-----------------+---------------------+-----------+---------------+-----------+
```



#### class Factor_mimicking_portfolio

This class is designed for generating factor mimicking portfolio following the Fama-French (1993) conventions, and then calculating factor risk premium.

Fama-French (1993) conventions.

| Size\Factor  | Low(<=30%) | Medium(30%< & <=70%) | High(>70%) |
| ------------ | ---------- | -------------------- | ---------- |
| Small(<=50%) | S/L        | S/M                  | S/H        |
| Big(>50%)    | B/L        | B/M                  | B/H        |

1. Group stocks by two dimensions. One dimension is size, divided by 50% small stocks and 50% big stocks. The other is the factor, divided by 30% tail factor stocks, 30%~70% factor stocks, and 70%~100% factor stocks.

2. Calculate market value weighted portfolio return and factor risk premium.
   $$
   SMB=1/3(S/L+S/M+S/H)-1/3(B/L+B/M+B/H)
   $$

   $$
   Factor=1/2(S/H+B/H)-1/2(S/L+B/L)
   $$

3. 

In Fama-French (1993), the factor is book-to-market ratio, and other literatures follow the same way to construct factor mimicking portfolio. The return of each portfolio is represented by the market value weighted portfolio return.  

##### def \__init__(self, sample, perc_row=[0, 50, 100], perc_col=[0, 30, 70, 100], weight=True):

This function initializes the object.

**input :**

*sample :* data for analysis. The structure of the sample : 

​                The first column is dependent variable/ test portfolio return.

​                The second is the first factor.

​                The third is the second factor.

​                The fourth is the timestamp.

​                The fifth is the weight.

*perc_row :* The percentiles that divide stocks by the first factor. The **Default** percentile is [0, 50, 100].

*perc_col :* The percentiles that divide stocks by the second factor. The **Default** percentile is [0, 30, 70, 100].

*weight :* Whether the portfolio return calculated by weight. The **Default** is True.



##### def portfolio_return_time(self):

This function is to construct portfolio and calculate the average return and difference matrix.

**output :** 

*diff :* The differenced portfolio return matrix.

```python
'''
TEST Factor_mimicking_portfolio
construct sample:
    1. 20 Periods
    2. 3000 Observations for each Period
    3. Character negative with return following the return=character*-0.5+sigma where sigma~N(0,1)
'''
import numpy as np
from fama_macbeth import Factor_mimicking_portfolio
    
# construct sample
year=np.ones((3000,1),dtype=int)*2020
for i in range(19):
    year=np.append(year,(2019-i)*np.ones((3000,1),dtype=int))
character=np.random.normal(0, 1, (2, 20*3000))
weight = np.random.uniform(0, 1, (1, 20*3000))
#    print('Character:',character)
ret=np.array([-0.5,-1]).dot(character)+np.random.normal(0,1,20*3000)
sample=np.array([ret, character[0], character[1], year, weight[0]]).T    
#    print('Sample:',sample)
#    print(sample.shape)

model = Factor_mimicking_portfolio(sample)
portfolio_return_time = model.portfolio_return_time()
print('portfolio_return_time:', portfolio_return_time)
print('portfolio_return_time:', np.shape(portfolio_return_time))
========================================================================
portfolio_return_time: 
 [[[ 1.6302854   1.5920872   1.54199455  1.47560967  1.60182404
    1.48860463  1.70067317  1.57084898  1.52938766  1.54919833
    1.58910675  1.44369383  1.6489323   1.57230951  1.64104889
    1.52816059  1.53197648  1.44067358  1.55358692  1.60347805]
  [ 0.27087317  0.37938255  0.46473997  0.43118946  0.36934624
    0.3215685   0.51716485  0.3740702   0.38663032  0.44333387
    0.38917603  0.31347239  0.30760233  0.41415477  0.45250083
    0.4439825   0.35821053  0.40601508  0.40495275  0.46236114]
  [-0.77286286 -0.67348462 -0.79216628 -0.76712914 -0.73108828
   -0.74141791 -0.85011447 -0.65743291 -0.57583562 -0.80490414
   -0.64311824 -0.79901273 -0.81325556 -0.84443278 -0.80362147
   -0.75246184 -0.61693674 -0.69909426 -0.68554981 -0.6564971 ]
  [-2.40314826 -2.26557182 -2.33416083 -2.24273881 -2.33291232
   -2.23002254 -2.55078764 -2.22828188 -2.10522328 -2.35410248
   -2.23222499 -2.24270656 -2.46218786 -2.41674229 -2.44467035
   -2.28062243 -2.14891322 -2.13976784 -2.23913673 -2.25997515]]

 [[ 0.73368397  0.87086931  0.69626265  0.83424514  0.75825827
    0.65550255  0.79076344  0.77316807  0.82031302  0.83320932
    0.76971902  0.81248391  0.74568233  0.7749383   0.69168886
    0.7511554   0.70757116  0.75320784  0.78223447  0.73699303]
  [-0.55494493 -0.4097451  -0.42006211 -0.36317491 -0.47791724
   -0.40042274 -0.36004971 -0.39127871 -0.4712118  -0.33368187
   -0.48957933 -0.41103346 -0.46612991 -0.39504384 -0.34021312
   -0.41049521 -0.33209925 -0.39212119 -0.42890556 -0.40389983]
  [-1.63941363 -1.52575966 -1.55711119 -1.45657452 -1.53325438
   -1.5163362  -1.4984305  -1.50929504 -1.52485715 -1.60331314
   -1.56591033 -1.60738805 -1.77875307 -1.4963315  -1.65246163
   -1.55526031 -1.40809313 -1.49853102 -1.56149388 -1.48409324]
  [-2.3730976  -2.39662897 -2.25337384 -2.29081966 -2.29151265
   -2.17183875 -2.28919394 -2.28246311 -2.34517017 -2.43652246
   -2.33562934 -2.41987196 -2.5244354  -2.27126981 -2.34415049
   -2.30641572 -2.11566429 -2.25173887 -2.34372835 -2.22108628]]

 [[-0.89660143 -0.72121789 -0.8457319  -0.64136454 -0.84356577
   -0.83310208 -0.90990973 -0.79768091 -0.70907464 -0.71598901
   -0.81938773 -0.63120993 -0.90324997 -0.7973712  -0.94936003
   -0.77700518 -0.82440531 -0.68746574 -0.77135245 -0.86648502]
  [-0.82581811 -0.78912765 -0.88480208 -0.79436437 -0.84726347
   -0.72199124 -0.87721456 -0.7653489  -0.85784212 -0.77701574
   -0.87875536 -0.72450585 -0.77373224 -0.80919861 -0.79271394
   -0.85447771 -0.69030979 -0.79813627 -0.83385831 -0.86626098]
  [-0.86655077 -0.85227505 -0.76494491 -0.68944538 -0.8021661
   -0.77491829 -0.64831603 -0.85186213 -0.94902153 -0.798409
   -0.92279209 -0.80837532 -0.96549751 -0.65189873 -0.84884016
   -0.80279847 -0.79115639 -0.79943676 -0.87594408 -0.82759615]
  [ 0.03005066 -0.13105715  0.08078699 -0.04808085  0.04139968
    0.05818379  0.26159369 -0.05418122 -0.23994689 -0.08241999
   -0.10340436 -0.17716539 -0.06224754  0.14547248  0.10051987
   -0.02579329  0.03324893 -0.11197102 -0.10459162  0.03888887]]]
portfolio_return_time: 
 (3, 4, 20)
```



##### def portfolio_return(self):

This function is to construct factor risk premium.

**output :**

*return_row :* The first factor risk premium. The **Default** is size factor.

*return_col :* The second factor risk premium. 

```python
# Continue the previous code
portfolio_return = model.portfolio_return()
print('portfolio_return_row: \n', portfolio_return[0])
print('portfolio_return_row:', np.shape(portfolio_return[0]))
print('portfolio_return_col: \n', portfolio_return[1])
print('portfolio_return_col:', np.shape(portfolio_return[1]))
==============================================================
portfolio_return_row: 
 1970-01-01 00:00:00.000002001   -0.639730
1970-01-01 00:00:00.000002002   -0.623419
1970-01-01 00:00:00.000002003   -0.603673
1970-01-01 00:00:00.000002004   -0.543314
1970-01-01 00:00:00.000002005   -0.612899
1970-01-01 00:00:00.000002006   -0.567957
1970-01-01 00:00:00.000002007   -0.543462
1970-01-01 00:00:00.000002008   -0.617268
1970-01-01 00:00:00.000002009   -0.688971
1970-01-01 00:00:00.000002010   -0.593458
1970-01-01 00:00:00.000002011   -0.681085
1970-01-01 00:00:00.000002012   -0.585314
1970-01-01 00:00:00.000002013   -0.676182
1970-01-01 00:00:00.000002014   -0.528249
1970-01-01 00:00:00.000002015   -0.622599
1970-01-01 00:00:00.000002016   -0.615019
1970-01-01 00:00:00.000002017   -0.568156
1970-01-01 00:00:00.000002018   -0.599252
1970-01-01 00:00:00.000002019   -0.646437
1970-01-01 00:00:00.000002020   -0.630363
dtype: float64
portfolio_return_row: (20,)
portfolio_return_col: 
 1970-01-01 00:00:00.000002001   -1.582065
1970-01-01 00:00:00.000002002   -1.597753
1970-01-01 00:00:00.000002003   -1.502249
1970-01-01 00:00:00.000002004   -1.527213
1970-01-01 00:00:00.000002005   -1.527675
1970-01-01 00:00:00.000002006   -1.447892
1970-01-01 00:00:00.000002007   -1.526129
1970-01-01 00:00:00.000002008   -1.521642
1970-01-01 00:00:00.000002009   -1.563447
1970-01-01 00:00:00.000002010   -1.624348
1970-01-01 00:00:00.000002011   -1.557086
1970-01-01 00:00:00.000002012   -1.613248
1970-01-01 00:00:00.000002013   -1.682957
1970-01-01 00:00:00.000002014   -1.514180
1970-01-01 00:00:00.000002015   -1.562767
1970-01-01 00:00:00.000002016   -1.537610
1970-01-01 00:00:00.000002017   -1.410443
1970-01-01 00:00:00.000002018   -1.501159
1970-01-01 00:00:00.000002019   -1.562486
1970-01-01 00:00:00.000002020   -1.480724
dtype: float64
portfolio_return_col: (20,)
```



###  time_series_regress

#### class TS_regress()

This class is designed for time series regression, 
$$
r_{i,t} = \beta_if_t + \epsilon_{i,t}
$$
to obtain the beta for each asset.

##### def \__init__(self, list_y, factor):

This function initializes the object.

**input :**

*list_y :* The return matrix with i rows and t columns.

*factor :* The factor risk premium return series.



##### def ts_regress(self, newey_west=*True*):

This function is for conducting the time series regression.

**input :**

*newey_west ：* conduct the newey_west adjustment or not.

**output :**

*self.alpha :* The regression alpha.

*self.e_mat :* The error matrix

**Example**

```python
from statsmodels.base.model import Model
from statsmodels.tools.tools import add_constant
from EAP.time_series_regress import TS_regress

X = np.random.normal(loc=0.0, scale=1.0, size=(2000,10))
y_list = []
for i in range(10) :
    b = np.random.uniform(low=0.1, high=1.1, size=(10,1))
    e = np.random.normal(loc=0.0, scale=1.0, size=(2000,1))
    y = X.dot(b) + e 
    y_list.append(y)

re = TS_regress(y_list, X)
```



##### def fit(self, **kwargs):

This function runs the function, ts_regress.

**Example**

```python
# continue the previous code
re.fit()
```



##### def summary(self):

This function summarize the result, including the GRS test.

**Example**

```python
# continue the previous code
re.summary()
=============================================================================
----------------------------------- GRS Test -------------------------------- 

GRS Statistics: 
 [[0.67160203]]
GRS p_value: 
 [[0.75175471]]
------------------------------------------------------------------------------
```



##### def grs(self):

This function conducts the GRS test.

**output :**

*grs_stats :* The GRS statistics.

*p_value :* The p_value.

**Example**

```python
# continue the previous code
print(re.grs())
==============================================
(array([[0.67160203]]), array([[0.75175471]]))
```



### cross_section_regress

#### class CS_regress()

##### def \__init__(self, y_list, factor):

This function initializes the class.

**input :**

*y_list :* The assets return series list.

*factor :* The factor risk premium series.



##### def ts_regress(self):

This function conducts the time series regression.

**output :**

*beta(N, c) :* The betas for each asset.

*err_mat :* The error matrix.



##### def ave(self):

This function conducts the average operation on the assets returns series list.

**output :**

*np.mean(self.y_list, axis=1)* : The average of the assets returns series list.



##### def cs_regress(self, beta, err_mat, constant=*True*, gls=*True*, **kwargs):

This function takes the cross-sectional regression.

**input :**

*beta :* The betas from the output of the function ts_regress().

*err_mat :* The error matrix from the output of the function ts_regress().

*constant :* add constant or not. The default is add constant.

*gls :* GLS regression or OLS regression. The default is GLS regression.

**output :**

*params :* The params of the cross regression model.

*resid :* The residue of the cross regression model.

**Example**

```python
from statsmodels.regression.linear_model import GLS
from EAP.cross_section_regress import CS_regress
import numpy as np
    
X = np.random.normal(loc=0, scale=0.1, size=(2000,3))
y_list = []
for i in range(100) :
    b = np.random.uniform(low=-1, high=1, size=(3,1))
    e = np.random.normal(loc=0.0, scale=0.5, size=(2000,1))
    alpha = np.random.normal(loc=0.0, scale=0.5)
    y = X.dot(b)  + e 
    y_list.append(y)
print(np.mean(X, axis= 0)) # average return of the factor risk premium 
========================================================================
[-0.00496423  0.00146649 -0.0004722 ]
```



##### def cov_mat(self, beta, err_mat, shanken=*True*, constant=*True*, gls=*True*, **kwargs):

This function calculates the covariance matrix of the cross regression model. 

**input :**

*beta :* The betas from the output of the function ts_regress().

*err_mat :* The error matrix from the output of the function ts_regress().

*shanken :* Take the shanken adjustment or not. The default is *True*.

*constant :* add constant or not.

*gls :* GLS regression or OLS regression. The default is GLS regression.

**output :**

*param_cov_mat :* The covariance matrix of the parameters.

*resid_cov_mat :* The covariance matrix of the residue.



##### def t_test(self, param_cov_mat, params):

This function takes t-test for parameters.

**input :**

*param_cov_mat :* The covariance matrix of the parameters from the function cov_mat.

*params :* The parameters from the function cs_regress.

**output :**

*t_value :* The t-value for statistical inference.

*p_value :* The p-value for statistical inference.



##### def union_test(self, resid_cov_mat, resid):

This function takes union test for parameters.

**input :**

*resid_cov_mat :* The covariance matrix of the residue. 

*resid :* The residue from the function cs_regress.

**output :**

*chi_square :* The chi-square statistics.

*p_value :* The p-value corresponding to the chi-square.



##### def fit(self, **kwargs):

This function runs the cross-sectional regression and takes the statistical inference.



##### def summary(self):

This function print the summary. 

 **Example**

```python
# continue the previous code
print("\n---------------------GLS: Constant=True shanken=True------------------------\n")
re = CS_regress(y_list, X)
re.fit()
re.summary()
print("\n------------------------------------------------------------------------\n")
    
print("\n---------------------GLS: Constant=False shanken=True------------------------\n")
re = CS_regress(y_list, X)
re.fit(constant=False)
re.summary()
print("\n------------------------------------------------------------------------\n")
    
print("\n---------------------GLS: Constant=True shanken=False------------------------\n")
re = CS_regress(y_list, X)
re.fit(shanken=False)
re.summary()
print("\n------------------------------------------------------------------------\n")
    
print("\n---------------------GLS: Constant=False shanken=False------------------------\n")
re = CS_regress(y_list, X)
re.fit(constant=False, shanken=False)
re.summary()
print("\n------------------------------------------------------------------------\n")
    
print("\n---------------------OLS: Constant=True shanken=True------------------------\n")
re = CS_regress(y_list, X)
re.fit(gls=False)
re.summary()
print("\n------------------------------------------------------------------------\n")
    
print("\n---------------------OLS: Constant=False shanken=True------------------------\n")
re = CS_regress(y_list, X)
re.fit(constant=False, gls=False)
re.summary()
print("\n------------------------------------------------------------------------\n")
    
print("\n---------------------OLS: Constant=True shanken=False------------------------\n")
re = CS_regress(y_list, X)
re.fit(shanken=False, gls=False)
re.summary()
print("\n------------------------------------------------------------------------\n")
    
print("\n---------------------OLS: Constant=False shanken=False------------------------\n")
re = CS_regress(y_list, X)
re.fit(constant=False, shanken=False, gls=False)
re.summary()
print("\n------------------------------------------------------------------------\n")
================================================================================================================================
---------------------GLS: Constant=True shanken=True------------------------


-------------------------- Risk Premium ------------------------------

+-----------------------+---------------+--------------+
|         params        |    t_value    |   p_value    |
+-----------------------+---------------+--------------+
| -0.004239493082637248 | [-1.49931456] | [0.13394995] |
| 0.0018754489425203834 |  [0.64798047] |  [0.517072]  |
| -0.002623980021497935 | [-0.92194337] | [0.35666937] |
+-----------------------+---------------+--------------+

----------------------------------------------------------------------


----------------------------- Alpha test -----------------------------

+-----------------+----------------+
|    chi-square   |    p_value     |
+-----------------+----------------+
| [[89.27084753]] | [[0.69922497]] |
+-----------------+----------------+

----------------------------------------------------------------------


------------------------------------------------------------------------


---------------------GLS: Constant=False shanken=True------------------------


-------------------------- Risk Premium ------------------------------

+------------------------+---------------+--------------+
|         params         |    t_value    |   p_value    |
+------------------------+---------------+--------------+
| -0.0044337140100835495 | [-1.56801135] | [0.11703675] |
| 0.0014489988306153607  |  [0.50064261] | [0.61667778] |
| -0.0025199902303684996 |  [-0.8854116] | [0.37604117] |
+------------------------+---------------+--------------+

----------------------------------------------------------------------


----------------------------- Alpha test -----------------------------

+------------------+----------------+
|    chi-square    |    p_value     |
+------------------+----------------+
| [[123.73200185]] | [[0.03486519]] |
+------------------+----------------+

----------------------------------------------------------------------


------------------------------------------------------------------------


---------------------GLS: Constant=True shanken=False------------------------


-------------------------- Risk Premium ------------------------------

+-----------------------+---------------+--------------+
|         params        |    t_value    |   p_value    |
+-----------------------+---------------+--------------+
| -0.004239493082637248 | [-1.50013478] | [0.13373741] |
| 0.0018754489425203834 |  [0.64838824] | [0.51680835] |
| -0.002623980021497935 | [-0.92243422] | [0.35641345] |
+-----------------------+---------------+--------------+

----------------------------------------------------------------------


----------------------------- Alpha test -----------------------------

+-----------------+---------+
|    chi-square   | p_value |
+-----------------+---------+
| [[32.53458229]] |  [[1.]] |
+-----------------+---------+

----------------------------------------------------------------------


------------------------------------------------------------------------


---------------------GLS: Constant=False shanken=False------------------------


-------------------------- Risk Premium ------------------------------

+------------------------+---------------+--------------+
|         params         |    t_value    |   p_value    |
+------------------------+---------------+--------------+
| -0.0044337140100835495 | [-1.56885941] | [0.11683897] |
| 0.0014489988306153607  |  [0.50095408] | [0.6164586]  |
| -0.0025199902303684996 | [-0.88587763] | [0.37579002] |
+------------------------+---------------+--------------+

----------------------------------------------------------------------


----------------------------- Alpha test -----------------------------

+------------------+---------+
|    chi-square    | p_value |
+------------------+---------+
| [[-49.33885529]] |  [[1.]] |
+------------------+---------+

----------------------------------------------------------------------


------------------------------------------------------------------------


---------------------OLS: Constant=True shanken=True------------------------


-------------------------- Risk Premium ------------------------------

+------------------------+---------------+--------------+
|         params         |    t_value    |   p_value    |
+------------------------+---------------+--------------+
| -0.004191679829911098  | [-1.46410802] | [0.14332167] |
| 0.0026957168215120215  |  [0.91917806] | [0.35811334] |
| -0.0028054613152236852 |  [-0.9776489] | [0.3283663]  |
+------------------------+---------------+--------------+

----------------------------------------------------------------------


----------------------------- Alpha test -----------------------------

+------------------+----------------+
|    chi-square    |    p_value     |
+------------------+----------------+
| [[105.04417306]] | [[0.27097431]] |
+------------------+----------------+

----------------------------------------------------------------------


------------------------------------------------------------------------


---------------------OLS: Constant=False shanken=True------------------------


-------------------------- Risk Premium ------------------------------

+-----------------------+---------------+--------------+
|         params        |    t_value    |   p_value    |
+-----------------------+---------------+--------------+
| -0.004314458572417905 | [-1.50700942] | [0.13196625] |
|  0.002435573118655651 |  [0.83048514] | [0.40636372] |
| -0.002772551881136359 | [-0.96619054] | [0.33406572] |
+-----------------------+---------------+--------------+

----------------------------------------------------------------------


----------------------------- Alpha test -----------------------------

+------------------+----------------+
|    chi-square    |    p_value     |
+------------------+----------------+
| [[117.95438501]] | [[0.07282442]] |
+------------------+----------------+

----------------------------------------------------------------------


------------------------------------------------------------------------


---------------------OLS: Constant=True shanken=False------------------------


-------------------------- Risk Premium ------------------------------

+------------------------+---------------+--------------+
|         params         |    t_value    |   p_value    |
+------------------------+---------------+--------------+
| -0.004191679829911098  | [-1.46507223] | [0.14305847] |
| 0.0026957168215120215  |  [0.91987006] | [0.35775165] |
| -0.0028054613152236852 |  [-0.9782681] | [0.32806011] |
+------------------------+---------------+--------------+

----------------------------------------------------------------------


----------------------------- Alpha test -----------------------------

+------------------+---------------+
|    chi-square    |    p_value    |
+------------------+---------------+
| [[144.80511192]] | [[0.0011985]] |
+------------------+---------------+

----------------------------------------------------------------------


------------------------------------------------------------------------


---------------------OLS: Constant=False shanken=False------------------------


-------------------------- Risk Premium ------------------------------

+-----------------------+---------------+--------------+
|         params        |    t_value    |   p_value    |
+-----------------------+---------------+--------------+
| -0.004314458572417905 | [-1.50798575] | [0.13171619] |
|  0.002435573118655651 |  [0.8311002]  | [0.40601628] |
| -0.002772551881136359 | [-0.96679254] | [0.3337647]  |
+-----------------------+---------------+--------------+

----------------------------------------------------------------------


----------------------------- Alpha test -----------------------------

+------------------+----------------+
|    chi-square    |    p_value     |
+------------------+----------------+
| [[100.02211446]] | [[0.39645777]] |
+------------------+----------------+

----------------------------------------------------------------------


------------------------------------------------------------------------
```



### adjust

This module consists of several common adjustment method in factor analysis.

##### def ols(y, x, constant=*True*):

The function is for OLS regression, which is equal to the OLS module in package *statsmodels*. 

**input :**

*y :* The dependent variable.

*x :* The explanatory variable.

*constant :* add constant or not in OLS model. The default is *True*.

**output :**

*result :* The result of the regression.

```python
import numpy as np
from statsmodels.base.model import Model
from statsmodels.tools.tools import add_constant
from EAP.adjust import newey_west, newey_west_t, ols, white_t
from EAP.adjust import white

X = np.random.normal(loc=0.0, scale=1.0, size=(2000,10))
b = np.random.uniform(low=0.1, high=1.1, size=(10,1))
e = np.random.normal(loc=0.0, scale=1.0, size=(2000,1))
y = X.dot(b) + e + 1.0

re = ols(y, X, constant=True)
print('\nTrue b : ', b)
print('\nEstimated b : ', re.params)
print('\nresidue : ', re.resid.shape)
====================================================
True b :  [[0.59169091]
 [0.91342353]
 [0.19599503]
 [0.9112773 ]
 [0.70647024]
 [0.41873624]
 [0.64871071]
 [0.20685505]
 [0.13172035]
 [0.82358063]]

Estimated b :  [1.00206596 0.57602159 0.91832825 0.2104454  0.935377   0.71526534
 0.39181771 0.65432445 0.22666925 0.13173488 0.83208811]

residue :  (2000,)
```



##### def white(y, X, **kwargs):

This function is for the White test. White estimate of variance:

X(r,c): r is sample number, c is variable number, S0 is covariance matrix of residue.

The variance estimate is 
$$
V_{ols}=T(X^`X)^{-1}S_0(X^`X)^{-1}.
$$
The white estimation of S0 is 
$$
S_0=\frac 1T X^`(XR).
$$
**input :**

*y :* The dependent variable.

*X :* The explanatory variable.

**output :**

*V_ols :* The white variance estimate

**Example**

```python
# continue the previous code
import numpy as np
from statsmodels.api import add_constant

X = np.random.normal(loc=0.0, scale=1.0, size=(2000,10))
b = np.random.uniform(low=0.1, high=1.1, size=(10,1))
e = np.random.normal(loc=0.0, scale=1.0, size=(2000,1))
y = X.dot(b) + e + 1.0

re = white(y, X, constant=True)
np.set_printoptions(formatter={'float':'{:0.3f}'.format})
print(re*100)
X = add_constant(X)
r, c = np.shape(X)
print('\n', 1/r*X.T.dot(X).dot(re).dot(X.T.dot(X)))
============================================================================
[[0.052 0.004 0.002 0.002 0.000 -0.002 0.002 -0.004 -0.001 0.000 0.003]
 [0.004 0.056 0.002 -0.002 -0.003 -0.004 -0.001 -0.001 -0.003 0.004 0.001]
 [0.002 0.002 0.049 -0.003 -0.003 0.003 0.000 -0.002 -0.002 -0.003 0.002]
 [0.002 -0.002 -0.003 0.051 -0.002 -0.002 0.004 -0.000 -0.000 -0.001 0.002]
 [0.000 -0.003 -0.003 -0.002 0.054 0.004 0.000 -0.001 0.000 -0.001 0.003]
 [-0.002 -0.004 0.003 -0.002 0.004 0.055 -0.001 0.000 0.000 -0.002 0.001]
 [0.002 -0.001 0.000 0.004 0.000 -0.001 0.053 -0.003 -0.005 -0.002 0.004]
 [-0.004 -0.001 -0.002 -0.000 -0.001 0.000 -0.003 0.057 -0.001 -0.001 -0.002]
 [-0.001 -0.003 -0.002 -0.000 0.000 0.000 -0.005 -0.001 0.051 0.003 0.000]
 [0.000 0.004 -0.003 -0.001 -0.001 -0.002 -0.002 -0.001 0.003 0.049 0.002]
 [0.003 0.001 0.002 0.002 0.003 0.001 0.004 -0.002 0.000 0.002 0.052]]

 [[1.036 0.029 -0.028 0.031 0.007 -0.067 -0.004 0.003 0.029 -0.022 -0.041]
 [0.029 1.001 0.020 -0.056 -0.066 -0.023 0.000 -0.010 -0.070 0.069 0.023]
 [-0.028 0.020 0.972 -0.057 -0.019 0.058 -0.048 -0.002 0.084 -0.005 0.045]
 [0.031 -0.056 -0.057 1.004 -0.004 0.017 0.017 -0.072 -0.008 -0.042 0.041]
 [0.007 -0.066 -0.019 -0.004 1.024 0.045 -0.035 0.017 0.003 0.006 0.029]
 [-0.067 -0.023 0.058 0.017 0.045 1.125 0.010 -0.014 0.037 0.053 -0.017]
 [-0.004 0.000 -0.048 0.017 -0.035 0.010 1.053 -0.022 -0.047 0.047 0.035]
 [0.003 -0.010 -0.002 -0.072 0.017 -0.014 -0.022 0.955 -0.007 -0.002 -0.019]
 [0.029 -0.070 0.084 -0.008 0.003 0.037 -0.047 -0.007 1.008 -0.025 0.025]
 [-0.022 0.069 -0.005 -0.042 0.006 0.053 0.047 -0.002 -0.025 1.010 0.026]
 [-0.041 0.023 0.045 0.041 0.029 -0.017 0.035 -0.019 0.025 0.026 1.058]]
```



##### def newey_west(y, X, J=*None*):

This function is for Newey-West adjustment. Newey-West estimate of variance:

X(r,c): r is sample number, c is variable number, and S0 is covariance matrix of residue.

The estimate variance is
$$
V_{ols}=T(X^`X)^{-1}S_0(X^`X)^{-1}.
$$
The Newey-West estimate variance of S0 is
$$
S_0= \frac1T X^`(XR)+\frac1T \sum_j\sum_tw_je_te_{t-j}(X_tX^`_{t-j}+X_{t-j}X^`_t).
$$
**input :**

*y :* The dependent variable.

*X :* The explanatory variable.

*J :* The lag.

**output :**

*V_ols :* The Newey-West variance estimate.

**Example**

```python
# continue the previous code
import numpy as np
from statsmodels.stats.sandwich_covariance import cov_hac

X = np.random.normal(loc=0.0, scale=1.0, size=(10000,10))
b = np.random.uniform(low=0.1, high=1.1, size=(10,1))
e = np.random.normal(loc=0.0, scale=1.0, size=(10000,1))
y = X.dot(b) + e + 1.0

re = newey_west(y, X, constant=False)
np.set_printoptions(formatter={'float':'{:0.2f}'.format})
print(re)
# X = add_constant(X)
r, c = np.shape(X) 
print('\n', 1/r*X.T.dot(X).dot(re).dot(X.T.dot(X)))
result = ols(y, X, constant=False)
print('\n', cov_hac(result))
print('\n', 1/r*X.T.dot(X).dot(cov_hac(result)).dot(X.T.dot(X)))
========================================================================
[[0.00 -0.00 -0.00 0.00 0.00 0.00 -0.00 0.00 -0.00 -0.00]
 [-0.00 0.00 -0.00 -0.00 -0.00 0.00 -0.00 -0.00 0.00 -0.00]
 [-0.00 -0.00 0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 0.00]
 [0.00 -0.00 -0.00 0.00 -0.00 -0.00 -0.00 0.00 -0.00 -0.00]
 [0.00 -0.00 -0.00 -0.00 0.00 0.00 -0.00 -0.00 0.00 0.00]
 [0.00 0.00 -0.00 -0.00 0.00 0.00 -0.00 -0.00 -0.00 0.00]
 [-0.00 -0.00 -0.00 -0.00 -0.00 -0.00 0.00 0.00 0.00 0.00]
 [0.00 -0.00 -0.00 0.00 -0.00 -0.00 0.00 0.00 -0.00 -0.00]
 [-0.00 0.00 -0.00 -0.00 0.00 -0.00 0.00 -0.00 0.00 0.00]
 [-0.00 -0.00 0.00 -0.00 0.00 0.00 0.00 -0.00 0.00 0.00]]

 [[2.08 0.00 -0.09 -0.01 -0.03 -0.05 -0.02 0.00 -0.02 0.01]
 [0.00 2.01 0.04 -0.00 0.00 -0.03 -0.00 -0.01 -0.00 0.02]
 [-0.09 0.04 1.99 -0.02 0.01 0.00 -0.01 -0.08 0.03 0.02]
 [-0.01 -0.00 -0.02 1.96 -0.00 -0.05 -0.01 -0.04 -0.01 -0.02]
 [-0.03 0.00 0.01 -0.00 1.98 0.06 0.00 0.04 -0.01 -0.05]
 [-0.05 -0.03 0.00 -0.05 0.06 1.94 -0.01 -0.00 -0.01 -0.02]
 [-0.02 -0.00 -0.01 -0.01 0.00 -0.01 2.04 -0.00 0.01 -0.07]
 [0.00 -0.01 -0.08 -0.04 0.04 -0.00 -0.00 1.89 -0.05 -0.02]
 [-0.02 -0.00 0.03 -0.01 -0.01 -0.01 0.01 -0.05 1.97 -0.01]
 [0.01 0.02 0.02 -0.02 -0.05 -0.02 -0.07 -0.02 -0.01 1.93]]

 [[0.00 -0.00 0.00 0.00 0.00 0.00 -0.00 0.00 0.00 -0.00]
 [-0.00 0.00 0.00 -0.00 0.00 0.00 -0.00 0.00 -0.00 -0.00]
 [0.00 0.00 0.00 -0.00 -0.00 0.00 -0.00 -0.00 -0.00 0.00]
 [0.00 -0.00 -0.00 0.00 0.00 -0.00 -0.00 -0.00 -0.00 -0.00]
 [0.00 0.00 -0.00 0.00 0.00 0.00 0.00 -0.00 0.00 0.00]
 [0.00 0.00 0.00 -0.00 0.00 0.00 -0.00 -0.00 -0.00 -0.00]
 [-0.00 -0.00 -0.00 -0.00 0.00 -0.00 0.00 0.00 -0.00 0.00]
 [0.00 0.00 -0.00 -0.00 -0.00 -0.00 0.00 0.00 -0.00 0.00]
 [0.00 -0.00 -0.00 -0.00 0.00 -0.00 -0.00 -0.00 0.00 0.00]
 [-0.00 -0.00 0.00 -0.00 0.00 -0.00 0.00 0.00 0.00 0.00]]

 [[2.07 -0.05 -0.04 0.02 0.06 -0.11 -0.08 0.03 0.05 0.02]
 [-0.05 1.91 0.10 0.01 0.07 0.00 0.01 0.02 -0.09 0.03]
 [-0.04 0.10 2.05 -0.06 0.01 0.07 -0.06 -0.11 -0.15 0.04]
 [0.02 0.01 -0.06 1.87 0.04 -0.05 -0.02 -0.10 -0.01 -0.06]
 [0.06 0.07 0.01 0.04 2.00 0.11 0.05 0.03 -0.00 -0.04]
 [-0.11 0.00 0.07 -0.05 0.11 1.91 0.00 -0.05 -0.05 -0.05]
 [-0.08 0.01 -0.06 -0.02 0.05 0.00 1.99 0.03 -0.02 -0.10]
 [0.03 0.02 -0.11 -0.10 0.03 -0.05 0.03 2.01 -0.10 0.06]
 [0.05 -0.09 -0.15 -0.01 -0.00 -0.05 -0.02 -0.10 2.16 0.01]
 [0.02 0.03 0.04 -0.06 -0.04 -0.05 -0.10 0.06 0.01 1.97]]
```



##### def white_t(y, X, params=*None*, **kwargs):

This function constructs t-test based on White variance estimate.

**input :**

*y :* The dependent variable.

*X :* The explanatory variable.

*params :* Already have parameters or not. The default is *None*.

**output :**

*t_value :* The t-value of parameters.

*p_value :* The p-value of parameters.

**Example**

```python
import numpy as np

X = np.random.normal(loc=0.0, scale=1.0, size=(10000,10))
b = np.random.uniform(low=-0.5, high=0.5, size=(10,1))
e = np.random.normal(loc=0.0, scale=1.0, size=(10000,1))
y = X.dot(b) + e + 1.0

re = white_t(y, X, constant=False)
np.set_printoptions(formatter={'float':'{:0.2f}'.format})
print('t_value : ', re[0], '\np_value : ', re[1])
print('b :', b.T)
=========================================================================
t_value :  [2.50 34.58 13.23 6.56 -17.64 -34.69 -16.40 13.84 28.90 30.64] 
p_value :  [0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00]
b : [[0.02 0.49 0.18 0.09 -0.25 -0.49 -0.22 0.19 0.44 0.43]]
```



##### def newey_west_t(y, X, params=*None*):

This function constructs t-test based on Newey-West variance estimate.

**input :**

*y :* The dependent variable.

*X :* The explanatory variable.

*params :* Already have parameters or not. The default is None.

**output :**

*t_value :* The t-value of parameters.

*p_value :* The p-value of parameters.

**Example**

```python
import numpy as np

X = np.random.normal(loc=0.0, scale=1.0, size=(10000,10))
b = np.random.uniform(low=-0.5, high=0.5, size=(10,1))
e = np.random.normal(loc=0.0, scale=1.0, size=(10000,1))
y = X.dot(b) + e + 1.0

re = newey_west_t(y, X, constant=True)
np.set_printoptions(formatter={'float':'{:0.2f}'.format})
print('t_value : ', re[0], '\np_value : ', re[1])
print('b :', b.T)
=================================================================================
t_value :  [135.08 -17.19 13.80 34.95 14.61 21.31 48.56 -44.62 2.75 -28.71 51.63] 
p_value :  [0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00]
b : [[-0.14 0.10 0.25 0.11 0.16 0.40 -0.36 0.03 -0.21 0.40]]
```



## Demo

### portfolio_analysis

#### Size Effect

Size effect, discovered by Fama and French(1993), is probably the most famous and common phenomenon in the main capital markets. Size, as a characteristic of company, is able to predict the future stock return that the bigger company tend to have low return in the future. Fama and French take the effect as a proxy for some background risk factor, probably default risk and bankruptcy risk. Like the US stock market, China A share market exists such effect as well (Liu et al., 2016), which would be constructed and tested as follows.

Stocks are sorted by firm size in ascending order and hereafter grouped into 5 or 10 groups. The average return of stocks between the head group and the tail group testing significantly and the corresponding descending order of group return suggest the existence of size effect.

```python
# %% import package
import pandas as pd
import sys, os

sys.path.append(os.path.abspath(".."))
# %% import data
# Monthly return of Stocks in China Security Market
month_return = pd.read_hdf('.\data\month_return.h5', key='month_return')
```

The dataset contains monthly China A share stock between 2000-01-01 to 2021-12-31 from the CSMAR dataset. **WARNING: Do Not use dataset in this demo for any commercial purpose.** Since the data are loaded, some preprocessing procedures should be conducted. 

```python
import datetime as dt

# TimeStamp the tradetime 
month_return['Time'] = pd.to_datetime(month_return['Trdmnt'])
# convert the time string to the timestamp
month_return['numberTime'] = month_return['Time'].apply(dt.datetime.timestamp)
# forward the monthly return for each stock
month_return['emrwd'] = month_return.groupby(['Stkcd'])['Mretwd'].shift(-1) # emrwd is the return including dividend
month_return['emrnd'] = month_return.groupby(['Stkcd'])['Mretnd'].shift(-1) # emrnd is the return including no dividend 
# select the A share stock
month_return = month_return[month_return['Markettype'].isin([1, 4, 16])]
```

There are several characteristics in A share market, which therefore should be analyzed respectively. 

The first specification is the shell effect. Due to specific requirement of the IPO, some dominant company would purchase a small listed company and join the A share market. Thus, in the research by Liu et al. (2016), the stocks whose size is below the 30% are abandoned.

```python
# %% distinguish the stocks whose size is among the up 30% stocks in each month
def percentile(stocks) :
    return stocks >= stocks.quantile(q=.3)

month_return['cap'] = month_return.groupby(['Trdmnt'])['Msmvttl'].apply(percentile)
```

The second specification is the time interval. Before 2017, the size effect is relatively more significant, while since 2017, especially between 2017 and 2019, big companies perform better, and therefore the size effect are neutralized. According to these two specifications, four datasets are formed.

```python
# %% construct test_data for univariate analysis
# dataset 1
from portfolio_analysis import Univariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_1 = month_return[(month_return['cap']==True) & (month_return['Ndaytrd']>=10)]
# construct data for univariate analysis
test_data_1 = test_data_1[['emrwd', 'Msmvttl', 'Time']].dropna()
test_data_1 = test_data_1[(test_data_1['Time'] >= '2000-01-01') & (test_data_1['Time'] <= '2019-12-01')]
# analysis
uni_1 = Univariate(np.array(test_data_1), number=9)
uni_1.average_by_time()
uni_1.summary_and_test()
uni_1.print_summary_by_time()
uni_1.print_summary()
==========================================================================================================================
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
|         Time        |   1    |   2    |   3    |   4    |   5    |   6    |   7    |   8    |   9    |   10   |  diff  |
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
| 2000-01-01 00:00:00 | 0.124  | 0.144  | 0.126  | 0.129  |  0.1   | 0.129  | 0.095  | 0.103  | 0.114  | 0.135  | 0.011  |
| 2000-02-01 00:00:00 | 0.155  | 0.122  | 0.075  |  0.12  | 0.053  | 0.064  | 0.054  |  0.04  | 0.022  | 0.009  | -0.146 |
| 2000-03-01 00:00:00 | 0.007  | 0.022  | 0.012  |  0.01  | 0.004  | 0.002  | 0.016  | 0.015  | 0.017  | 0.033  | 0.026  |
| 2000-04-01 00:00:00 | 0.034  | 0.042  | 0.042  | 0.043  |  0.03  | 0.024  | 0.049  | 0.022  | 0.021  | 0.021  | -0.013 |
| 2000-05-01 00:00:00 | 0.008  | 0.041  | 0.046  | 0.015  | 0.029  | 0.022  | 0.007  |  0.03  | 0.044  | 0.021  | 0.013  |
| 2000-06-01 00:00:00 |  0.06  | 0.067  | 0.045  | 0.038  | 0.051  | 0.042  | 0.029  | 0.036  | 0.032  | 0.045  | -0.016 |
| 2000-07-01 00:00:00 | 0.017  | -0.003 | 0.003  | 0.001  | -0.013 | -0.008 | -0.014 | -0.003 | -0.012 | -0.028 | -0.045 |
| 2000-08-01 00:00:00 | -0.027 | -0.025 | -0.032 | -0.056 | -0.061 | -0.055 | -0.04  | -0.065 | -0.054 | -0.056 | -0.029 |
| 2000-09-01 00:00:00 | 0.038  | 0.049  | 0.034  | 0.034  | 0.038  | 0.022  | 0.031  | 0.015  | 0.013  | 0.002  | -0.036 |
| 2000-10-01 00:00:00 | 0.056  | 0.069  | 0.063  | 0.063  | 0.063  | 0.069  | 0.042  | 0.046  | 0.053  | 0.059  | 0.004  |
| 2000-11-01 00:00:00 | 0.009  | 0.013  | 0.011  | 0.008  | -0.002 | 0.014  |  0.01  |  0.0   | -0.012 | -0.024 | -0.033 |
| 2000-12-01 00:00:00 |  0.0   | -0.008 | -0.018 | -0.007 | -0.01  | -0.014 | 0.001  | -0.007 | -0.008 | -0.019 | -0.019 |
| 2001-01-01 00:00:00 | -0.077 | -0.058 | -0.067 | -0.064 | -0.053 | -0.055 | -0.063 | -0.055 | -0.048 | -0.05  | 0.027  |
| 2001-02-01 00:00:00 | 0.096  | 0.072  | 0.085  | 0.074  | 0.088  | 0.079  | 0.075  | 0.061  | 0.065  | 0.056  | -0.04  |
| 2001-03-01 00:00:00 | 0.015  | 0.009  | -0.01  | -0.001 | -0.007 | -0.011 | 0.001  | -0.012 | -0.009 | -0.017 | -0.032 |
| 2001-04-01 00:00:00 | 0.073  | 0.045  | 0.051  | 0.049  | 0.038  |  0.03  | 0.039  | 0.029  | 0.016  |  0.01  | -0.063 |
| 2001-05-01 00:00:00 | 0.018  |  0.01  | 0.012  | 0.012  | 0.019  | 0.002  | -0.005 | 0.015  | -0.01  | -0.002 | -0.02  |
| 2001-06-01 00:00:00 | -0.138 | -0.138 | -0.129 | -0.134 | -0.141 | -0.149 | -0.123 | -0.131 | -0.13  | -0.13  | 0.009  |
| 2001-07-01 00:00:00 | -0.031 | -0.035 | -0.034 | -0.039 | -0.038 | -0.041 | -0.04  | -0.03  | -0.034 | -0.049 | -0.018 |
| 2001-08-01 00:00:00 | -0.055 | -0.067 | -0.048 | -0.067 | -0.048 | -0.047 | -0.046 | -0.047 | -0.05  | -0.022 | 0.033  |
| 2001-09-01 00:00:00 | -0.062 | -0.054 | -0.052 | -0.057 | -0.056 | -0.066 | -0.053 | -0.046 | -0.053 | -0.028 | 0.034  |
| 2001-10-01 00:00:00 | 0.057  | 0.057  | 0.042  | 0.054  | 0.046  | 0.039  | 0.041  | 0.034  | 0.039  | 0.021  | -0.035 |
| 2001-11-01 00:00:00 | -0.067 | -0.082 | -0.069 | -0.078 | -0.067 | -0.063 | -0.067 | -0.058 | -0.05  | -0.047 | 0.021  |
| 2001-12-01 00:00:00 | -0.141 | -0.14  | -0.119 | -0.121 | -0.117 | -0.116 | -0.108 |  -0.1  | -0.087 | -0.062 | 0.079  |
| 2002-01-01 00:00:00 | 0.035  | 0.044  | 0.043  | 0.036  |  0.03  | 0.032  | 0.028  | 0.025  | 0.016  | 0.011  | -0.024 |
| 2002-02-01 00:00:00 | 0.097  |  0.08  | 0.076  | 0.078  | 0.069  | 0.076  | 0.076  | 0.056  | 0.061  | 0.032  | -0.065 |
| 2002-03-01 00:00:00 | 0.057  | 0.059  | 0.048  | 0.037  | 0.053  | 0.042  | 0.028  | 0.037  | 0.031  | 0.033  | -0.025 |
| 2002-04-01 00:00:00 | -0.095 | -0.089 | -0.095 | -0.093 | -0.092 | -0.095 | -0.09  | -0.089 | -0.092 | -0.075 |  0.02  |
| 2002-05-01 00:00:00 | 0.116  | 0.115  |  0.11  | 0.113  | 0.122  | 0.114  | 0.142  | 0.123  | 0.152  | 0.158  | 0.042  |
| 2002-06-01 00:00:00 | -0.036 | -0.034 | -0.03  | -0.034 | -0.041 | -0.04  | -0.04  | -0.049 | -0.041 | -0.045 | -0.009 |
| 2002-07-01 00:00:00 | 0.011  | 0.004  | 0.005  |  -0.0  | 0.009  | 0.008  | 0.007  | 0.011  | -0.003 | 0.005  | -0.006 |
| 2002-08-01 00:00:00 | -0.058 | -0.056 | -0.065 | -0.059 | -0.057 | -0.059 | -0.054 | -0.046 | -0.05  | -0.047 | 0.011  |
| 2002-09-01 00:00:00 | -0.073 | -0.06  | -0.059 | -0.053 | -0.049 | -0.057 | -0.045 | -0.045 | -0.049 | -0.044 | 0.028  |
| 2002-10-01 00:00:00 | -0.084 | -0.093 | -0.087 | -0.079 | -0.071 | -0.076 | -0.077 | -0.053 | -0.046 | -0.033 | 0.052  |
| 2002-11-01 00:00:00 | -0.059 | -0.055 | -0.056 | -0.058 | -0.051 | -0.062 | -0.05  | -0.05  | -0.05  | -0.045 | 0.013  |
| 2002-12-01 00:00:00 | 0.115  | 0.111  |  0.09  | 0.103  | 0.099  | 0.085  | 0.076  | 0.078  | 0.078  | 0.095  | -0.02  |
| 2003-01-01 00:00:00 | 0.015  | 0.012  | 0.019  |  0.01  |  0.01  | 0.012  | 0.014  | 0.012  | 0.004  | 0.006  | -0.009 |
| 2003-02-01 00:00:00 | -0.03  | -0.037 | -0.032 | -0.031 | -0.023 | -0.026 | -0.022 | -0.009 |  -0.0  | 0.013  | 0.043  |
| 2003-03-01 00:00:00 | -0.07  | -0.041 | -0.05  | -0.048 | -0.037 | -0.02  | -0.023 | 0.002  | 0.002  | 0.033  | 0.104  |
| 2003-04-01 00:00:00 | 0.028  | 0.041  | 0.027  | 0.038  | 0.042  | 0.034  | 0.057  | 0.047  | 0.054  | 0.058  |  0.03  |
| 2003-05-01 00:00:00 | -0.067 | -0.063 | -0.074 | -0.07  | -0.079 | -0.072 | -0.082 | -0.056 | -0.06  | -0.065 | 0.002  |
| 2003-06-01 00:00:00 | -0.036 | -0.044 | -0.037 | -0.031 | -0.043 | -0.023 | -0.022 | -0.015 | 0.006  | 0.016  | 0.052  |
| 2003-07-01 00:00:00 | -0.02  | -0.016 | -0.027 | -0.041 | -0.029 | -0.037 | -0.032 | -0.025 | -0.029 | -0.043 | -0.022 |
| 2003-08-01 00:00:00 | -0.044 | -0.043 | -0.056 | -0.035 | -0.034 | -0.037 | -0.045 | -0.049 | -0.041 | -0.039 | 0.006  |
| 2003-09-01 00:00:00 | -0.081 | -0.077 | -0.073 | -0.066 | -0.062 | -0.064 | -0.042 | -0.032 | -0.023 | 0.011  | 0.092  |
| 2003-10-01 00:00:00 | 0.008  | 0.022  | 0.026  | 0.035  | 0.033  | 0.015  | 0.026  | 0.018  | 0.014  |  0.03  | 0.022  |
| 2003-11-01 00:00:00 | -0.019 | -0.021 | -0.028 | -0.016 |  0.01  | 0.013  | 0.022  | 0.022  | 0.035  | 0.088  | 0.106  |
| 2003-12-01 00:00:00 | 0.091  | 0.103  | 0.097  | 0.099  | 0.084  | 0.081  | 0.067  | 0.067  | 0.075  | 0.047  | -0.044 |
| 2004-01-01 00:00:00 | 0.122  | 0.097  | 0.083  | 0.093  |  0.11  | 0.081  | 0.077  | 0.074  | 0.071  | 0.051  | -0.072 |
| 2004-02-01 00:00:00 | 0.042  | 0.046  | 0.035  | 0.052  | 0.052  | 0.029  | 0.036  | 0.033  | 0.028  | 0.028  | -0.014 |
| 2004-03-01 00:00:00 | -0.103 | -0.086 |  -0.1  |  -0.1  | -0.091 | -0.093 | -0.083 | -0.101 | -0.086 | -0.116 | -0.013 |
| 2004-04-01 00:00:00 | -0.029 | -0.017 | -0.009 | -0.025 | -0.014 | -0.03  | -0.019 | -0.026 | -0.035 | -0.024 | 0.005  |
| 2004-05-01 00:00:00 | -0.128 | -0.131 | -0.135 | -0.134 | -0.132 | -0.126 | -0.114 | -0.124 | -0.111 | -0.085 | 0.043  |
| 2004-06-01 00:00:00 | -0.026 | -0.034 | -0.022 | -0.022 | 0.004  | 0.007  |  0.01  | 0.005  | 0.021  | 0.003  | 0.028  |
| 2004-07-01 00:00:00 | -0.049 | -0.046 | -0.052 | -0.057 | -0.058 | -0.059 | -0.062 | -0.066 | -0.042 | -0.036 | 0.013  |
| 2004-08-01 00:00:00 | 0.061  | 0.043  | 0.053  | 0.045  | 0.053  | 0.064  | 0.057  | 0.062  | 0.056  | 0.062  | 0.001  |
| 2004-09-01 00:00:00 | -0.075 | -0.053 | -0.076 | -0.048 | -0.057 | -0.066 | -0.061 | -0.03  | -0.018 | -0.053 | 0.022  |
| 2004-10-01 00:00:00 | 0.059  |  0.05  |  0.04  | 0.041  | 0.049  | 0.046  | 0.032  | 0.025  | 0.002  | -0.005 | -0.064 |
| 2004-11-01 00:00:00 | -0.078 | -0.08  | -0.086 | -0.079 | -0.09  | -0.093 | -0.077 | -0.066 | -0.076 | -0.048 |  0.03  |
| 2004-12-01 00:00:00 | -0.076 | -0.073 | -0.084 | -0.079 | -0.079 | -0.08  | -0.078 | -0.078 | -0.069 | -0.047 | 0.029  |
| 2005-01-01 00:00:00 | 0.112  |  0.11  | 0.107  | 0.102  | 0.116  | 0.115  | 0.117  | 0.095  | 0.093  | 0.093  | -0.019 |
| 2005-02-01 00:00:00 | -0.147 | -0.137 | -0.138 | -0.133 | -0.117 | -0.121 | -0.112 | -0.121 | -0.088 | -0.086 |  0.06  |
| 2005-03-01 00:00:00 | -0.107 | -0.076 | -0.084 | -0.049 | -0.067 | -0.05  | -0.041 | -0.037 | -0.008 | 0.012  | 0.119  |
| 2005-04-01 00:00:00 | -0.015 | -0.024 | -0.026 | -0.033 | -0.04  | -0.054 | -0.059 | -0.079 | -0.077 |  -0.1  | -0.085 |
| 2005-05-01 00:00:00 | -0.001 | 0.001  | -0.001 | -0.003 | 0.003  | -0.011 | -0.004 | 0.011  | -0.005 | 0.037  | 0.038  |
| 2005-06-01 00:00:00 | -0.083 | -0.07  | -0.079 | -0.07  | -0.058 | -0.063 | -0.053 | -0.036 | -0.012 | 0.015  | 0.097  |
| 2005-07-01 00:00:00 | 0.169  | 0.184  | 0.163  | 0.159  | 0.131  | 0.132  | 0.127  | 0.139  | 0.073  | 0.048  | -0.121 |
| 2005-08-01 00:00:00 |  0.02  | 0.008  | 0.007  | 0.025  | 0.028  | 0.024  | 0.035  | 0.036  | 0.016  | -0.013 | -0.034 |
| 2005-09-01 00:00:00 | -0.071 | -0.05  | -0.067 | -0.043 | -0.062 | -0.055 | -0.056 | -0.042 | -0.057 | -0.053 | 0.019  |
| 2005-10-01 00:00:00 | 0.018  |  0.01  | 0.019  | 0.005  | 0.016  | 0.016  | -0.014 | -0.014 | -0.019 | -0.004 | -0.022 |
| 2005-11-01 00:00:00 | 0.016  |  0.01  | 0.018  | 0.022  | 0.033  | 0.043  | 0.047  | 0.067  | 0.062  | 0.079  | 0.063  |
| 2005-12-01 00:00:00 | 0.098  | 0.067  |  0.09  | 0.088  | 0.094  | 0.119  | 0.141  |  0.12  |  0.13  | 0.088  | -0.01  |
| 2006-01-01 00:00:00 | 0.034  | 0.026  | 0.023  | 0.019  | 0.021  | 0.017  | 0.017  | -0.007 | 0.022  | 0.046  | 0.012  |
| 2006-02-01 00:00:00 | -0.002 | 0.001  | 0.006  | 0.008  | 0.022  | 0.025  | 0.042  | 0.048  | 0.048  | 0.025  | 0.027  |
| 2006-03-01 00:00:00 | 0.093  | 0.106  | 0.101  | 0.089  | 0.122  | 0.118  | 0.133  | 0.145  |  0.16  | 0.127  | 0.034  |
| 2006-04-01 00:00:00 | 0.297  | 0.251  | 0.284  | 0.265  | 0.261  | 0.222  | 0.266  | 0.201  | 0.208  | 0.156  | -0.141 |
| 2006-05-01 00:00:00 | 0.065  | 0.091  | 0.067  | 0.052  | 0.058  |  0.04  | 0.048  | 0.045  | 0.013  |  0.02  | -0.045 |
| 2006-06-01 00:00:00 | -0.002 | -0.038 | -0.039 | -0.022 | -0.043 | -0.043 | -0.051 | -0.059 | -0.056 | -0.088 | -0.086 |
| 2006-07-01 00:00:00 | 0.029  | 0.016  | 0.042  | 0.028  | 0.042  | 0.029  | 0.057  | 0.031  |  0.04  | 0.024  | -0.005 |
| 2006-08-01 00:00:00 | 0.049  | 0.056  | 0.049  | 0.039  | 0.038  | 0.052  | 0.026  | 0.042  | 0.041  | 0.044  | -0.005 |
| 2006-09-01 00:00:00 | -0.011 |  0.01  | 0.016  | -0.013 | -0.029 | 0.004  | -0.01  | 0.029  | 0.014  | 0.034  | 0.045  |
| 2006-10-01 00:00:00 | 0.014  | 0.024  | 0.034  | 0.038  | 0.058  | 0.055  | 0.063  | 0.079  | 0.139  | 0.183  | 0.169  |
| 2006-11-01 00:00:00 | 0.055  | 0.032  | 0.036  | 0.043  | 0.072  | 0.061  | 0.088  | 0.097  | 0.099  |  0.17  | 0.115  |
| 2006-12-01 00:00:00 | 0.296  | 0.254  | 0.262  | 0.251  | 0.233  | 0.239  | 0.232  | 0.209  | 0.254  | 0.173  | -0.122 |
| 2007-01-01 00:00:00 | 0.254  | 0.179  | 0.218  | 0.187  |  0.26  | 0.177  | 0.139  | 0.162  | 0.128  | 0.066  | -0.188 |
| 2007-02-01 00:00:00 | 0.196  | 0.203  | 0.179  | 0.163  | 0.171  | 0.175  | 0.142  | 0.103  | 0.072  |  0.09  | -0.107 |
| 2007-03-01 00:00:00 | 0.389  |  0.32  | 0.358  | 0.298  | 0.342  | 0.341  | 0.329  | 0.362  | 0.337  | 0.262  | -0.127 |
| 2007-04-01 00:00:00 | 0.067  | 0.093  | 0.064  | 0.065  | 0.178  | 0.113  | 0.081  | 0.092  | 0.143  | 0.118  | 0.051  |
| 2007-05-01 00:00:00 | -0.205 | -0.205 | -0.177 | -0.162 | -0.144 | -0.171 | -0.121 | -0.109 | -0.064 | -0.028 | 0.176  |
| 2007-06-01 00:00:00 | 0.235  |  0.26  | 0.231  | 0.228  | 0.216  |  0.2   | 0.192  | 0.196  | 0.182  | 0.186  | -0.049 |
| 2007-07-01 00:00:00 | 0.093  | 0.095  | 0.108  | 0.086  | 0.133  | 0.093  | 0.108  | 0.131  | 0.161  | 0.183  |  0.09  |
| 2007-08-01 00:00:00 | 0.025  | 0.015  | 0.043  | 0.059  |  0.03  | 0.046  | 0.018  | 0.038  | 0.082  | 0.073  | 0.048  |
| 2007-09-01 00:00:00 | -0.113 | -0.135 | -0.115 | -0.099 | -0.099 | -0.115 | -0.093 | -0.091 | -0.072 | 0.016  | 0.129  |
| 2007-10-01 00:00:00 | -0.038 | -0.058 | -0.05  | -0.084 | -0.048 | -0.112 | -0.091 | -0.13  | -0.163 | -0.184 | -0.147 |
| 2007-11-01 00:00:00 | 0.207  | 0.201  | 0.219  | 0.213  | 0.218  | 0.209  |  0.23  | 0.192  | 0.192  | 0.135  | -0.073 |
| 2007-12-01 00:00:00 | -0.061 | -0.058 | -0.075 | -0.052 | -0.058 | -0.06  | -0.065 | -0.078 | -0.079 | -0.141 | -0.081 |
| 2008-01-01 00:00:00 |  0.11  | 0.096  |  0.1   | 0.089  | 0.083  | 0.068  | 0.063  |  0.05  |  0.03  | 0.012  | -0.097 |
| 2008-02-01 00:00:00 | -0.188 | -0.189 | -0.196 | -0.202 | -0.204 | -0.199 | -0.214 | -0.211 | -0.233 | -0.212 | -0.023 |
| 2008-03-01 00:00:00 | -0.061 | -0.091 | -0.055 | -0.055 | -0.048 | -0.038 | -0.013 | 0.003  |  0.03  | 0.057  | 0.118  |
| 2008-04-01 00:00:00 | 0.002  | -0.017 | -0.03  | -0.039 | -0.035 | -0.039 | -0.053 | -0.045 | -0.054 | -0.089 | -0.091 |
| 2008-05-01 00:00:00 | -0.275 | -0.261 | -0.249 | -0.262 | -0.252 | -0.239 | -0.247 | -0.242 | -0.227 | -0.215 |  0.06  |
| 2008-06-01 00:00:00 | 0.114  | 0.102  | 0.107  | 0.105  | 0.081  | 0.074  |  0.08  |  0.05  | 0.044  | -0.005 | -0.119 |
| 2008-07-01 00:00:00 | -0.244 | -0.214 | -0.223 | -0.248 | -0.229 | -0.235 | -0.253 | -0.226 | -0.239 | -0.169 | 0.075  |
| 2008-08-01 00:00:00 | -0.101 | -0.085 | -0.112 | -0.075 | -0.082 | -0.084 | -0.064 | -0.046 | -0.041 | -0.016 | 0.085  |
| 2008-09-01 00:00:00 | -0.261 | -0.263 | -0.251 | -0.261 | -0.271 | -0.265 | -0.26  | -0.273 | -0.261 | -0.257 | 0.003  |
| 2008-10-01 00:00:00 | 0.233  | 0.211  | 0.233  | 0.211  | 0.202  | 0.175  | 0.162  | 0.166  |  0.15  |  0.12  | -0.112 |
| 2008-11-01 00:00:00 | 0.116  | 0.053  | 0.073  | 0.073  | 0.043  | 0.054  | 0.064  | 0.052  | 0.041  | -0.002 | -0.118 |
| 2008-12-01 00:00:00 | 0.157  | 0.155  | 0.167  | 0.186  |  0.17  | 0.175  | 0.167  | 0.161  | 0.147  | 0.104  | -0.053 |
| 2009-01-01 00:00:00 | 0.091  | 0.081  | 0.091  | 0.093  | 0.073  | 0.084  | 0.077  | 0.064  |  0.06  |  0.06  | -0.031 |
| 2009-02-01 00:00:00 | 0.244  | 0.249  | 0.213  | 0.229  | 0.205  | 0.217  | 0.209  | 0.187  | 0.213  | 0.178  | -0.066 |
| 2009-03-01 00:00:00 |  0.07  | 0.076  | 0.085  | 0.074  | 0.049  | 0.039  | 0.078  | 0.025  | 0.065  | 0.046  | -0.025 |
| 2009-04-01 00:00:00 | 0.078  | 0.071  | 0.085  | 0.075  | 0.045  | 0.054  | 0.051  | 0.038  | 0.062  | 0.046  | -0.031 |
| 2009-05-01 00:00:00 | 0.038  | 0.035  | 0.049  | 0.052  | 0.037  | 0.052  | 0.049  | 0.081  | 0.072  | 0.145  | 0.107  |
| 2009-06-01 00:00:00 | 0.138  | 0.163  |  0.12  | 0.155  | 0.136  |  0.13  | 0.166  | 0.167  | 0.179  | 0.195  | 0.057  |
| 2009-07-01 00:00:00 | -0.155 | -0.136 | -0.135 | -0.147 | -0.146 | -0.168 | -0.171 | -0.177 | -0.194 | -0.245 | -0.09  |
| 2009-08-01 00:00:00 | 0.022  | 0.022  | 0.049  |  0.02  | 0.032  | 0.035  | 0.036  | 0.046  | 0.045  | 0.049  | 0.028  |
| 2009-09-01 00:00:00 | 0.125  | 0.117  | 0.133  | 0.126  | 0.133  | 0.115  | 0.108  |  0.11  | 0.107  | 0.085  | -0.039 |
| 2009-10-01 00:00:00 |  0.16  | 0.155  | 0.174  | 0.175  | 0.151  | 0.147  | 0.142  | 0.112  | 0.103  | 0.078  | -0.082 |
| 2009-11-01 00:00:00 | 0.038  | 0.027  |  0.03  | 0.029  | 0.024  | 0.001  | 0.005  | -0.001 | -0.006 | 0.008  | -0.03  |
| 2009-12-01 00:00:00 | -0.02  | -0.026 | -0.024 | -0.042 | -0.012 | -0.019 | -0.038 | -0.04  | -0.075 | -0.103 | -0.084 |
| 2010-01-01 00:00:00 | 0.068  | 0.062  | 0.059  | 0.073  | 0.055  | 0.057  | 0.058  | 0.047  | 0.039  | 0.021  | -0.048 |
| 2010-02-01 00:00:00 | 0.055  | 0.037  | 0.043  | 0.043  | 0.053  | 0.043  | 0.009  |  0.01  | 0.016  | 0.015  | -0.04  |
| 2010-03-01 00:00:00 | -0.085 | -0.067 | -0.082 | -0.071 | -0.059 | -0.083 | -0.078 | -0.053 | -0.067 | -0.081 | 0.004  |
| 2010-04-01 00:00:00 | -0.088 | -0.092 | -0.095 | -0.075 | -0.067 | -0.079 | -0.072 | -0.071 | -0.081 | -0.094 | -0.006 |
| 2010-05-01 00:00:00 | -0.081 | -0.097 | -0.083 | -0.099 | -0.092 | -0.103 | -0.099 | -0.098 | -0.097 | -0.077 | 0.005  |
| 2010-06-01 00:00:00 | 0.147  | 0.149  | 0.151  |  0.17  | 0.148  | 0.142  | 0.132  | 0.133  | 0.135  | 0.131  | -0.016 |
| 2010-07-01 00:00:00 | 0.108  | 0.112  | 0.098  | 0.094  | 0.081  | 0.085  | 0.122  | 0.079  | 0.059  | 0.019  | -0.089 |
| 2010-08-01 00:00:00 | -0.004 | 0.009  | 0.012  | -0.004 | -0.016 | 0.008  | 0.013  | 0.015  | 0.019  | 0.017  | 0.021  |
| 2010-09-01 00:00:00 | 0.108  | 0.074  | 0.085  | 0.097  |  0.08  | 0.103  | 0.105  | 0.092  | 0.148  | 0.155  | 0.047  |
| 2010-10-01 00:00:00 | 0.036  | 0.021  | 0.002  | 0.015  |  0.01  | 0.019  |  0.02  | -0.001 | -0.035 | -0.066 | -0.102 |
| 2010-11-01 00:00:00 | -0.024 | -0.025 | -0.031 | -0.036 | -0.026 | -0.035 | -0.034 | -0.02  | -0.006 | 0.006  |  0.03  |
| 2010-12-01 00:00:00 | -0.058 | -0.061 | -0.059 | -0.05  | -0.074 | -0.064 | -0.068 | -0.067 | -0.051 | -0.018 |  0.04  |
| 2011-01-01 00:00:00 | 0.098  | 0.093  |  0.11  | 0.096  | 0.105  | 0.103  | 0.101  | 0.097  | 0.069  | 0.052  | -0.046 |
| 2011-02-01 00:00:00 | 0.004  | -0.018 | -0.023 | -0.017 | -0.026 | -0.038 | -0.023 | -0.027 | -0.033 | -0.02  | -0.024 |
| 2011-03-01 00:00:00 | -0.054 | -0.036 | -0.052 | -0.05  | -0.027 | -0.035 | -0.039 | -0.039 | -0.02  | -0.022 | 0.032  |
| 2011-04-01 00:00:00 | -0.081 | -0.067 | -0.055 | -0.083 | -0.082 | -0.076 | -0.084 | -0.085 | -0.077 | -0.066 | 0.016  |
| 2011-05-01 00:00:00 | 0.034  | 0.031  | 0.042  | 0.023  | 0.041  | 0.032  | 0.031  | 0.036  |  0.03  |  0.03  | -0.004 |
| 2011-06-01 00:00:00 | 0.033  | 0.026  | 0.038  | 0.021  | 0.017  | 0.022  | 0.024  | 0.016  |  -0.0  | -0.017 | -0.05  |
| 2011-07-01 00:00:00 | -0.017 | -0.032 | -0.026 | -0.032 | -0.036 | -0.034 | -0.034 | -0.047 | -0.041 | -0.054 | -0.036 |
| 2011-08-01 00:00:00 | -0.123 | -0.115 | -0.124 | -0.131 | -0.136 | -0.128 | -0.141 | -0.125 | -0.111 | -0.093 | 0.029  |
| 2011-09-01 00:00:00 | 0.041  | 0.045  | 0.046  | 0.041  | 0.047  | 0.026  | 0.052  | 0.045  | 0.036  | 0.034  | -0.006 |
| 2011-10-01 00:00:00 | -0.045 | -0.038 | -0.029 | -0.04  | -0.041 | -0.042 | -0.045 | -0.049 | -0.056 | -0.069 | -0.024 |
| 2011-11-01 00:00:00 | -0.17  | -0.17  | -0.174 | -0.151 | -0.164 | -0.159 | -0.137 | -0.13  | -0.102 | -0.082 | 0.087  |
| 2011-12-01 00:00:00 | -0.016 | -0.018 | -0.006 | -0.018 | -0.018 | 0.003  | -0.013 |  -0.0  | -0.002 | 0.045  | 0.062  |
| 2012-01-01 00:00:00 | 0.143  | 0.138  | 0.135  | 0.136  | 0.129  | 0.128  | 0.131  | 0.119  | 0.109  | 0.072  | -0.071 |
| 2012-02-01 00:00:00 | -0.081 | -0.061 | -0.075 | -0.08  | -0.077 | -0.078 | -0.073 | -0.079 | -0.071 | -0.074 | 0.007  |
| 2012-03-01 00:00:00 | 0.088  | 0.069  | 0.064  | 0.073  |  0.07  | 0.064  | 0.063  | 0.053  | 0.063  | 0.072  | -0.016 |
| 2012-04-01 00:00:00 | 0.022  | 0.024  | 0.025  | 0.017  | 0.017  | 0.033  | 0.024  | 0.028  | 0.038  | 0.008  | -0.014 |
| 2012-05-01 00:00:00 | -0.06  | -0.06  | -0.061 | -0.073 | -0.067 | -0.066 | -0.071 | -0.071 | -0.058 | -0.057 | 0.003  |
| 2012-06-01 00:00:00 | -0.11  | -0.094 | -0.092 | -0.103 | -0.099 | -0.089 | -0.087 | -0.082 | -0.075 | -0.054 | 0.057  |
| 2012-07-01 00:00:00 | 0.042  | 0.045  | 0.033  | 0.026  | 0.033  |  0.0   |  0.01  | -0.022 | -0.034 | -0.056 | -0.098 |
| 2012-08-01 00:00:00 | 0.003  | 0.004  | 0.002  | -0.005 | 0.004  | 0.002  | 0.022  | 0.007  | 0.029  | 0.044  |  0.04  |
| 2012-09-01 00:00:00 | -0.004 | 0.002  | 0.008  |  -0.0  | -0.015 |  0.0   | -0.012 | -0.02  | -0.017 | -0.016 | -0.012 |
| 2012-10-01 00:00:00 | -0.119 | -0.121 | -0.125 | -0.113 | -0.124 | -0.113 | -0.123 | -0.103 | -0.097 | -0.059 |  0.06  |
| 2012-11-01 00:00:00 | 0.164  | 0.178  | 0.184  | 0.163  | 0.163  | 0.182  | 0.181  | 0.166  | 0.171  | 0.172  | 0.008  |
| 2012-12-01 00:00:00 |  0.07  | 0.072  | 0.066  | 0.069  | 0.065  | 0.054  | 0.065  | 0.061  | 0.049  | 0.057  | -0.013 |
| 2013-01-01 00:00:00 | 0.044  | 0.033  | 0.036  | 0.037  | 0.038  | 0.043  | 0.042  | 0.039  | 0.024  | -0.004 | -0.047 |
| 2013-02-01 00:00:00 | -0.032 | -0.024 | -0.031 | -0.027 | -0.047 | -0.041 | -0.047 | -0.057 | -0.04  | -0.05  | -0.018 |
| 2013-03-01 00:00:00 | -0.032 | -0.032 | -0.025 | -0.026 | -0.031 | -0.027 | -0.019 | -0.017 | -0.026 | -0.021 | 0.011  |
| 2013-04-01 00:00:00 | 0.158  | 0.154  | 0.147  | 0.142  | 0.152  | 0.156  |  0.15  | 0.125  | 0.125  | 0.067  | -0.091 |
| 2013-05-01 00:00:00 | -0.16  | -0.157 | -0.157 | -0.157 | -0.154 | -0.154 | -0.164 | -0.151 | -0.154 | -0.136 | 0.024  |
| 2013-06-01 00:00:00 | 0.073  | 0.084  | 0.079  | 0.069  | 0.054  |  0.07  | 0.073  | 0.045  | 0.062  | 0.014  | -0.058 |
| 2013-07-01 00:00:00 | 0.102  | 0.093  | 0.076  | 0.064  | 0.102  | 0.072  | 0.082  | 0.063  | 0.069  | 0.058  | -0.045 |
| 2013-08-01 00:00:00 | 0.053  | 0.064  | 0.046  | 0.045  | 0.048  | 0.061  | 0.043  | 0.051  |  0.07  | 0.047  | -0.006 |
| 2013-09-01 00:00:00 | -0.025 | -0.023 | -0.016 | -0.035 | -0.039 | -0.033 | -0.034 | -0.029 | -0.034 | -0.04  | -0.014 |
| 2013-10-01 00:00:00 | 0.092  | 0.095  | 0.083  | 0.083  | 0.084  | 0.083  | 0.055  | 0.063  | 0.052  | 0.039  | -0.054 |
| 2013-11-01 00:00:00 | -0.034 | -0.029 | -0.038 | -0.032 | -0.045 | -0.027 | -0.028 | -0.047 | -0.033 | -0.046 | -0.012 |
| 2013-12-01 00:00:00 | 0.001  | 0.017  | 0.038  | 0.057  | 0.027  | 0.002  | 0.036  | 0.002  | 0.012  | -0.052 | -0.053 |
| 2014-01-01 00:00:00 | 0.047  | 0.042  | 0.044  | 0.044  | 0.045  | 0.015  | 0.023  | 0.016  | -0.003 | -0.021 | -0.068 |
| 2014-02-01 00:00:00 | -0.023 | -0.02  | -0.04  | -0.038 | -0.039 | -0.039 | -0.043 | -0.051 | -0.041 | -0.028 | -0.005 |
| 2014-03-01 00:00:00 | -0.009 | -0.027 | -0.031 | -0.028 | -0.026 | -0.012 | -0.018 | -0.026 | -0.009 | -0.005 | 0.005  |
| 2014-04-01 00:00:00 | 0.027  | 0.035  | 0.034  | 0.028  |  0.05  | 0.025  |  0.02  | 0.022  | 0.018  | 0.002  | -0.024 |
| 2014-05-01 00:00:00 | 0.064  | 0.059  | 0.046  | 0.054  | 0.055  | 0.031  | 0.037  | 0.038  | 0.026  | 0.019  | -0.045 |
| 2014-06-01 00:00:00 |  0.09  | 0.076  | 0.076  | 0.068  |  0.06  | 0.082  | 0.075  | 0.067  | 0.065  | 0.079  | -0.012 |
| 2014-07-01 00:00:00 | 0.065  |  0.06  |  0.06  | 0.054  | 0.044  | 0.057  | 0.038  | 0.053  | 0.041  | 0.004  | -0.061 |
| 2014-08-01 00:00:00 | 0.152  | 0.141  | 0.143  | 0.124  | 0.119  | 0.114  | 0.127  | 0.101  |  0.09  | 0.064  | -0.089 |
| 2014-09-01 00:00:00 | 0.044  | 0.018  | 0.014  | 0.017  | 0.014  | 0.013  | 0.014  | 0.004  | 0.015  | 0.029  | -0.015 |
| 2014-10-01 00:00:00 | 0.067  | 0.049  | 0.062  |  0.07  | 0.045  |  0.04  | 0.048  | 0.055  | 0.076  | 0.123  | 0.056  |
| 2014-11-01 00:00:00 | -0.08  | -0.069 | -0.055 | -0.049 | -0.046 | -0.022 | 0.002  | -0.004 | 0.074  | 0.246  | 0.327  |
| 2014-12-01 00:00:00 | 0.108  | 0.105  | 0.094  | 0.097  | 0.087  | 0.068  | 0.077  | 0.082  | 0.062  | -0.026 | -0.135 |
| 2015-01-01 00:00:00 | 0.078  | 0.077  |  0.09  | 0.087  | 0.094  | 0.099  | 0.088  | 0.104  | 0.073  | 0.052  | -0.026 |
| 2015-02-01 00:00:00 | 0.259  | 0.235  | 0.248  | 0.252  | 0.229  | 0.214  | 0.228  | 0.209  | 0.184  | 0.142  | -0.116 |
| 2015-03-01 00:00:00 | 0.213  | 0.168  |  0.14  | 0.166  | 0.162  | 0.168  | 0.155  | 0.153  | 0.154  | 0.203  | -0.01  |
| 2015-04-01 00:00:00 | 0.302  | 0.264  | 0.261  | 0.253  | 0.252  | 0.252  | 0.204  | 0.182  | 0.119  | 0.036  | -0.266 |
| 2015-05-01 00:00:00 | -0.114 | -0.147 | -0.155 | -0.158 | -0.149 | -0.145 | -0.119 | -0.144 | -0.133 | -0.079 | 0.035  |
| 2015-06-01 00:00:00 | -0.212 | -0.204 | -0.201 | -0.192 | -0.177 | -0.176 | -0.15  | -0.17  | -0.154 | -0.159 | 0.052  |
| 2015-07-01 00:00:00 | -0.151 | -0.156 | -0.145 | -0.149 | -0.161 | -0.136 | -0.177 | -0.177 | -0.15  | -0.133 | 0.018  |
| 2015-08-01 00:00:00 | 0.012  |  0.0   | -0.017 | -0.004 | -0.016 | -0.022 | -0.028 | -0.045 | -0.062 | -0.053 | -0.065 |
| 2015-09-01 00:00:00 | 0.257  | 0.252  |  0.26  | 0.243  | 0.206  | 0.236  | 0.222  |  0.21  | 0.186  | 0.123  | -0.134 |
| 2015-10-01 00:00:00 | 0.152  | 0.146  | 0.116  | 0.116  | 0.096  | 0.063  | 0.069  | 0.049  | 0.024  | 0.009  | -0.143 |
| 2015-11-01 00:00:00 |  0.07  | 0.065  | 0.038  |  0.03  | 0.049  | 0.026  | 0.034  | 0.018  | 0.024  | 0.032  | -0.038 |
| 2015-12-01 00:00:00 | -0.309 | -0.309 | -0.31  | -0.31  | -0.311 | -0.295 | -0.301 | -0.308 | -0.278 | -0.243 | 0.066  |
| 2016-01-01 00:00:00 | -0.012 | -0.031 | -0.023 | -0.032 | -0.028 | -0.021 | -0.021 | -0.025 | -0.013 | -0.025 | -0.013 |
| 2016-02-01 00:00:00 | 0.204  |  0.21  | 0.204  | 0.209  | 0.196  |  0.19  | 0.172  | 0.171  | 0.162  | 0.132  | -0.072 |
| 2016-03-01 00:00:00 | 0.002  | -0.007 | -0.012 | -0.034 | -0.013 | -0.019 | -0.035 | -0.032 | -0.032 | -0.036 | -0.038 |
| 2016-04-01 00:00:00 | -0.017 | -0.009 | -0.006 | -0.012 |  0.0   | 0.007  | 0.002  | -0.01  | -0.005 | 0.001  | 0.018  |
| 2016-05-01 00:00:00 | 0.077  | 0.092  | 0.074  | 0.082  | 0.051  | 0.058  | 0.051  | 0.033  |  0.02  |  0.01  | -0.067 |
| 2016-06-01 00:00:00 | -0.012 | -0.011 | -0.029 | -0.014 | -0.022 | -0.033 | -0.007 | -0.017 | 0.031  | 0.028  | 0.041  |
| 2016-07-01 00:00:00 | 0.064  | 0.052  | 0.043  | 0.035  | 0.034  | 0.045  | 0.037  | 0.035  | 0.033  | 0.031  | -0.033 |
| 2016-08-01 00:00:00 | -0.025 | -0.015 | -0.015 | -0.021 | -0.028 | -0.028 | -0.026 | -0.029 | -0.03  | -0.034 | -0.009 |
| 2016-09-01 00:00:00 |  0.04  | 0.038  |  0.05  | 0.046  | 0.037  | 0.023  | 0.026  | 0.026  | 0.018  | 0.024  | -0.016 |
| 2016-10-01 00:00:00 |  0.03  | 0.016  | 0.029  | 0.025  | 0.014  | 0.015  | 0.016  | 0.014  | 0.036  | 0.045  | 0.015  |
| 2016-11-01 00:00:00 | -0.057 | -0.059 | -0.065 | -0.076 | -0.059 | -0.07  | -0.067 | -0.061 | -0.062 | -0.063 | -0.006 |
| 2016-12-01 00:00:00 | -0.037 | -0.036 | -0.041 | -0.035 | -0.032 | -0.03  | -0.03  | -0.018 | -0.008 | 0.012  | 0.049  |
| 2017-01-01 00:00:00 | 0.045  | 0.048  | 0.045  | 0.041  | 0.039  |  0.04  | 0.038  | 0.051  | 0.036  | 0.036  | -0.009 |
| 2017-02-01 00:00:00 | -0.017 | -0.025 | -0.022 | -0.015 | -0.017 | -0.022 | -0.01  | -0.016 | 0.002  | 0.002  |  0.02  |
| 2017-03-01 00:00:00 | -0.076 | -0.085 | -0.058 | -0.069 | -0.068 | -0.062 | -0.033 | -0.025 | -0.029 | -0.005 | 0.071  |
| 2017-04-01 00:00:00 | -0.085 | -0.089 | -0.084 | -0.075 | -0.083 | -0.069 | -0.073 | -0.061 | -0.059 | -0.009 | 0.075  |
| 2017-05-01 00:00:00 | 0.029  | 0.026  | 0.032  | 0.043  | 0.035  |  0.04  | 0.042  | 0.051  | 0.062  |  0.05  |  0.02  |
| 2017-06-01 00:00:00 | -0.013 | -0.014 | 0.005  | -0.008 | -0.004 | 0.016  | 0.004  | 0.023  | 0.019  | 0.021  | 0.034  |
| 2017-07-01 00:00:00 | 0.047  | 0.033  | 0.041  | 0.037  | 0.026  | 0.032  | 0.036  | 0.017  | 0.039  | 0.022  | -0.025 |
| 2017-08-01 00:00:00 | 0.008  | 0.021  | 0.007  | 0.016  | 0.017  | 0.017  | 0.012  | 0.017  | 0.002  | 0.005  | -0.003 |
| 2017-09-01 00:00:00 | -0.031 | -0.029 | -0.02  | -0.021 | -0.032 | -0.03  | -0.021 | -0.011 | -0.002 | 0.029  |  0.06  |
| 2017-10-01 00:00:00 | -0.087 | -0.079 | -0.085 | -0.068 | -0.066 | -0.057 | -0.053 | -0.044 | -0.047 | -0.022 | 0.065  |
| 2017-11-01 00:00:00 | -0.026 | -0.027 | -0.028 | -0.023 | -0.014 | -0.018 | -0.01  | -0.01  | -0.007 | 0.003  | 0.029  |
| 2017-12-01 00:00:00 | -0.05  | -0.041 | -0.039 | -0.039 | -0.031 | -0.022 | -0.021 | -0.023 | 0.009  | 0.036  | 0.086  |
| 2018-01-01 00:00:00 | -0.07  | -0.052 | -0.055 | -0.052 | -0.037 | -0.036 | -0.031 | -0.034 | -0.03  | -0.048 | 0.022  |
| 2018-02-01 00:00:00 | 0.068  | 0.056  | 0.056  | 0.054  | 0.038  | 0.032  | 0.035  | 0.017  | 0.005  | -0.022 | -0.09  |
| 2018-03-01 00:00:00 | -0.033 | -0.054 | -0.045 | -0.039 | -0.042 | -0.042 | -0.034 | -0.043 | -0.036 | -0.034 | -0.001 |
| 2018-04-01 00:00:00 | -0.019 | -0.026 | -0.024 | -0.006 | -0.013 | -0.018 | -0.016 | -0.01  | 0.003  | 0.014  | 0.032  |
| 2018-05-01 00:00:00 | -0.12  | -0.12  | -0.112 | -0.116 | -0.109 | -0.119 | -0.097 | -0.104 | -0.09  | -0.08  |  0.04  |
| 2018-06-01 00:00:00 | -0.004 | -0.012 | -0.017 | 0.002  | -0.007 | -0.022 | -0.001 | -0.003 | -0.003 | -0.002 | 0.001  |
| 2018-07-01 00:00:00 | -0.087 | -0.081 | -0.077 | -0.084 | -0.086 | -0.086 | -0.08  | -0.083 | -0.079 | -0.059 | 0.028  |
| 2018-08-01 00:00:00 | -0.01  | -0.011 | -0.017 | -0.014 | -0.008 |  0.0   | -0.02  | -0.005 | 0.003  | 0.019  | 0.029  |
| 2018-09-01 00:00:00 | -0.089 | -0.099 | -0.098 | -0.115 | -0.114 | -0.112 | -0.111 | -0.093 | -0.092 | -0.095 | -0.006 |
| 2018-10-01 00:00:00 | 0.062  | 0.065  | 0.073  | 0.062  | 0.043  | 0.066  | 0.038  | 0.035  | 0.025  | 0.008  | -0.054 |
| 2018-11-01 00:00:00 | -0.042 | -0.045 | -0.052 | -0.055 | -0.046 | -0.05  | -0.045 | -0.041 | -0.041 | -0.042 | -0.001 |
| 2018-12-01 00:00:00 | -0.038 | -0.032 | -0.03  | -0.017 | -0.024 | -0.013 | -0.023 | 0.003  | 0.015  | 0.029  | 0.068  |
| 2019-01-01 00:00:00 | 0.245  | 0.234  | 0.228  | 0.224  | 0.232  | 0.227  |  0.2   | 0.212  | 0.214  | 0.171  | -0.074 |
| 2019-02-01 00:00:00 | 0.111  | 0.097  | 0.114  | 0.102  | 0.115  | 0.099  | 0.106  | 0.102  | 0.096  | 0.063  | -0.048 |
| 2019-03-01 00:00:00 | -0.053 | -0.043 | -0.046 | -0.035 | -0.038 | -0.036 | -0.055 | -0.042 | -0.048 | -0.014 | 0.039  |
| 2019-04-01 00:00:00 | -0.051 | -0.052 | -0.052 | -0.047 | -0.053 | -0.064 | -0.065 | -0.07  | -0.07  | -0.065 | -0.015 |
| 2019-05-01 00:00:00 | -0.001 | -0.016 | 0.004  | -0.004 | -0.02  | -0.001 | -0.001 | 0.011  | 0.021  | 0.041  | 0.042  |
| 2019-06-01 00:00:00 | -0.026 | -0.029 | -0.021 | -0.03  | -0.028 | -0.015 | -0.018 | -0.013 |  -0.0  | 0.009  | 0.035  |
| 2019-07-01 00:00:00 | -0.01  | -0.01  | -0.008 | -0.004 | -0.012 | -0.01  |  -0.0  | -0.008 | -0.001 | -0.004 | 0.005  |
| 2019-08-01 00:00:00 | 0.022  | 0.013  | 0.012  | 0.009  | 0.007  | 0.014  | 0.018  | 0.003  |  0.02  | 0.004  | -0.018 |
| 2019-09-01 00:00:00 | -0.008 | -0.01  | -0.013 |  -0.0  | -0.015 | -0.001 | -0.008 | -0.006 | 0.001  | 0.011  | 0.019  |
| 2019-10-01 00:00:00 | -0.019 | -0.033 | -0.032 | -0.023 | -0.032 | -0.024 | -0.024 | -0.011 | -0.004 | -0.009 |  0.01  |
| 2019-11-01 00:00:00 | 0.082  | 0.081  | 0.073  | 0.091  | 0.078  | 0.078  | 0.084  | 0.077  | 0.084  | 0.079  | -0.003 |
| 2019-12-01 00:00:00 | 0.009  | -0.011 | 0.007  | 0.019  | 0.005  | 0.029  | 0.015  | 0.022  | 0.002  | 0.002  | -0.007 |
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
+---------+-------+-------+-------+-------+------+-------+-------+-------+-------+-------+--------+
|  Group  |   1   |   2   |   3   |   4   |  5   |   6   |   7   |   8   |   9   |   10  |  Diff  |
+---------+-------+-------+-------+-------+------+-------+-------+-------+-------+-------+--------+
| Average | 0.014 | 0.012 | 0.011 |  0.01 | 0.01 | 0.008 | 0.009 | 0.008 | 0.009 | 0.008 | -0.006 |
|  T-Test | 2.105 | 1.805 |  1.77 | 1.668 | 1.63 |  1.39 | 1.587 | 1.316 | 1.682 | 1.512 | -1.48  |
+---------+-------+-------+-------+-------+------+-------+-------+-------+-------+-------+--------+
```

The first dataset contains no below 30% stocks from 2000-01-01 to 2019-12-01. The size effect is **insignificant** since the t-test statistics is -1.48 whose absolute value is no more than 2 corresponding to the significance level at 0.05.

```python
# %% dataset 2
# select stocks whose trading days are more than or equal to 10 days
test_data_2 = month_return[month_return['Ndaytrd']>=10]
# construct data for univariate analysis
test_data_2 = test_data_2[['emrwd', 'Msmvttl', 'Time']].dropna()
# time interval between 2000-01-01 to 2019-12-01
test_data_2 = test_data_2[(test_data_2['Time'] >= '2000-01-01') & (test_data_2['Time'] <= '2019-12-01')]
# using Univariate class to conduct analysis
uni_2 = Univariate(np.array(test_data_2), number=9)
uni_2.average_by_time()
uni_2.summary_and_test()
uni_2.print_summary_by_time()
uni_2.print_summary()
==========================================================================================================================
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
|         Time        |   1    |   2    |   3    |   4    |   5    |   6    |   7    |   8    |   9    |   10   |  diff  |
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
| 2000-01-01 00:00:00 | 0.164  | 0.167  | 0.126  | 0.139  | 0.131  |  0.12  | 0.118  | 0.094  | 0.113  | 0.125  | -0.039 |
| 2000-02-01 00:00:00 | 0.208  | 0.203  | 0.128  | 0.151  | 0.085  | 0.113  | 0.052  | 0.053  | 0.044  | 0.002  | -0.206 |
| 2000-03-01 00:00:00 | 0.001  | 0.035  | 0.019  | 0.006  | 0.024  | 0.012  | -0.008 | 0.017  | 0.014  | 0.032  | 0.032  |
| 2000-04-01 00:00:00 | 0.056  |  0.06  | 0.052  | 0.038  | 0.047  | 0.034  | 0.028  | 0.039  | 0.025  | 0.021  | -0.035 |
| 2000-05-01 00:00:00 | 0.019  | 0.021  | 0.032  |  0.02  | 0.044  | 0.019  | 0.024  | 0.014  | 0.031  | 0.034  | 0.015  |
| 2000-06-01 00:00:00 | 0.108  | 0.057  | 0.056  | 0.062  | 0.047  | 0.047  |  0.05  | 0.029  | 0.035  | 0.041  | -0.067 |
| 2000-07-01 00:00:00 | 0.053  | 0.039  | 0.023  | 0.009  | -0.001 | -0.002 | -0.006 | -0.015 | -0.007 | -0.021 | -0.074 |
| 2000-08-01 00:00:00 | 0.016  | -0.027 | -0.033 | -0.022 | -0.038 | -0.053 | -0.059 | -0.045 | -0.059 | -0.056 | -0.072 |
| 2000-09-01 00:00:00 | 0.065  | 0.058  | 0.049  | 0.048  | 0.034  | 0.035  | 0.026  | 0.029  | 0.014  | 0.007  | -0.057 |
| 2000-10-01 00:00:00 | 0.073  | 0.063  | 0.064  | 0.059  | 0.066  | 0.064  | 0.062  | 0.053  | 0.051  | 0.054  | -0.019 |
| 2000-11-01 00:00:00 | -0.002 | 0.028  | 0.025  | 0.008  | 0.014  | 0.005  | 0.006  | 0.011  | -0.003 | -0.024 | -0.023 |
| 2000-12-01 00:00:00 | -0.024 | -0.019 | -0.012 | -0.006 | -0.012 | -0.006 | -0.014 | -0.003 | -0.003 | -0.02  | 0.003  |
| 2001-01-01 00:00:00 | -0.098 | -0.062 | -0.067 | -0.072 | -0.062 | -0.062 | -0.052 | -0.064 | -0.051 | -0.049 |  0.05  |
| 2001-02-01 00:00:00 | 0.114  | 0.103  | 0.088  | 0.088  | 0.079  | 0.084  | 0.079  | 0.076  | 0.062  | 0.058  | -0.056 |
| 2001-03-01 00:00:00 |  0.04  | 0.019  | 0.001  | 0.012  | -0.005 | -0.003 | -0.009 | 0.002  | -0.014 | -0.015 | -0.055 |
| 2001-04-01 00:00:00 | 0.096  | 0.087  | 0.084  | 0.066  | 0.047  | 0.048  | 0.031  | 0.036  | 0.025  | 0.012  | -0.084 |
| 2001-05-01 00:00:00 | 0.016  | 0.007  | 0.017  | 0.016  |  0.01  | 0.013  | 0.011  | -0.001 | 0.005  | -0.006 | -0.022 |
| 2001-06-01 00:00:00 | -0.133 | -0.143 | -0.135 | -0.135 | -0.133 | -0.138 | -0.143 | -0.129 | -0.127 | -0.134 | -0.002 |
| 2001-07-01 00:00:00 | -0.001 | -0.013 | -0.021 | -0.03  | -0.037 | -0.037 | -0.041 | -0.04  | -0.032 | -0.043 | -0.042 |
| 2001-08-01 00:00:00 | -0.087 | -0.059 | -0.069 | -0.065 | -0.053 | -0.062 | -0.048 | -0.043 | -0.047 | -0.032 | 0.055  |
| 2001-09-01 00:00:00 | -0.057 | -0.064 | -0.059 | -0.058 | -0.056 | -0.057 | -0.065 | -0.046 | -0.056 | -0.033 | 0.024  |
| 2001-10-01 00:00:00 | 0.079  | 0.066  | 0.064  | 0.057  | 0.048  | 0.051  | 0.039  | 0.042  | 0.035  | 0.027  | -0.052 |
| 2001-11-01 00:00:00 | -0.09  | -0.083 | -0.077 | -0.073 | -0.072 | -0.075 | -0.064 | -0.067 | -0.054 | -0.047 | 0.044  |
| 2001-12-01 00:00:00 | -0.166 | -0.135 | -0.149 | -0.142 | -0.126 | -0.123 | -0.115 | -0.109 | -0.095 | -0.067 | 0.099  |
| 2002-01-01 00:00:00 | 0.095  | 0.052  | 0.041  | 0.038  | 0.044  | 0.036  | 0.029  |  0.03  | 0.018  | 0.014  | -0.081 |
| 2002-02-01 00:00:00 | 0.102  | 0.099  |  0.09  | 0.089  | 0.081  | 0.075  | 0.072  | 0.073  | 0.062  | 0.037  | -0.065 |
| 2002-03-01 00:00:00 | 0.081  | 0.067  | 0.054  | 0.057  | 0.055  | 0.041  | 0.045  | 0.032  | 0.037  | 0.031  | -0.049 |
| 2002-04-01 00:00:00 | -0.077 | -0.083 | -0.082 | -0.092 | -0.094 | -0.092 | -0.092 | -0.089 | -0.091 | -0.081 | -0.004 |
| 2002-05-01 00:00:00 | 0.091  | 0.091  | 0.106  | 0.113  | 0.114  | 0.116  | 0.118  | 0.136  | 0.133  | 0.156  | 0.065  |
| 2002-06-01 00:00:00 | -0.026 | -0.032 | -0.034 | -0.033 | -0.034 | -0.036 | -0.043 | -0.04  | -0.047 | -0.042 | -0.016 |
| 2002-07-01 00:00:00 | 0.023  | 0.014  | 0.011  |  0.01  | 0.001  | 0.003  | 0.008  | 0.009  | 0.003  | 0.004  | -0.019 |
| 2002-08-01 00:00:00 | -0.063 | -0.06  | -0.055 | -0.059 | -0.06  | -0.062 | -0.057 | -0.053 | -0.047 | -0.049 | 0.014  |
| 2002-09-01 00:00:00 | -0.051 | -0.071 | -0.06  | -0.074 | -0.057 | -0.047 | -0.054 | -0.05  | -0.044 | -0.048 | 0.004  |
| 2002-10-01 00:00:00 | -0.097 | -0.091 | -0.09  | -0.089 | -0.085 | -0.08  | -0.073 | -0.076 | -0.05  | -0.038 | 0.059  |
| 2002-11-01 00:00:00 | -0.029 | -0.053 | -0.052 | -0.056 | -0.056 | -0.054 | -0.057 | -0.054 | -0.05  | -0.047 | -0.018 |
| 2002-12-01 00:00:00 | 0.134  | 0.123  | 0.113  | 0.114  | 0.098  | 0.101  | 0.092  |  0.08  | 0.075  |  0.09  | -0.044 |
| 2003-01-01 00:00:00 | 0.018  | 0.022  | 0.023  | 0.015  | 0.016  |  0.01  | 0.013  | 0.013  | 0.009  | 0.005  | -0.013 |
| 2003-02-01 00:00:00 | -0.042 | -0.031 | -0.042 | -0.034 | -0.033 | -0.033 | -0.021 | -0.022 | -0.007 |  0.01  | 0.052  |
| 2003-03-01 00:00:00 | -0.094 | -0.067 | -0.081 | -0.067 | -0.038 | -0.051 | -0.035 | -0.011 | 0.005  | 0.021  | 0.115  |
| 2003-04-01 00:00:00 | 0.037  | 0.039  | 0.028  | 0.032  | 0.034  | 0.037  | 0.038  | 0.049  | 0.054  | 0.055  | 0.018  |
| 2003-05-01 00:00:00 | -0.055 | -0.061 | -0.068 | -0.066 | -0.07  | -0.072 | -0.075 | -0.079 | -0.057 | -0.065 | -0.01  |
| 2003-06-01 00:00:00 | -0.05  | -0.049 | -0.041 | -0.039 | -0.037 | -0.036 | -0.03  | -0.023 | -0.007 | 0.013  | 0.063  |
| 2003-07-01 00:00:00 | -0.001 | -0.014 | -0.016 | -0.017 | -0.023 | -0.037 | -0.034 | -0.033 | -0.021 | -0.043 | -0.042 |
| 2003-08-01 00:00:00 | -0.054 | -0.056 | -0.053 | -0.043 | -0.051 | -0.037 | -0.035 | -0.046 | -0.047 | -0.037 | 0.017  |
| 2003-09-01 00:00:00 | -0.114 | -0.096 | -0.086 | -0.08  | -0.075 | -0.065 | -0.066 | -0.044 | -0.028 | 0.003  | 0.117  |
| 2003-10-01 00:00:00 | 0.002  | 0.003  | 0.009  | 0.012  | 0.024  | 0.029  | 0.028  | 0.026  | 0.014  | 0.024  | 0.022  |
| 2003-11-01 00:00:00 | -0.069 | -0.038 | -0.033 | -0.016 | -0.034 | -0.006 | 0.004  | 0.025  | 0.032  |  0.07  | 0.138  |
| 2003-12-01 00:00:00 | 0.111  | 0.105  | 0.102  | 0.096  | 0.099  | 0.097  | 0.084  | 0.068  | 0.073  | 0.052  | -0.058 |
| 2004-01-01 00:00:00 | 0.145  | 0.125  | 0.102  |  0.12  |  0.08  | 0.104  | 0.091  | 0.076  | 0.074  | 0.056  | -0.089 |
| 2004-02-01 00:00:00 | 0.048  | 0.055  | 0.054  | 0.044  | 0.035  | 0.055  | 0.038  | 0.033  | 0.034  | 0.026  | -0.022 |
| 2004-03-01 00:00:00 | -0.115 | -0.124 | -0.105 | -0.098 | -0.093 | -0.098 | -0.095 | -0.084 | -0.096 | -0.107 | 0.008  |
| 2004-04-01 00:00:00 | 0.017  | -0.013 | -0.009 | -0.03  | -0.003 | -0.025 | -0.021 | -0.025 | -0.023 | -0.033 | -0.049 |
| 2004-05-01 00:00:00 | -0.139 | -0.132 | -0.13  | -0.128 | -0.134 | -0.132 | -0.13  | -0.116 | -0.122 | -0.091 | 0.048  |
| 2004-06-01 00:00:00 | -0.072 | -0.059 | -0.054 | -0.025 | -0.027 | -0.023 |  0.01  | 0.005  | 0.014  | 0.008  |  0.08  |
| 2004-07-01 00:00:00 | -0.066 | -0.061 | -0.053 | -0.05  | -0.047 | -0.055 | -0.061 | -0.064 | -0.061 | -0.032 | 0.034  |
| 2004-08-01 00:00:00 | 0.031  | 0.051  | 0.053  | 0.056  | 0.048  | 0.051  | 0.056  | 0.057  |  0.06  | 0.059  | 0.028  |
| 2004-09-01 00:00:00 | -0.129 | -0.091 | -0.081 | -0.067 | -0.066 | -0.053 | -0.064 | -0.058 | -0.028 | -0.04  | 0.089  |
| 2004-10-01 00:00:00 | 0.109  | 0.063  |  0.06  | 0.056  | 0.047  | 0.048  | 0.037  | 0.041  |  0.01  | -0.001 | -0.11  |
| 2004-11-01 00:00:00 | -0.089 | -0.092 | -0.093 | -0.077 | -0.086 | -0.08  | -0.091 | -0.08  | -0.07  | -0.056 | 0.033  |
| 2004-12-01 00:00:00 | -0.045 | -0.062 | -0.084 | -0.077 | -0.081 | -0.075 | -0.084 | -0.076 | -0.078 | -0.052 | -0.006 |
| 2005-01-01 00:00:00 | 0.114  | 0.105  | 0.112  | 0.113  | 0.109  | 0.102  | 0.118  | 0.115  | 0.094  | 0.092  | -0.022 |
| 2005-02-01 00:00:00 | -0.137 | -0.14  | -0.132 | -0.142 | -0.136 | -0.136 | -0.12  | -0.113 | -0.108 | -0.086 |  0.05  |
| 2005-03-01 00:00:00 | -0.14  | -0.125 | -0.092 | -0.096 | -0.081 | -0.053 | -0.065 | -0.037 | -0.026 | 0.004  | 0.144  |
| 2005-04-01 00:00:00 | 0.019  | -0.013 | -0.023 | -0.02  | -0.023 | -0.032 | -0.052 | -0.055 | -0.081 | -0.094 | -0.112 |
| 2005-05-01 00:00:00 | 0.001  |  0.0   | -0.001 | 0.004  | -0.003 | -0.001 | -0.006 | -0.001 | -0.002 | 0.029  | 0.028  |
| 2005-06-01 00:00:00 |  -0.1  |  -0.1  | -0.083 | -0.08  | -0.073 | -0.068 | -0.064 | -0.054 | -0.028 | 0.011  | 0.111  |
| 2005-07-01 00:00:00 | 0.258  | 0.196  | 0.192  | 0.174  | 0.173  | 0.152  | 0.136  | 0.124  | 0.119  |  0.05  | -0.208 |
| 2005-08-01 00:00:00 | 0.081  | 0.027  | 0.031  | 0.025  | -0.002 | 0.027  | 0.029  | 0.029  | 0.027  | -0.004 | -0.085 |
| 2005-09-01 00:00:00 | -0.083 | -0.056 | -0.06  | -0.067 | -0.058 | -0.052 | -0.056 | -0.056 | -0.048 | -0.052 | 0.031  |
| 2005-10-01 00:00:00 | 0.032  | 0.028  | 0.037  | 0.017  | 0.015  |  0.01  | 0.013  | -0.003 | -0.014 | -0.012 | -0.044 |
| 2005-11-01 00:00:00 | -0.011 | -0.005 | 0.001  | 0.017  | 0.012  | 0.023  | 0.032  | 0.053  | 0.067  | 0.073  | 0.085  |
| 2005-12-01 00:00:00 | -0.008 | 0.056  | 0.076  |  0.09  | 0.078  | 0.091  |  0.11  |  0.13  | 0.127  | 0.096  | 0.104  |
| 2006-01-01 00:00:00 | 0.094  | 0.047  | 0.026  | 0.032  | 0.021  | 0.022  | 0.017  | 0.019  | -0.001 | 0.043  | -0.051 |
| 2006-02-01 00:00:00 | -0.037 | -0.008 | -0.004 | -0.002 | 0.004  | 0.006  | 0.031  | 0.028  | 0.057  | 0.027  | 0.064  |
| 2006-03-01 00:00:00 | 0.139  | 0.007  | 0.082  |  0.08  | 0.099  | 0.113  | 0.105  | 0.133  | 0.139  | 0.151  | 0.011  |
| 2006-04-01 00:00:00 |  1.07  | 0.313  | 0.307  | 0.308  | 0.274  | 0.269  | 0.258  | 0.237  | 0.213  | 0.164  | -0.906 |
| 2006-05-01 00:00:00 |  0.07  | 0.079  | 0.066  | 0.083  | 0.065  | 0.071  | 0.039  | 0.053  | 0.024  | 0.021  | -0.049 |
| 2006-06-01 00:00:00 | 0.001  | 0.005  | -0.014 | -0.012 | -0.037 | -0.028 | -0.041 | -0.059 | -0.047 | -0.084 | -0.085 |
| 2006-07-01 00:00:00 | 0.022  |  0.03  | 0.025  | 0.023  | 0.032  | 0.033  | 0.035  | 0.045  |  0.04  | 0.027  | 0.005  |
| 2006-08-01 00:00:00 | 0.113  | 0.065  | 0.062  | 0.049  | 0.052  | 0.041  | 0.046  | 0.036  | 0.037  | 0.043  | -0.07  |
| 2006-09-01 00:00:00 | -0.01  | -0.013 | -0.018 | -0.002 | 0.016  | -0.017 | -0.011 |  -0.0  | 0.019  | 0.029  | 0.039  |
| 2006-10-01 00:00:00 | -0.011 | -0.007 | -0.003 | 0.022  | 0.025  | 0.035  | 0.063  | 0.059  | 0.105  | 0.171  | 0.182  |
| 2006-11-01 00:00:00 | 0.011  | 0.036  | 0.035  |  0.05  | 0.035  | 0.042  | 0.069  | 0.085  | 0.095  | 0.153  | 0.141  |
| 2006-12-01 00:00:00 | 0.305  | 0.269  |  0.26  | 0.286  | 0.257  |  0.25  | 0.224  | 0.234  | 0.241  |  0.19  | -0.115 |
| 2007-01-01 00:00:00 | 0.257  | 0.244  | 0.241  | 0.223  | 0.217  | 0.186  | 0.245  | 0.136  |  0.15  | 0.083  | -0.175 |
| 2007-02-01 00:00:00 | 0.272  | 0.261  | 0.216  | 0.204  | 0.191  | 0.164  | 0.175  | 0.143  | 0.085  | 0.087  | -0.185 |
| 2007-03-01 00:00:00 | 0.332  | 0.329  | 0.343  | 0.363  | 0.339  | 0.322  | 0.336  | 0.348  | 0.347  | 0.283  | -0.049 |
| 2007-04-01 00:00:00 | 0.199  | 0.088  | 0.089  | 0.081  | 0.071  | 0.131  | 0.111  | 0.079  | 0.106  | 0.135  | -0.064 |
| 2007-05-01 00:00:00 | -0.22  | -0.23  | -0.216 | -0.211 | -0.189 | -0.155 | -0.159 | -0.13  | -0.092 | -0.04  | 0.181  |
| 2007-06-01 00:00:00 | 0.296  | 0.287  | 0.278  | 0.244  | 0.236  | 0.236  | 0.212  | 0.186  | 0.189  | 0.185  | -0.111 |
| 2007-07-01 00:00:00 | 0.198  | 0.127  | 0.104  | 0.099  | 0.094  | 0.096  | 0.115  | 0.108  | 0.143  |  0.18  | -0.018 |
| 2007-08-01 00:00:00 | 0.046  | 0.016  | 0.018  | 0.025  | 0.035  | 0.042  | 0.029  |  0.04  | 0.054  | 0.075  | 0.029  |
| 2007-09-01 00:00:00 | -0.124 | -0.139 | -0.115 | -0.117 | -0.121 | -0.099 | -0.117 | -0.097 | -0.084 | -0.007 | 0.117  |
| 2007-10-01 00:00:00 | 0.009  | -0.013 | -0.019 | -0.052 | -0.049 | -0.075 | -0.08  |  -0.1  | -0.134 | -0.187 | -0.196 |
| 2007-11-01 00:00:00 | 0.184  | 0.205  | 0.204  | 0.208  |  0.21  |  0.21  |  0.22  | 0.216  |  0.2   | 0.148  | -0.036 |
| 2007-12-01 00:00:00 | -0.054 | -0.06  | -0.063 | -0.051 | -0.077 | -0.047 | -0.059 | -0.069 | -0.084 | -0.12  | -0.067 |
| 2008-01-01 00:00:00 | 0.116  | 0.109  | 0.117  | 0.107  | 0.101  | 0.083  | 0.076  | 0.065  | 0.043  | 0.017  | -0.099 |
| 2008-02-01 00:00:00 | -0.174 | -0.171 | -0.181 | -0.182 | -0.199 | -0.201 | -0.199 | -0.217 | -0.224 | -0.212 | -0.039 |
| 2008-03-01 00:00:00 | -0.087 | -0.091 | -0.077 | -0.075 | -0.069 | -0.051 | -0.049 | -0.006 | 0.017  | 0.043  |  0.13  |
| 2008-04-01 00:00:00 | 0.006  | -0.007 | -0.008 | -0.003 | -0.026 | -0.039 | -0.027 | -0.059 | -0.048 | -0.078 | -0.084 |
| 2008-05-01 00:00:00 | -0.239 | -0.234 | -0.266 | -0.275 | -0.249 | -0.26  | -0.239 | -0.25  | -0.234 | -0.221 | 0.018  |
| 2008-06-01 00:00:00 | 0.137  | 0.118  | 0.116  | 0.111  | 0.108  | 0.103  | 0.072  | 0.076  | 0.052  | 0.005  | -0.132 |
| 2008-07-01 00:00:00 | -0.207 | -0.224 | -0.227 | -0.233 | -0.223 | -0.238 | -0.241 | -0.238 | -0.229 | -0.194 | 0.013  |
| 2008-08-01 00:00:00 | -0.117 | -0.104 | -0.09  | -0.098 | -0.101 | -0.08  | -0.085 | -0.061 | -0.044 | -0.026 |  0.09  |
| 2008-09-01 00:00:00 | -0.225 | -0.232 | -0.249 | -0.265 | -0.247 | -0.266 | -0.272 | -0.262 | -0.275 | -0.248 | -0.023 |
| 2008-10-01 00:00:00 | 0.231  | 0.215  | 0.219  | 0.221  | 0.225  | 0.223  | 0.185  | 0.161  | 0.157  | 0.131  | -0.101 |
| 2008-11-01 00:00:00 | 0.155  |  0.13  | 0.094  | 0.097  | 0.061  | 0.068  | 0.053  | 0.065  | 0.041  | 0.013  | -0.142 |
| 2008-12-01 00:00:00 | 0.149  | 0.161  | 0.163  | 0.159  | 0.162  | 0.187  | 0.162  | 0.169  | 0.158  | 0.119  | -0.03  |
| 2009-01-01 00:00:00 | 0.124  | 0.116  | 0.094  | 0.084  | 0.092  |  0.09  | 0.073  | 0.081  | 0.057  | 0.063  | -0.061 |
| 2009-02-01 00:00:00 | 0.255  | 0.254  | 0.235  | 0.246  | 0.226  | 0.224  |  0.21  | 0.209  | 0.198  | 0.186  | -0.069 |
| 2009-03-01 00:00:00 | 0.102  |  0.11  | 0.078  | 0.074  | 0.081  | 0.073  | 0.038  | 0.066  | 0.041  |  0.05  | -0.052 |
| 2009-04-01 00:00:00 | 0.096  | 0.092  | 0.106  |  0.07  | 0.085  | 0.062  | 0.057  | 0.047  | 0.045  | 0.056  | -0.041 |
| 2009-05-01 00:00:00 | 0.112  | 0.081  | 0.061  | 0.039  |  0.04  | 0.055  | 0.039  | 0.053  | 0.078  | 0.124  | 0.012  |
| 2009-06-01 00:00:00 | 0.134  | 0.125  | 0.133  | 0.136  | 0.143  | 0.155  | 0.129  | 0.153  | 0.182  | 0.183  |  0.05  |
| 2009-07-01 00:00:00 | -0.124 | -0.141 | -0.151 | -0.144 | -0.147 | -0.139 | -0.155 | -0.171 | -0.18  | -0.236 | -0.112 |
| 2009-08-01 00:00:00 | 0.055  | 0.041  | 0.044  | 0.024  |  0.03  | 0.037  | 0.032  | 0.035  |  0.04  | 0.052  | -0.003 |
| 2009-09-01 00:00:00 | 0.124  | 0.133  | 0.129  | 0.128  |  0.12  | 0.132  |  0.12  | 0.112  | 0.108  | 0.092  | -0.032 |
| 2009-10-01 00:00:00 | 0.167  | 0.173  | 0.153  | 0.158  | 0.163  | 0.178  | 0.144  | 0.142  | 0.109  | 0.084  | -0.083 |
| 2009-11-01 00:00:00 | 0.052  | 0.039  | 0.035  | 0.029  | 0.035  | 0.032  | 0.006  | 0.005  | -0.005 | 0.004  | -0.048 |
| 2009-12-01 00:00:00 | -0.016 | -0.011 | -0.033 | -0.026 | -0.018 | -0.031 | -0.019 | -0.035 | -0.049 |  -0.1  | -0.084 |
| 2010-01-01 00:00:00 |  0.09  | 0.082  | 0.078  | 0.064  | 0.061  | 0.068  | 0.059  | 0.057  | 0.043  | 0.025  | -0.065 |
| 2010-02-01 00:00:00 | 0.086  | 0.067  | 0.064  | 0.053  | 0.039  | 0.042  | 0.046  | 0.017  | 0.017  | 0.011  | -0.075 |
| 2010-03-01 00:00:00 | -0.056 | -0.063 | -0.082 | -0.084 | -0.072 | -0.068 | -0.07  | -0.078 | -0.063 | -0.073 | -0.017 |
| 2010-04-01 00:00:00 | -0.088 | -0.08  | -0.073 | -0.088 | -0.094 | -0.077 | -0.08  | -0.065 | -0.078 | -0.089 |  -0.0  |
| 2010-05-01 00:00:00 | -0.082 | -0.083 | -0.087 | -0.083 | -0.091 | -0.094 | -0.099 | -0.101 | -0.098 | -0.081 | 0.001  |
| 2010-06-01 00:00:00 | 0.168  | 0.164  | 0.153  | 0.149  | 0.149  | 0.164  | 0.143  | 0.138  | 0.133  |  0.13  | -0.038 |
| 2010-07-01 00:00:00 | 0.107  | 0.106  |  0.09  | 0.113  | 0.097  | 0.096  | 0.084  | 0.109  | 0.075  | 0.027  | -0.08  |
| 2010-08-01 00:00:00 | 0.025  | -0.012 | -0.007 | 0.002  | 0.007  | -0.004 | -0.008 | 0.016  |  0.02  | 0.016  | -0.009 |
| 2010-09-01 00:00:00 | 0.062  | 0.078  | 0.074  | 0.098  | 0.082  | 0.091  | 0.093  | 0.098  | 0.114  | 0.156  | 0.094  |
| 2010-10-01 00:00:00 | 0.039  | 0.036  |  0.04  | 0.028  | 0.014  | 0.012  | 0.016  | 0.018  | -0.015 | -0.06  | -0.099 |
| 2010-11-01 00:00:00 | -0.007 | -0.023 | -0.015 | -0.024 | -0.029 | -0.035 | -0.027 | -0.034 | -0.018 | 0.007  | 0.014  |
| 2010-12-01 00:00:00 | -0.031 | -0.055 | -0.053 | -0.059 | -0.06  | -0.058 | -0.067 | -0.065 | -0.065 | -0.025 | 0.006  |
| 2011-01-01 00:00:00 | 0.099  | 0.104  | 0.101  | 0.093  | 0.106  | 0.096  | 0.105  | 0.102  | 0.085  | 0.059  | -0.04  |
| 2011-02-01 00:00:00 | 0.034  | 0.004  | -0.008 | -0.001 | -0.019 | -0.024 | -0.036 | -0.022 | -0.027 | -0.027 | -0.06  |
| 2011-03-01 00:00:00 | -0.029 | -0.04  | -0.039 | -0.051 | -0.046 | -0.046 | -0.029 | -0.037 | -0.034 | -0.019 |  0.01  |
| 2011-04-01 00:00:00 | -0.062 | -0.074 | -0.068 | -0.075 | -0.06  | -0.081 | -0.081 | -0.081 | -0.083 | -0.067 | -0.005 |
| 2011-05-01 00:00:00 | 0.044  | 0.045  | 0.035  |  0.03  | 0.046  | 0.025  | 0.034  | 0.032  | 0.036  | 0.029  | -0.015 |
| 2011-06-01 00:00:00 |  0.04  | 0.029  |  0.03  | 0.033  | 0.033  | 0.021  | 0.016  | 0.024  | 0.011  | -0.012 | -0.052 |
| 2011-07-01 00:00:00 | 0.008  | -0.009 | -0.014 | -0.019 | -0.031 | -0.031 | -0.035 | -0.033 | -0.047 | -0.052 | -0.06  |
| 2011-08-01 00:00:00 | -0.109 | -0.117 | -0.122 | -0.119 | -0.121 | -0.133 | -0.13  | -0.137 | -0.122 | -0.096 | 0.013  |
| 2011-09-01 00:00:00 | 0.054  | 0.044  | 0.046  |  0.04  | 0.046  | 0.044  | 0.039  | 0.046  | 0.039  | 0.035  | -0.019 |
| 2011-10-01 00:00:00 | -0.03  | -0.022 | -0.042 | -0.048 | -0.027 | -0.038 | -0.045 | -0.04  | -0.055 | -0.065 | -0.035 |
| 2011-11-01 00:00:00 | -0.177 | -0.178 | -0.169 | -0.171 | -0.172 | -0.152 | -0.164 | -0.142 | -0.12  | -0.085 | 0.092  |
| 2011-12-01 00:00:00 |  0.01  | -0.007 | -0.021 | -0.023 | -0.007 | -0.014 | -0.009 | -0.007 | -0.004 | 0.035  | 0.025  |
| 2012-01-01 00:00:00 |  0.16  | 0.155  | 0.149  | 0.142  | 0.137  | 0.136  | 0.127  | 0.127  | 0.117  | 0.082  | -0.078 |
| 2012-02-01 00:00:00 | -0.079 | -0.081 | -0.073 | -0.07  | -0.076 | -0.077 | -0.076 | -0.078 | -0.073 | -0.074 | 0.004  |
| 2012-03-01 00:00:00 | 0.061  | 0.064  | 0.069  | 0.084  | 0.065  | 0.068  | 0.072  |  0.06  | 0.057  | 0.069  | 0.008  |
| 2012-04-01 00:00:00 |  0.04  | 0.029  | 0.012  | 0.023  | 0.023  |  0.02  | 0.023  | 0.031  | 0.032  | 0.013  | -0.028 |
| 2012-05-01 00:00:00 | -0.018 | -0.035 | -0.055 | -0.058 | -0.061 | -0.07  | -0.068 | -0.071 | -0.062 | -0.061 | -0.043 |
| 2012-06-01 00:00:00 | -0.125 | -0.108 | -0.095 | -0.101 | -0.097 | -0.102 | -0.093 | -0.087 | -0.081 | -0.057 | 0.068  |
| 2012-07-01 00:00:00 | 0.068  | 0.064  | 0.055  | 0.047  | 0.032  | 0.033  | 0.013  | 0.005  | -0.023 | -0.053 | -0.121 |
| 2012-08-01 00:00:00 | 0.014  | 0.016  | -0.007 | 0.004  | 0.004  | -0.001 | -0.001 | 0.018  | 0.017  | 0.039  | 0.026  |
| 2012-09-01 00:00:00 | 0.012  |  0.01  | 0.004  | -0.001 | 0.003  |  -0.0  | -0.01  | -0.008 | -0.018 | -0.016 | -0.028 |
| 2012-10-01 00:00:00 | -0.095 | -0.12  | -0.115 | -0.12  | -0.122 | -0.116 | -0.124 | -0.116 | -0.105 | -0.066 | 0.029  |
| 2012-11-01 00:00:00 | 0.167  | 0.175  | 0.165  | 0.169  | 0.181  | 0.164  | 0.174  | 0.179  | 0.166  | 0.175  | 0.008  |
| 2012-12-01 00:00:00 | 0.062  | 0.057  | 0.073  | 0.071  | 0.071  | 0.064  | 0.059  | 0.065  | 0.056  | 0.054  | -0.008 |
| 2013-01-01 00:00:00 |  0.06  | 0.041  | 0.041  | 0.041  | 0.037  | 0.034  | 0.039  | 0.041  | 0.036  | 0.005  | -0.055 |
| 2013-02-01 00:00:00 | -0.025 | -0.026 | -0.017 | -0.03  | -0.03  | -0.025 | -0.048 | -0.045 | -0.047 | -0.053 | -0.028 |
| 2013-03-01 00:00:00 | -0.023 | -0.048 | -0.04  | -0.031 | -0.032 | -0.027 | -0.027 | -0.019 | -0.021 | -0.022 | 0.002  |
| 2013-04-01 00:00:00 | 0.177  | 0.155  | 0.157  | 0.153  | 0.153  | 0.146  | 0.151  | 0.152  | 0.132  | 0.076  | -0.102 |
| 2013-05-01 00:00:00 | -0.139 | -0.157 | -0.155 | -0.155 | -0.161 | -0.158 | -0.15  | -0.164 | -0.153 | -0.14  | -0.001 |
| 2013-06-01 00:00:00 | 0.123  | 0.086  | 0.072  | 0.075  | 0.083  | 0.063  | 0.063  | 0.072  | 0.051  | 0.028  | -0.095 |
| 2013-07-01 00:00:00 | 0.104  | 0.092  | 0.112  |  0.1   | 0.076  |  0.08  | 0.089  | 0.078  | 0.062  | 0.063  | -0.041 |
| 2013-08-01 00:00:00 | 0.076  | 0.053  | 0.052  | 0.053  | 0.059  | 0.043  | 0.056  | 0.049  | 0.056  | 0.054  | -0.021 |
| 2013-09-01 00:00:00 | -0.006 | -0.013 | -0.018 | -0.024 | -0.017 | -0.029 | -0.039 | -0.033 | -0.038 | -0.034 | -0.027 |
| 2013-10-01 00:00:00 | 0.131  | 0.128  | 0.111  | 0.086  | 0.097  | 0.083  | 0.076  | 0.068  | 0.055  | 0.044  | -0.087 |
| 2013-11-01 00:00:00 | -0.02  | -0.029 | -0.031 | -0.032 | -0.039 | -0.03  | -0.038 | -0.03  | -0.038 | -0.044 | -0.023 |
| 2013-12-01 00:00:00 | 0.035  | 0.062  | 0.024  |  0.01  | 0.031  | 0.046  | 0.007  | 0.035  | 0.004  | -0.031 | -0.066 |
| 2014-01-01 00:00:00 | 0.067  |  0.05  | 0.047  | 0.047  | 0.044  | 0.044  | 0.032  | 0.017  | 0.009  | -0.018 | -0.085 |
| 2014-02-01 00:00:00 | 0.025  | 0.003  | -0.013 | -0.021 | -0.033 | -0.037 | -0.042 | -0.043 | -0.043 | -0.036 | -0.061 |
| 2014-03-01 00:00:00 | 0.022  | 0.006  | -0.008 | -0.012 | -0.03  | -0.03  | -0.016 | -0.015 | -0.025 | -0.004 | -0.026 |
| 2014-04-01 00:00:00 | 0.115  | 0.055  | 0.048  | 0.027  | 0.036  | 0.032  | 0.037  | 0.022  |  0.02  | 0.008  | -0.107 |
| 2014-05-01 00:00:00 | 0.079  |  0.09  | 0.073  | 0.062  | 0.052  | 0.056  | 0.042  | 0.037  | 0.034  | 0.019  | -0.06  |
| 2014-06-01 00:00:00 | 0.104  | 0.075  | 0.075  | 0.083  | 0.077  | 0.069  | 0.072  | 0.072  | 0.066  | 0.077  | -0.027 |
| 2014-07-01 00:00:00 | 0.111  | 0.091  | 0.068  | 0.066  | 0.057  | 0.056  | 0.046  | 0.046  | 0.048  | 0.013  | -0.098 |
| 2014-08-01 00:00:00 | 0.211  | 0.191  | 0.158  | 0.146  | 0.146  | 0.122  |  0.12  |  0.12  | 0.104  | 0.066  | -0.145 |
| 2014-09-01 00:00:00 | 0.021  | 0.019  | 0.033  | 0.036  | 0.014  | 0.017  | 0.009  | 0.017  | 0.009  | 0.025  | 0.005  |
| 2014-10-01 00:00:00 | 0.069  | 0.075  | 0.047  | 0.064  | 0.054  |  0.07  | 0.037  | 0.048  | 0.062  | 0.109  |  0.04  |
| 2014-11-01 00:00:00 | -0.108 | -0.083 | -0.078 | -0.076 | -0.067 | -0.048 | -0.036 | 0.006  | 0.021  | 0.202  | 0.309  |
| 2014-12-01 00:00:00 | 0.116  | 0.106  | 0.112  | 0.104  |  0.09  | 0.099  | 0.074  | 0.076  | 0.075  | -0.001 | -0.116 |
| 2015-01-01 00:00:00 | 0.117  | 0.086  | 0.081  | 0.074  |  0.09  | 0.087  | 0.099  | 0.087  | 0.095  | 0.058  | -0.059 |
| 2015-02-01 00:00:00 | 0.271  | 0.243  | 0.243  | 0.251  |  0.24  | 0.242  | 0.224  | 0.225  | 0.201  | 0.153  | -0.118 |
| 2015-03-01 00:00:00 | 0.217  | 0.179  | 0.171  |  0.2   | 0.148  | 0.164  | 0.161  | 0.158  | 0.147  | 0.196  | -0.021 |
| 2015-04-01 00:00:00 | 0.373  | 0.317  | 0.294  | 0.284  | 0.276  | 0.256  | 0.253  | 0.203  | 0.158  | 0.059  | -0.314 |
| 2015-05-01 00:00:00 | -0.047 | -0.096 | -0.123 | -0.124 | -0.155 | -0.156 | -0.156 | -0.118 | -0.133 | -0.098 | -0.05  |
| 2015-06-01 00:00:00 | -0.161 | -0.178 | -0.209 | -0.209 | -0.203 | -0.19  | -0.179 | -0.152 | -0.159 | -0.164 | -0.003 |
| 2015-07-01 00:00:00 | -0.088 | -0.125 | -0.121 | -0.149 | -0.156 | -0.15  | -0.151 | -0.165 | -0.168 | -0.139 | -0.051 |
| 2015-08-01 00:00:00 | 0.004  | -0.005 | -0.003 | 0.009  | -0.011 | -0.011 | -0.01  | -0.034 | -0.046 | -0.061 | -0.065 |
| 2015-09-01 00:00:00 | 0.301  |  0.27  | 0.276  | 0.257  | 0.258  | 0.237  | 0.222  | 0.219  | 0.209  | 0.136  | -0.165 |
| 2015-10-01 00:00:00 | 0.203  | 0.193  | 0.173  | 0.148  | 0.128  | 0.111  | 0.081  | 0.061  | 0.045  | 0.013  | -0.19  |
| 2015-11-01 00:00:00 | 0.152  | 0.099  | 0.085  | 0.066  | 0.053  | 0.029  | 0.038  | 0.034  | 0.019  | 0.031  | -0.121 |
| 2015-12-01 00:00:00 | -0.303 | -0.296 | -0.309 | -0.31  | -0.306 | -0.311 | -0.305 | -0.298 | -0.301 | -0.25  | 0.053  |
| 2016-01-01 00:00:00 | 0.009  | -0.005 | -0.009 | -0.022 | -0.021 | -0.028 | -0.031 | -0.02  | -0.019 | -0.022 | -0.03  |
| 2016-02-01 00:00:00 | 0.257  | 0.223  |  0.22  | 0.201  | 0.208  | 0.214  | 0.187  | 0.179  | 0.169  | 0.137  | -0.12  |
| 2016-03-01 00:00:00 | 0.062  | 0.042  | 0.016  |  0.0   | -0.011 | -0.027 | -0.016 | -0.034 | -0.03  | -0.036 | -0.098 |
| 2016-04-01 00:00:00 | -0.035 | -0.029 | -0.023 | -0.011 | -0.01  | -0.007 | 0.003  | 0.002  | -0.005 | -0.004 | 0.031  |
| 2016-05-01 00:00:00 | 0.068  | 0.085  | 0.085  | 0.082  | 0.082  | 0.072  | 0.055  | 0.054  | 0.027  | 0.013  | -0.055 |
| 2016-06-01 00:00:00 | 0.002  | 0.001  | -0.009 | -0.014 | -0.02  | -0.02  | -0.026 | -0.011 | -0.003 | 0.034  | 0.032  |
| 2016-07-01 00:00:00 | 0.085  | 0.066  | 0.061  |  0.06  | 0.046  | 0.039  | 0.039  | 0.036  | 0.032  | 0.034  | -0.051 |
| 2016-08-01 00:00:00 | 0.057  | 0.016  | -0.005 | -0.019 | -0.014 | -0.021 | -0.031 | -0.026 | -0.031 | -0.032 | -0.089 |
| 2016-09-01 00:00:00 | 0.051  | 0.056  | 0.051  | 0.042  | 0.043  | 0.047  | 0.024  | 0.027  | 0.022  | 0.023  | -0.028 |
| 2016-10-01 00:00:00 | 0.062  | 0.055  | 0.036  | 0.025  | 0.026  | 0.021  | 0.016  | 0.016  | 0.021  | 0.044  | -0.019 |
| 2016-11-01 00:00:00 | 0.007  | -0.039 | -0.039 | -0.06  | -0.063 | -0.071 | -0.067 | -0.065 | -0.06  | -0.063 | -0.07  |
| 2016-12-01 00:00:00 | -0.043 | -0.037 | -0.043 | -0.04  | -0.037 | -0.034 | -0.03  | -0.029 | -0.021 | 0.012  | 0.055  |
| 2017-01-01 00:00:00 | 0.083  | 0.047  | 0.046  | 0.044  | 0.048  | 0.042  | 0.037  | 0.039  | 0.049  | 0.033  | -0.05  |
| 2017-02-01 00:00:00 | -0.031 | -0.022 | -0.021 | -0.024 | -0.018 | -0.019 | -0.02  | -0.011 | -0.012 | 0.005  | 0.036  |
| 2017-03-01 00:00:00 | -0.098 | -0.089 | -0.077 | -0.078 | -0.068 | -0.076 | -0.053 | -0.045 | -0.027 | -0.01  | 0.089  |
| 2017-04-01 00:00:00 | -0.095 | -0.093 | -0.091 | -0.083 | -0.085 | -0.081 | -0.076 | -0.068 | -0.067 | -0.02  | 0.076  |
| 2017-05-01 00:00:00 | 0.041  | 0.033  |  0.03  |  0.03  | 0.028  |  0.04  | 0.036  | 0.043  | 0.055  | 0.054  | 0.013  |
| 2017-06-01 00:00:00 | -0.048 | -0.034 | -0.018 | -0.018 |  0.0   | -0.003 | 0.004  | 0.008  | 0.027  | 0.017  | 0.065  |
| 2017-07-01 00:00:00 | 0.095  | 0.058  | 0.048  | 0.039  | 0.042  | 0.035  |  0.03  | 0.034  | 0.027  | 0.025  | -0.071 |
| 2017-08-01 00:00:00 | 0.019  |  0.02  | 0.023  | 0.011  | 0.014  | 0.017  | 0.013  | 0.016  | 0.011  | 0.003  | -0.016 |
| 2017-09-01 00:00:00 | -0.011 | -0.031 | -0.023 | -0.031 | -0.024 | -0.028 | -0.027 | -0.02  | -0.007 |  0.02  | 0.031  |
| 2017-10-01 00:00:00 | -0.086 | -0.099 | -0.097 | -0.085 | -0.081 | -0.073 | -0.057 | -0.057 | -0.044 | -0.028 | 0.058  |
| 2017-11-01 00:00:00 | -0.022 | -0.029 | -0.021 | -0.031 | -0.023 | -0.021 | -0.014 | -0.014 | -0.006 | -0.003 | 0.019  |
| 2017-12-01 00:00:00 | -0.05  | -0.041 | -0.046 | -0.05  | -0.04  | -0.034 | -0.029 | -0.023 | -0.005 | 0.025  | 0.075  |
| 2018-01-01 00:00:00 | -0.073 | -0.066 | -0.065 | -0.06  | -0.055 | -0.051 | -0.04  | -0.029 | -0.031 | -0.042 | 0.031  |
| 2018-02-01 00:00:00 | 0.133  | 0.099  | 0.092  | 0.065  | 0.057  | 0.052  | 0.038  |  0.03  | 0.011  | -0.013 | -0.146 |
| 2018-03-01 00:00:00 | -0.045 | -0.036 | -0.045 | -0.04  | -0.051 | -0.036 | -0.043 | -0.034 | -0.044 | -0.033 | 0.012  |
| 2018-04-01 00:00:00 | 0.014  | 0.019  | -0.015 | -0.021 | -0.025 | -0.011 | -0.013 | -0.019 | -0.007 | 0.014  |  0.0   |
| 2018-05-01 00:00:00 | -0.112 | -0.098 | -0.119 | -0.114 | -0.12  | -0.116 | -0.112 | -0.102 | -0.101 | -0.081 | 0.031  |
| 2018-06-01 00:00:00 | 0.028  | 0.018  | 0.002  | -0.008 | -0.016 | 0.002  | -0.015 | -0.009 | -0.001 | -0.003 | -0.03  |
| 2018-07-01 00:00:00 | -0.083 | -0.09  | -0.08  | -0.085 | -0.079 | -0.082 | -0.088 | -0.082 | -0.077 | -0.068 | 0.014  |
| 2018-08-01 00:00:00 | 0.013  | -0.002 | -0.013 | -0.01  | -0.014 | -0.013 | -0.002 | -0.018 | -0.001 | 0.015  | 0.001  |
| 2018-09-01 00:00:00 | -0.044 | -0.079 | -0.09  | -0.091 | -0.097 | -0.113 | -0.116 | -0.11  | -0.091 | -0.093 | -0.049 |
| 2018-10-01 00:00:00 | 0.089  | 0.067  | 0.077  | 0.064  | 0.069  | 0.061  | 0.054  | 0.045  | 0.032  | 0.013  | -0.076 |
| 2018-11-01 00:00:00 | -0.022 | -0.035 | -0.031 | -0.043 | -0.048 | -0.055 | -0.047 | -0.044 | -0.04  | -0.044 | -0.022 |
| 2018-12-01 00:00:00 | -0.046 | -0.04  | -0.039 | -0.038 | -0.03  | -0.019 | -0.02  | -0.018 | 0.008  | 0.026  | 0.071  |
| 2019-01-01 00:00:00 | 0.241  | 0.235  | 0.237  | 0.243  | 0.231  | 0.218  | 0.239  | 0.203  | 0.209  | 0.187  | -0.054 |
| 2019-02-01 00:00:00 | 0.122  |  0.11  | 0.112  |  0.11  | 0.104  | 0.104  | 0.111  | 0.102  | 0.103  |  0.07  | -0.053 |
| 2019-03-01 00:00:00 | -0.018 | -0.038 | -0.048 | -0.045 | -0.052 | -0.034 | -0.037 | -0.05  | -0.047 | -0.022 | -0.004 |
| 2019-04-01 00:00:00 | -0.012 | -0.031 | -0.033 | -0.051 | -0.055 | -0.045 | -0.06  | -0.067 | -0.066 | -0.067 | -0.055 |
| 2019-05-01 00:00:00 | 0.017  | 0.013  | 0.001  | -0.006 | -0.004 | -0.007 | -0.01  | 0.001  | 0.015  | 0.035  | 0.018  |
| 2019-06-01 00:00:00 | -0.011 | -0.016 | -0.03  | -0.028 | -0.023 | -0.032 | -0.016 | -0.022 | -0.005 | 0.005  | 0.016  |
| 2019-07-01 00:00:00 | -0.027 | -0.017 | -0.022 | -0.011 | -0.008 | -0.004 | -0.013 | -0.001 | -0.008 | -0.002 | 0.025  |
| 2019-08-01 00:00:00 | 0.018  | 0.023  | 0.027  | 0.019  | 0.014  |  0.01  | 0.008  | 0.015  | 0.009  |  0.01  | -0.008 |
| 2019-09-01 00:00:00 |  -0.0  | -0.008 | -0.002 | -0.002 | -0.02  | -0.001 | -0.011 | -0.003 | -0.003 | 0.005  | 0.006  |
| 2019-10-01 00:00:00 | -0.015 | -0.022 | -0.026 | -0.023 | -0.033 | -0.023 | -0.029 | -0.023 | -0.011 | -0.005 |  0.01  |
| 2019-11-01 00:00:00 | 0.097  | 0.097  | 0.077  | 0.078  | 0.081  | 0.091  | 0.071  | 0.081  | 0.081  | 0.082  | -0.015 |
| 2019-12-01 00:00:00 | -0.023 | -0.014 | 0.002  | 0.005  | -0.001 | 0.013  |  0.01  | 0.027  | 0.014  | 0.001  | 0.025  |
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |  Diff  |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| Average | 0.031 | 0.019 | 0.015 | 0.014 | 0.011 | 0.011 | 0.008 | 0.009 | 0.008 | 0.008 | -0.023 |
|  T-Test |  3.73 |  2.84 | 2.313 | 2.043 | 1.756 | 1.781 | 1.359 | 1.578 | 1.479 | 1.555 | -3.79  |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
```

The second dataset contains below 30% stocks from 2000-01-01 to 2019-12-01. The size effect is **significant** since the t-test statistics is -3.79 whose absolute value is more than 2 corresponding to the significance level at 0.05. The monthly excess return is **2.3%** and the annual excess return is about 27.6%. 

```python
# %% dataset 3
# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_3 = month_return[(month_return['cap']==True) & (month_return['Ndaytrd']>=10)]
# construct data for univariate analysis
test_data_3 = test_data_3[['emrwd', 'Msmvttl', 'Time']].dropna()
# time interval between 2000-01-01 to 2016-12-01
test_data_3 = test_data_3[(test_data_3['Time'] >= '2000-01-01') & (test_data_3['Time'] <= '2016-12-01')]
# analysis
uni_3 = Univariate(np.array(test_data_3), number=9)
uni_3.average_by_time()
uni_3.summary_and_test()
uni_3.print_summary_by_time()
uni_3.print_summary()
==========================================================================================================================
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
|         Time        |   1    |   2    |   3    |   4    |   5    |   6    |   7    |   8    |   9    |   10   |  diff  |
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
| 2000-01-01 00:00:00 | 0.124  | 0.144  | 0.126  | 0.129  |  0.1   | 0.129  | 0.095  | 0.103  | 0.114  | 0.135  | 0.011  |
| 2000-02-01 00:00:00 | 0.155  | 0.122  | 0.075  |  0.12  | 0.053  | 0.064  | 0.054  |  0.04  | 0.022  | 0.009  | -0.146 |
| 2000-03-01 00:00:00 | 0.007  | 0.022  | 0.012  |  0.01  | 0.004  | 0.002  | 0.016  | 0.015  | 0.017  | 0.033  | 0.026  |
| 2000-04-01 00:00:00 | 0.034  | 0.042  | 0.042  | 0.043  |  0.03  | 0.024  | 0.049  | 0.022  | 0.021  | 0.021  | -0.013 |
| 2000-05-01 00:00:00 | 0.008  | 0.041  | 0.046  | 0.015  | 0.029  | 0.022  | 0.007  |  0.03  | 0.044  | 0.021  | 0.013  |
| 2000-06-01 00:00:00 |  0.06  | 0.067  | 0.045  | 0.038  | 0.051  | 0.042  | 0.029  | 0.036  | 0.032  | 0.045  | -0.016 |
| 2000-07-01 00:00:00 | 0.017  | -0.003 | 0.003  | 0.001  | -0.013 | -0.008 | -0.014 | -0.003 | -0.012 | -0.028 | -0.045 |
| 2000-08-01 00:00:00 | -0.027 | -0.025 | -0.032 | -0.056 | -0.061 | -0.055 | -0.04  | -0.065 | -0.054 | -0.056 | -0.029 |
| 2000-09-01 00:00:00 | 0.038  | 0.049  | 0.034  | 0.034  | 0.038  | 0.022  | 0.031  | 0.015  | 0.013  | 0.002  | -0.036 |
| 2000-10-01 00:00:00 | 0.056  | 0.069  | 0.063  | 0.063  | 0.063  | 0.069  | 0.042  | 0.046  | 0.053  | 0.059  | 0.004  |
| 2000-11-01 00:00:00 | 0.009  | 0.013  | 0.011  | 0.008  | -0.002 | 0.014  |  0.01  |  0.0   | -0.012 | -0.024 | -0.033 |
| 2000-12-01 00:00:00 |  0.0   | -0.008 | -0.018 | -0.007 | -0.01  | -0.014 | 0.001  | -0.007 | -0.008 | -0.019 | -0.019 |
| 2001-01-01 00:00:00 | -0.077 | -0.058 | -0.067 | -0.064 | -0.053 | -0.055 | -0.063 | -0.055 | -0.048 | -0.05  | 0.027  |
| 2001-02-01 00:00:00 | 0.096  | 0.072  | 0.085  | 0.074  | 0.088  | 0.079  | 0.075  | 0.061  | 0.065  | 0.056  | -0.04  |
| 2001-03-01 00:00:00 | 0.015  | 0.009  | -0.01  | -0.001 | -0.007 | -0.011 | 0.001  | -0.012 | -0.009 | -0.017 | -0.032 |
| 2001-04-01 00:00:00 | 0.073  | 0.045  | 0.051  | 0.049  | 0.038  |  0.03  | 0.039  | 0.029  | 0.016  |  0.01  | -0.063 |
| 2001-05-01 00:00:00 | 0.018  |  0.01  | 0.012  | 0.012  | 0.019  | 0.002  | -0.005 | 0.015  | -0.01  | -0.002 | -0.02  |
| 2001-06-01 00:00:00 | -0.138 | -0.138 | -0.129 | -0.134 | -0.141 | -0.149 | -0.123 | -0.131 | -0.13  | -0.13  | 0.009  |
| 2001-07-01 00:00:00 | -0.031 | -0.035 | -0.034 | -0.039 | -0.038 | -0.041 | -0.04  | -0.03  | -0.034 | -0.049 | -0.018 |
| 2001-08-01 00:00:00 | -0.055 | -0.067 | -0.048 | -0.067 | -0.048 | -0.047 | -0.046 | -0.047 | -0.05  | -0.022 | 0.033  |
| 2001-09-01 00:00:00 | -0.062 | -0.054 | -0.052 | -0.057 | -0.056 | -0.066 | -0.053 | -0.046 | -0.053 | -0.028 | 0.034  |
| 2001-10-01 00:00:00 | 0.057  | 0.057  | 0.042  | 0.054  | 0.046  | 0.039  | 0.041  | 0.034  | 0.039  | 0.021  | -0.035 |
| 2001-11-01 00:00:00 | -0.067 | -0.082 | -0.069 | -0.078 | -0.067 | -0.063 | -0.067 | -0.058 | -0.05  | -0.047 | 0.021  |
| 2001-12-01 00:00:00 | -0.141 | -0.14  | -0.119 | -0.121 | -0.117 | -0.116 | -0.108 |  -0.1  | -0.087 | -0.062 | 0.079  |
| 2002-01-01 00:00:00 | 0.035  | 0.044  | 0.043  | 0.036  |  0.03  | 0.032  | 0.028  | 0.025  | 0.016  | 0.011  | -0.024 |
| 2002-02-01 00:00:00 | 0.097  |  0.08  | 0.076  | 0.078  | 0.069  | 0.076  | 0.076  | 0.056  | 0.061  | 0.032  | -0.065 |
| 2002-03-01 00:00:00 | 0.057  | 0.059  | 0.048  | 0.037  | 0.053  | 0.042  | 0.028  | 0.037  | 0.031  | 0.033  | -0.025 |
| 2002-04-01 00:00:00 | -0.095 | -0.089 | -0.095 | -0.093 | -0.092 | -0.095 | -0.09  | -0.089 | -0.092 | -0.075 |  0.02  |
| 2002-05-01 00:00:00 | 0.116  | 0.115  |  0.11  | 0.113  | 0.122  | 0.114  | 0.142  | 0.123  | 0.152  | 0.158  | 0.042  |
| 2002-06-01 00:00:00 | -0.036 | -0.034 | -0.03  | -0.034 | -0.041 | -0.04  | -0.04  | -0.049 | -0.041 | -0.045 | -0.009 |
| 2002-07-01 00:00:00 | 0.011  | 0.004  | 0.005  |  -0.0  | 0.009  | 0.008  | 0.007  | 0.011  | -0.003 | 0.005  | -0.006 |
| 2002-08-01 00:00:00 | -0.058 | -0.056 | -0.065 | -0.059 | -0.057 | -0.059 | -0.054 | -0.046 | -0.05  | -0.047 | 0.011  |
| 2002-09-01 00:00:00 | -0.073 | -0.06  | -0.059 | -0.053 | -0.049 | -0.057 | -0.045 | -0.045 | -0.049 | -0.044 | 0.028  |
| 2002-10-01 00:00:00 | -0.084 | -0.093 | -0.087 | -0.079 | -0.071 | -0.076 | -0.077 | -0.053 | -0.046 | -0.033 | 0.052  |
| 2002-11-01 00:00:00 | -0.059 | -0.055 | -0.056 | -0.058 | -0.051 | -0.062 | -0.05  | -0.05  | -0.05  | -0.045 | 0.013  |
| 2002-12-01 00:00:00 | 0.115  | 0.111  |  0.09  | 0.103  | 0.099  | 0.085  | 0.076  | 0.078  | 0.078  | 0.095  | -0.02  |
| 2003-01-01 00:00:00 | 0.015  | 0.012  | 0.019  |  0.01  |  0.01  | 0.012  | 0.014  | 0.012  | 0.004  | 0.006  | -0.009 |
| 2003-02-01 00:00:00 | -0.03  | -0.037 | -0.032 | -0.031 | -0.023 | -0.026 | -0.022 | -0.009 |  -0.0  | 0.013  | 0.043  |
| 2003-03-01 00:00:00 | -0.07  | -0.041 | -0.05  | -0.048 | -0.037 | -0.02  | -0.023 | 0.002  | 0.002  | 0.033  | 0.104  |
| 2003-04-01 00:00:00 | 0.028  | 0.041  | 0.027  | 0.038  | 0.042  | 0.034  | 0.057  | 0.047  | 0.054  | 0.058  |  0.03  |
| 2003-05-01 00:00:00 | -0.067 | -0.063 | -0.074 | -0.07  | -0.079 | -0.072 | -0.082 | -0.056 | -0.06  | -0.065 | 0.002  |
| 2003-06-01 00:00:00 | -0.036 | -0.044 | -0.037 | -0.031 | -0.043 | -0.023 | -0.022 | -0.015 | 0.006  | 0.016  | 0.052  |
| 2003-07-01 00:00:00 | -0.02  | -0.016 | -0.027 | -0.041 | -0.029 | -0.037 | -0.032 | -0.025 | -0.029 | -0.043 | -0.022 |
| 2003-08-01 00:00:00 | -0.044 | -0.043 | -0.056 | -0.035 | -0.034 | -0.037 | -0.045 | -0.049 | -0.041 | -0.039 | 0.006  |
| 2003-09-01 00:00:00 | -0.081 | -0.077 | -0.073 | -0.066 | -0.062 | -0.064 | -0.042 | -0.032 | -0.023 | 0.011  | 0.092  |
| 2003-10-01 00:00:00 | 0.008  | 0.022  | 0.026  | 0.035  | 0.033  | 0.015  | 0.026  | 0.018  | 0.014  |  0.03  | 0.022  |
| 2003-11-01 00:00:00 | -0.019 | -0.021 | -0.028 | -0.016 |  0.01  | 0.013  | 0.022  | 0.022  | 0.035  | 0.088  | 0.106  |
| 2003-12-01 00:00:00 | 0.091  | 0.103  | 0.097  | 0.099  | 0.084  | 0.081  | 0.067  | 0.067  | 0.075  | 0.047  | -0.044 |
| 2004-01-01 00:00:00 | 0.122  | 0.097  | 0.083  | 0.093  |  0.11  | 0.081  | 0.077  | 0.074  | 0.071  | 0.051  | -0.072 |
| 2004-02-01 00:00:00 | 0.042  | 0.046  | 0.035  | 0.052  | 0.052  | 0.029  | 0.036  | 0.033  | 0.028  | 0.028  | -0.014 |
| 2004-03-01 00:00:00 | -0.103 | -0.086 |  -0.1  |  -0.1  | -0.091 | -0.093 | -0.083 | -0.101 | -0.086 | -0.116 | -0.013 |
| 2004-04-01 00:00:00 | -0.029 | -0.017 | -0.009 | -0.025 | -0.014 | -0.03  | -0.019 | -0.026 | -0.035 | -0.024 | 0.005  |
| 2004-05-01 00:00:00 | -0.128 | -0.131 | -0.135 | -0.134 | -0.132 | -0.126 | -0.114 | -0.124 | -0.111 | -0.085 | 0.043  |
| 2004-06-01 00:00:00 | -0.026 | -0.034 | -0.022 | -0.022 | 0.004  | 0.007  |  0.01  | 0.005  | 0.021  | 0.003  | 0.028  |
| 2004-07-01 00:00:00 | -0.049 | -0.046 | -0.052 | -0.057 | -0.058 | -0.059 | -0.062 | -0.066 | -0.042 | -0.036 | 0.013  |
| 2004-08-01 00:00:00 | 0.061  | 0.043  | 0.053  | 0.045  | 0.053  | 0.064  | 0.057  | 0.062  | 0.056  | 0.062  | 0.001  |
| 2004-09-01 00:00:00 | -0.075 | -0.053 | -0.076 | -0.048 | -0.057 | -0.066 | -0.061 | -0.03  | -0.018 | -0.053 | 0.022  |
| 2004-10-01 00:00:00 | 0.059  |  0.05  |  0.04  | 0.041  | 0.049  | 0.046  | 0.032  | 0.025  | 0.002  | -0.005 | -0.064 |
| 2004-11-01 00:00:00 | -0.078 | -0.08  | -0.086 | -0.079 | -0.09  | -0.093 | -0.077 | -0.066 | -0.076 | -0.048 |  0.03  |
| 2004-12-01 00:00:00 | -0.076 | -0.073 | -0.084 | -0.079 | -0.079 | -0.08  | -0.078 | -0.078 | -0.069 | -0.047 | 0.029  |
| 2005-01-01 00:00:00 | 0.112  |  0.11  | 0.107  | 0.102  | 0.116  | 0.115  | 0.117  | 0.095  | 0.093  | 0.093  | -0.019 |
| 2005-02-01 00:00:00 | -0.147 | -0.137 | -0.138 | -0.133 | -0.117 | -0.121 | -0.112 | -0.121 | -0.088 | -0.086 |  0.06  |
| 2005-03-01 00:00:00 | -0.107 | -0.076 | -0.084 | -0.049 | -0.067 | -0.05  | -0.041 | -0.037 | -0.008 | 0.012  | 0.119  |
| 2005-04-01 00:00:00 | -0.015 | -0.024 | -0.026 | -0.033 | -0.04  | -0.054 | -0.059 | -0.079 | -0.077 |  -0.1  | -0.085 |
| 2005-05-01 00:00:00 | -0.001 | 0.001  | -0.001 | -0.003 | 0.003  | -0.011 | -0.004 | 0.011  | -0.005 | 0.037  | 0.038  |
| 2005-06-01 00:00:00 | -0.083 | -0.07  | -0.079 | -0.07  | -0.058 | -0.063 | -0.053 | -0.036 | -0.012 | 0.015  | 0.097  |
| 2005-07-01 00:00:00 | 0.169  | 0.184  | 0.163  | 0.159  | 0.131  | 0.132  | 0.127  | 0.139  | 0.073  | 0.048  | -0.121 |
| 2005-08-01 00:00:00 |  0.02  | 0.008  | 0.007  | 0.025  | 0.028  | 0.024  | 0.035  | 0.036  | 0.016  | -0.013 | -0.034 |
| 2005-09-01 00:00:00 | -0.071 | -0.05  | -0.067 | -0.043 | -0.062 | -0.055 | -0.056 | -0.042 | -0.057 | -0.053 | 0.019  |
| 2005-10-01 00:00:00 | 0.018  |  0.01  | 0.019  | 0.005  | 0.016  | 0.016  | -0.014 | -0.014 | -0.019 | -0.004 | -0.022 |
| 2005-11-01 00:00:00 | 0.016  |  0.01  | 0.018  | 0.022  | 0.033  | 0.043  | 0.047  | 0.067  | 0.062  | 0.079  | 0.063  |
| 2005-12-01 00:00:00 | 0.098  | 0.067  |  0.09  | 0.088  | 0.094  | 0.119  | 0.141  |  0.12  |  0.13  | 0.088  | -0.01  |
| 2006-01-01 00:00:00 | 0.034  | 0.026  | 0.023  | 0.019  | 0.021  | 0.017  | 0.017  | -0.007 | 0.022  | 0.046  | 0.012  |
| 2006-02-01 00:00:00 | -0.002 | 0.001  | 0.006  | 0.008  | 0.022  | 0.025  | 0.042  | 0.048  | 0.048  | 0.025  | 0.027  |
| 2006-03-01 00:00:00 | 0.093  | 0.106  | 0.101  | 0.089  | 0.122  | 0.118  | 0.133  | 0.145  |  0.16  | 0.127  | 0.034  |
| 2006-04-01 00:00:00 | 0.297  | 0.251  | 0.284  | 0.265  | 0.261  | 0.222  | 0.266  | 0.201  | 0.208  | 0.156  | -0.141 |
| 2006-05-01 00:00:00 | 0.065  | 0.091  | 0.067  | 0.052  | 0.058  |  0.04  | 0.048  | 0.045  | 0.013  |  0.02  | -0.045 |
| 2006-06-01 00:00:00 | -0.002 | -0.038 | -0.039 | -0.022 | -0.043 | -0.043 | -0.051 | -0.059 | -0.056 | -0.088 | -0.086 |
| 2006-07-01 00:00:00 | 0.029  | 0.016  | 0.042  | 0.028  | 0.042  | 0.029  | 0.057  | 0.031  |  0.04  | 0.024  | -0.005 |
| 2006-08-01 00:00:00 | 0.049  | 0.056  | 0.049  | 0.039  | 0.038  | 0.052  | 0.026  | 0.042  | 0.041  | 0.044  | -0.005 |
| 2006-09-01 00:00:00 | -0.011 |  0.01  | 0.016  | -0.013 | -0.029 | 0.004  | -0.01  | 0.029  | 0.014  | 0.034  | 0.045  |
| 2006-10-01 00:00:00 | 0.014  | 0.024  | 0.034  | 0.038  | 0.058  | 0.055  | 0.063  | 0.079  | 0.139  | 0.183  | 0.169  |
| 2006-11-01 00:00:00 | 0.055  | 0.032  | 0.036  | 0.043  | 0.072  | 0.061  | 0.088  | 0.097  | 0.099  |  0.17  | 0.115  |
| 2006-12-01 00:00:00 | 0.296  | 0.254  | 0.262  | 0.251  | 0.233  | 0.239  | 0.232  | 0.209  | 0.254  | 0.173  | -0.122 |
| 2007-01-01 00:00:00 | 0.254  | 0.179  | 0.218  | 0.187  |  0.26  | 0.177  | 0.139  | 0.162  | 0.128  | 0.066  | -0.188 |
| 2007-02-01 00:00:00 | 0.196  | 0.203  | 0.179  | 0.163  | 0.171  | 0.175  | 0.142  | 0.103  | 0.072  |  0.09  | -0.107 |
| 2007-03-01 00:00:00 | 0.389  |  0.32  | 0.358  | 0.298  | 0.342  | 0.341  | 0.329  | 0.362  | 0.337  | 0.262  | -0.127 |
| 2007-04-01 00:00:00 | 0.067  | 0.093  | 0.064  | 0.065  | 0.178  | 0.113  | 0.081  | 0.092  | 0.143  | 0.118  | 0.051  |
| 2007-05-01 00:00:00 | -0.205 | -0.205 | -0.177 | -0.162 | -0.144 | -0.171 | -0.121 | -0.109 | -0.064 | -0.028 | 0.176  |
| 2007-06-01 00:00:00 | 0.235  |  0.26  | 0.231  | 0.228  | 0.216  |  0.2   | 0.192  | 0.196  | 0.182  | 0.186  | -0.049 |
| 2007-07-01 00:00:00 | 0.093  | 0.095  | 0.108  | 0.086  | 0.133  | 0.093  | 0.108  | 0.131  | 0.161  | 0.183  |  0.09  |
| 2007-08-01 00:00:00 | 0.025  | 0.015  | 0.043  | 0.059  |  0.03  | 0.046  | 0.018  | 0.038  | 0.082  | 0.073  | 0.048  |
| 2007-09-01 00:00:00 | -0.113 | -0.135 | -0.115 | -0.099 | -0.099 | -0.115 | -0.093 | -0.091 | -0.072 | 0.016  | 0.129  |
| 2007-10-01 00:00:00 | -0.038 | -0.058 | -0.05  | -0.084 | -0.048 | -0.112 | -0.091 | -0.13  | -0.163 | -0.184 | -0.147 |
| 2007-11-01 00:00:00 | 0.207  | 0.201  | 0.219  | 0.213  | 0.218  | 0.209  |  0.23  | 0.192  | 0.192  | 0.135  | -0.073 |
| 2007-12-01 00:00:00 | -0.061 | -0.058 | -0.075 | -0.052 | -0.058 | -0.06  | -0.065 | -0.078 | -0.079 | -0.141 | -0.081 |
| 2008-01-01 00:00:00 |  0.11  | 0.096  |  0.1   | 0.089  | 0.083  | 0.068  | 0.063  |  0.05  |  0.03  | 0.012  | -0.097 |
| 2008-02-01 00:00:00 | -0.188 | -0.189 | -0.196 | -0.202 | -0.204 | -0.199 | -0.214 | -0.211 | -0.233 | -0.212 | -0.023 |
| 2008-03-01 00:00:00 | -0.061 | -0.091 | -0.055 | -0.055 | -0.048 | -0.038 | -0.013 | 0.003  |  0.03  | 0.057  | 0.118  |
| 2008-04-01 00:00:00 | 0.002  | -0.017 | -0.03  | -0.039 | -0.035 | -0.039 | -0.053 | -0.045 | -0.054 | -0.089 | -0.091 |
| 2008-05-01 00:00:00 | -0.275 | -0.261 | -0.249 | -0.262 | -0.252 | -0.239 | -0.247 | -0.242 | -0.227 | -0.215 |  0.06  |
| 2008-06-01 00:00:00 | 0.114  | 0.102  | 0.107  | 0.105  | 0.081  | 0.074  |  0.08  |  0.05  | 0.044  | -0.005 | -0.119 |
| 2008-07-01 00:00:00 | -0.244 | -0.214 | -0.223 | -0.248 | -0.229 | -0.235 | -0.253 | -0.226 | -0.239 | -0.169 | 0.075  |
| 2008-08-01 00:00:00 | -0.101 | -0.085 | -0.112 | -0.075 | -0.082 | -0.084 | -0.064 | -0.046 | -0.041 | -0.016 | 0.085  |
| 2008-09-01 00:00:00 | -0.261 | -0.263 | -0.251 | -0.261 | -0.271 | -0.265 | -0.26  | -0.273 | -0.261 | -0.257 | 0.003  |
| 2008-10-01 00:00:00 | 0.233  | 0.211  | 0.233  | 0.211  | 0.202  | 0.175  | 0.162  | 0.166  |  0.15  |  0.12  | -0.112 |
| 2008-11-01 00:00:00 | 0.116  | 0.053  | 0.073  | 0.073  | 0.043  | 0.054  | 0.064  | 0.052  | 0.041  | -0.002 | -0.118 |
| 2008-12-01 00:00:00 | 0.157  | 0.155  | 0.167  | 0.186  |  0.17  | 0.175  | 0.167  | 0.161  | 0.147  | 0.104  | -0.053 |
| 2009-01-01 00:00:00 | 0.091  | 0.081  | 0.091  | 0.093  | 0.073  | 0.084  | 0.077  | 0.064  |  0.06  |  0.06  | -0.031 |
| 2009-02-01 00:00:00 | 0.244  | 0.249  | 0.213  | 0.229  | 0.205  | 0.217  | 0.209  | 0.187  | 0.213  | 0.178  | -0.066 |
| 2009-03-01 00:00:00 |  0.07  | 0.076  | 0.085  | 0.074  | 0.049  | 0.039  | 0.078  | 0.025  | 0.065  | 0.046  | -0.025 |
| 2009-04-01 00:00:00 | 0.078  | 0.071  | 0.085  | 0.075  | 0.045  | 0.054  | 0.051  | 0.038  | 0.062  | 0.046  | -0.031 |
| 2009-05-01 00:00:00 | 0.038  | 0.035  | 0.049  | 0.052  | 0.037  | 0.052  | 0.049  | 0.081  | 0.072  | 0.145  | 0.107  |
| 2009-06-01 00:00:00 | 0.138  | 0.163  |  0.12  | 0.155  | 0.136  |  0.13  | 0.166  | 0.167  | 0.179  | 0.195  | 0.057  |
| 2009-07-01 00:00:00 | -0.155 | -0.136 | -0.135 | -0.147 | -0.146 | -0.168 | -0.171 | -0.177 | -0.194 | -0.245 | -0.09  |
| 2009-08-01 00:00:00 | 0.022  | 0.022  | 0.049  |  0.02  | 0.032  | 0.035  | 0.036  | 0.046  | 0.045  | 0.049  | 0.028  |
| 2009-09-01 00:00:00 | 0.125  | 0.117  | 0.133  | 0.126  | 0.133  | 0.115  | 0.108  |  0.11  | 0.107  | 0.085  | -0.039 |
| 2009-10-01 00:00:00 |  0.16  | 0.155  | 0.174  | 0.175  | 0.151  | 0.147  | 0.142  | 0.112  | 0.103  | 0.078  | -0.082 |
| 2009-11-01 00:00:00 | 0.038  | 0.027  |  0.03  | 0.029  | 0.024  | 0.001  | 0.005  | -0.001 | -0.006 | 0.008  | -0.03  |
| 2009-12-01 00:00:00 | -0.02  | -0.026 | -0.024 | -0.042 | -0.012 | -0.019 | -0.038 | -0.04  | -0.075 | -0.103 | -0.084 |
| 2010-01-01 00:00:00 | 0.068  | 0.062  | 0.059  | 0.073  | 0.055  | 0.057  | 0.058  | 0.047  | 0.039  | 0.021  | -0.048 |
| 2010-02-01 00:00:00 | 0.055  | 0.037  | 0.043  | 0.043  | 0.053  | 0.043  | 0.009  |  0.01  | 0.016  | 0.015  | -0.04  |
| 2010-03-01 00:00:00 | -0.085 | -0.067 | -0.082 | -0.071 | -0.059 | -0.083 | -0.078 | -0.053 | -0.067 | -0.081 | 0.004  |
| 2010-04-01 00:00:00 | -0.088 | -0.092 | -0.095 | -0.075 | -0.067 | -0.079 | -0.072 | -0.071 | -0.081 | -0.094 | -0.006 |
| 2010-05-01 00:00:00 | -0.081 | -0.097 | -0.083 | -0.099 | -0.092 | -0.103 | -0.099 | -0.098 | -0.097 | -0.077 | 0.005  |
| 2010-06-01 00:00:00 | 0.147  | 0.149  | 0.151  |  0.17  | 0.148  | 0.142  | 0.132  | 0.133  | 0.135  | 0.131  | -0.016 |
| 2010-07-01 00:00:00 | 0.108  | 0.112  | 0.098  | 0.094  | 0.081  | 0.085  | 0.122  | 0.079  | 0.059  | 0.019  | -0.089 |
| 2010-08-01 00:00:00 | -0.004 | 0.009  | 0.012  | -0.004 | -0.016 | 0.008  | 0.013  | 0.015  | 0.019  | 0.017  | 0.021  |
| 2010-09-01 00:00:00 | 0.108  | 0.074  | 0.085  | 0.097  |  0.08  | 0.103  | 0.105  | 0.092  | 0.148  | 0.155  | 0.047  |
| 2010-10-01 00:00:00 | 0.036  | 0.021  | 0.002  | 0.015  |  0.01  | 0.019  |  0.02  | -0.001 | -0.035 | -0.066 | -0.102 |
| 2010-11-01 00:00:00 | -0.024 | -0.025 | -0.031 | -0.036 | -0.026 | -0.035 | -0.034 | -0.02  | -0.006 | 0.006  |  0.03  |
| 2010-12-01 00:00:00 | -0.058 | -0.061 | -0.059 | -0.05  | -0.074 | -0.064 | -0.068 | -0.067 | -0.051 | -0.018 |  0.04  |
| 2011-01-01 00:00:00 | 0.098  | 0.093  |  0.11  | 0.096  | 0.105  | 0.103  | 0.101  | 0.097  | 0.069  | 0.052  | -0.046 |
| 2011-02-01 00:00:00 | 0.004  | -0.018 | -0.023 | -0.017 | -0.026 | -0.038 | -0.023 | -0.027 | -0.033 | -0.02  | -0.024 |
| 2011-03-01 00:00:00 | -0.054 | -0.036 | -0.052 | -0.05  | -0.027 | -0.035 | -0.039 | -0.039 | -0.02  | -0.022 | 0.032  |
| 2011-04-01 00:00:00 | -0.081 | -0.067 | -0.055 | -0.083 | -0.082 | -0.076 | -0.084 | -0.085 | -0.077 | -0.066 | 0.016  |
| 2011-05-01 00:00:00 | 0.034  | 0.031  | 0.042  | 0.023  | 0.041  | 0.032  | 0.031  | 0.036  |  0.03  |  0.03  | -0.004 |
| 2011-06-01 00:00:00 | 0.033  | 0.026  | 0.038  | 0.021  | 0.017  | 0.022  | 0.024  | 0.016  |  -0.0  | -0.017 | -0.05  |
| 2011-07-01 00:00:00 | -0.017 | -0.032 | -0.026 | -0.032 | -0.036 | -0.034 | -0.034 | -0.047 | -0.041 | -0.054 | -0.036 |
| 2011-08-01 00:00:00 | -0.123 | -0.115 | -0.124 | -0.131 | -0.136 | -0.128 | -0.141 | -0.125 | -0.111 | -0.093 | 0.029  |
| 2011-09-01 00:00:00 | 0.041  | 0.045  | 0.046  | 0.041  | 0.047  | 0.026  | 0.052  | 0.045  | 0.036  | 0.034  | -0.006 |
| 2011-10-01 00:00:00 | -0.045 | -0.038 | -0.029 | -0.04  | -0.041 | -0.042 | -0.045 | -0.049 | -0.056 | -0.069 | -0.024 |
| 2011-11-01 00:00:00 | -0.17  | -0.17  | -0.174 | -0.151 | -0.164 | -0.159 | -0.137 | -0.13  | -0.102 | -0.082 | 0.087  |
| 2011-12-01 00:00:00 | -0.016 | -0.018 | -0.006 | -0.018 | -0.018 | 0.003  | -0.013 |  -0.0  | -0.002 | 0.045  | 0.062  |
| 2012-01-01 00:00:00 | 0.143  | 0.138  | 0.135  | 0.136  | 0.129  | 0.128  | 0.131  | 0.119  | 0.109  | 0.072  | -0.071 |
| 2012-02-01 00:00:00 | -0.081 | -0.061 | -0.075 | -0.08  | -0.077 | -0.078 | -0.073 | -0.079 | -0.071 | -0.074 | 0.007  |
| 2012-03-01 00:00:00 | 0.088  | 0.069  | 0.064  | 0.073  |  0.07  | 0.064  | 0.063  | 0.053  | 0.063  | 0.072  | -0.016 |
| 2012-04-01 00:00:00 | 0.022  | 0.024  | 0.025  | 0.017  | 0.017  | 0.033  | 0.024  | 0.028  | 0.038  | 0.008  | -0.014 |
| 2012-05-01 00:00:00 | -0.06  | -0.06  | -0.061 | -0.073 | -0.067 | -0.066 | -0.071 | -0.071 | -0.058 | -0.057 | 0.003  |
| 2012-06-01 00:00:00 | -0.11  | -0.094 | -0.092 | -0.103 | -0.099 | -0.089 | -0.087 | -0.082 | -0.075 | -0.054 | 0.057  |
| 2012-07-01 00:00:00 | 0.042  | 0.045  | 0.033  | 0.026  | 0.033  |  0.0   |  0.01  | -0.022 | -0.034 | -0.056 | -0.098 |
| 2012-08-01 00:00:00 | 0.003  | 0.004  | 0.002  | -0.005 | 0.004  | 0.002  | 0.022  | 0.007  | 0.029  | 0.044  |  0.04  |
| 2012-09-01 00:00:00 | -0.004 | 0.002  | 0.008  |  -0.0  | -0.015 |  0.0   | -0.012 | -0.02  | -0.017 | -0.016 | -0.012 |
| 2012-10-01 00:00:00 | -0.119 | -0.121 | -0.125 | -0.113 | -0.124 | -0.113 | -0.123 | -0.103 | -0.097 | -0.059 |  0.06  |
| 2012-11-01 00:00:00 | 0.164  | 0.178  | 0.184  | 0.163  | 0.163  | 0.182  | 0.181  | 0.166  | 0.171  | 0.172  | 0.008  |
| 2012-12-01 00:00:00 |  0.07  | 0.072  | 0.066  | 0.069  | 0.065  | 0.054  | 0.065  | 0.061  | 0.049  | 0.057  | -0.013 |
| 2013-01-01 00:00:00 | 0.044  | 0.033  | 0.036  | 0.037  | 0.038  | 0.043  | 0.042  | 0.039  | 0.024  | -0.004 | -0.047 |
| 2013-02-01 00:00:00 | -0.032 | -0.024 | -0.031 | -0.027 | -0.047 | -0.041 | -0.047 | -0.057 | -0.04  | -0.05  | -0.018 |
| 2013-03-01 00:00:00 | -0.032 | -0.032 | -0.025 | -0.026 | -0.031 | -0.027 | -0.019 | -0.017 | -0.026 | -0.021 | 0.011  |
| 2013-04-01 00:00:00 | 0.158  | 0.154  | 0.147  | 0.142  | 0.152  | 0.156  |  0.15  | 0.125  | 0.125  | 0.067  | -0.091 |
| 2013-05-01 00:00:00 | -0.16  | -0.157 | -0.157 | -0.157 | -0.154 | -0.154 | -0.164 | -0.151 | -0.154 | -0.136 | 0.024  |
| 2013-06-01 00:00:00 | 0.073  | 0.084  | 0.079  | 0.069  | 0.054  |  0.07  | 0.073  | 0.045  | 0.062  | 0.014  | -0.058 |
| 2013-07-01 00:00:00 | 0.102  | 0.093  | 0.076  | 0.064  | 0.102  | 0.072  | 0.082  | 0.063  | 0.069  | 0.058  | -0.045 |
| 2013-08-01 00:00:00 | 0.053  | 0.064  | 0.046  | 0.045  | 0.048  | 0.061  | 0.043  | 0.051  |  0.07  | 0.047  | -0.006 |
| 2013-09-01 00:00:00 | -0.025 | -0.023 | -0.016 | -0.035 | -0.039 | -0.033 | -0.034 | -0.029 | -0.034 | -0.04  | -0.014 |
| 2013-10-01 00:00:00 | 0.092  | 0.095  | 0.083  | 0.083  | 0.084  | 0.083  | 0.055  | 0.063  | 0.052  | 0.039  | -0.054 |
| 2013-11-01 00:00:00 | -0.034 | -0.029 | -0.038 | -0.032 | -0.045 | -0.027 | -0.028 | -0.047 | -0.033 | -0.046 | -0.012 |
| 2013-12-01 00:00:00 | 0.001  | 0.017  | 0.038  | 0.057  | 0.027  | 0.002  | 0.036  | 0.002  | 0.012  | -0.052 | -0.053 |
| 2014-01-01 00:00:00 | 0.047  | 0.042  | 0.044  | 0.044  | 0.045  | 0.015  | 0.023  | 0.016  | -0.003 | -0.021 | -0.068 |
| 2014-02-01 00:00:00 | -0.023 | -0.02  | -0.04  | -0.038 | -0.039 | -0.039 | -0.043 | -0.051 | -0.041 | -0.028 | -0.005 |
| 2014-03-01 00:00:00 | -0.009 | -0.027 | -0.031 | -0.028 | -0.026 | -0.012 | -0.018 | -0.026 | -0.009 | -0.005 | 0.005  |
| 2014-04-01 00:00:00 | 0.027  | 0.035  | 0.034  | 0.028  |  0.05  | 0.025  |  0.02  | 0.022  | 0.018  | 0.002  | -0.024 |
| 2014-05-01 00:00:00 | 0.064  | 0.059  | 0.046  | 0.054  | 0.055  | 0.031  | 0.037  | 0.038  | 0.026  | 0.019  | -0.045 |
| 2014-06-01 00:00:00 |  0.09  | 0.076  | 0.076  | 0.068  |  0.06  | 0.082  | 0.075  | 0.067  | 0.065  | 0.079  | -0.012 |
| 2014-07-01 00:00:00 | 0.065  |  0.06  |  0.06  | 0.054  | 0.044  | 0.057  | 0.038  | 0.053  | 0.041  | 0.004  | -0.061 |
| 2014-08-01 00:00:00 | 0.152  | 0.141  | 0.143  | 0.124  | 0.119  | 0.114  | 0.127  | 0.101  |  0.09  | 0.064  | -0.089 |
| 2014-09-01 00:00:00 | 0.044  | 0.018  | 0.014  | 0.017  | 0.014  | 0.013  | 0.014  | 0.004  | 0.015  | 0.029  | -0.015 |
| 2014-10-01 00:00:00 | 0.067  | 0.049  | 0.062  |  0.07  | 0.045  |  0.04  | 0.048  | 0.055  | 0.076  | 0.123  | 0.056  |
| 2014-11-01 00:00:00 | -0.08  | -0.069 | -0.055 | -0.049 | -0.046 | -0.022 | 0.002  | -0.004 | 0.074  | 0.246  | 0.327  |
| 2014-12-01 00:00:00 | 0.108  | 0.105  | 0.094  | 0.097  | 0.087  | 0.068  | 0.077  | 0.082  | 0.062  | -0.026 | -0.135 |
| 2015-01-01 00:00:00 | 0.078  | 0.077  |  0.09  | 0.087  | 0.094  | 0.099  | 0.088  | 0.104  | 0.073  | 0.052  | -0.026 |
| 2015-02-01 00:00:00 | 0.259  | 0.235  | 0.248  | 0.252  | 0.229  | 0.214  | 0.228  | 0.209  | 0.184  | 0.142  | -0.116 |
| 2015-03-01 00:00:00 | 0.213  | 0.168  |  0.14  | 0.166  | 0.162  | 0.168  | 0.155  | 0.153  | 0.154  | 0.203  | -0.01  |
| 2015-04-01 00:00:00 | 0.302  | 0.264  | 0.261  | 0.253  | 0.252  | 0.252  | 0.204  | 0.182  | 0.119  | 0.036  | -0.266 |
| 2015-05-01 00:00:00 | -0.114 | -0.147 | -0.155 | -0.158 | -0.149 | -0.145 | -0.119 | -0.144 | -0.133 | -0.079 | 0.035  |
| 2015-06-01 00:00:00 | -0.212 | -0.204 | -0.201 | -0.192 | -0.177 | -0.176 | -0.15  | -0.17  | -0.154 | -0.159 | 0.052  |
| 2015-07-01 00:00:00 | -0.151 | -0.156 | -0.145 | -0.149 | -0.161 | -0.136 | -0.177 | -0.177 | -0.15  | -0.133 | 0.018  |
| 2015-08-01 00:00:00 | 0.012  |  0.0   | -0.017 | -0.004 | -0.016 | -0.022 | -0.028 | -0.045 | -0.062 | -0.053 | -0.065 |
| 2015-09-01 00:00:00 | 0.257  | 0.252  |  0.26  | 0.243  | 0.206  | 0.236  | 0.222  |  0.21  | 0.186  | 0.123  | -0.134 |
| 2015-10-01 00:00:00 | 0.152  | 0.146  | 0.116  | 0.116  | 0.096  | 0.063  | 0.069  | 0.049  | 0.024  | 0.009  | -0.143 |
| 2015-11-01 00:00:00 |  0.07  | 0.065  | 0.038  |  0.03  | 0.049  | 0.026  | 0.034  | 0.018  | 0.024  | 0.032  | -0.038 |
| 2015-12-01 00:00:00 | -0.309 | -0.309 | -0.31  | -0.31  | -0.311 | -0.295 | -0.301 | -0.308 | -0.278 | -0.243 | 0.066  |
| 2016-01-01 00:00:00 | -0.012 | -0.031 | -0.023 | -0.032 | -0.028 | -0.021 | -0.021 | -0.025 | -0.013 | -0.025 | -0.013 |
| 2016-02-01 00:00:00 | 0.204  |  0.21  | 0.204  | 0.209  | 0.196  |  0.19  | 0.172  | 0.171  | 0.162  | 0.132  | -0.072 |
| 2016-03-01 00:00:00 | 0.002  | -0.007 | -0.012 | -0.034 | -0.013 | -0.019 | -0.035 | -0.032 | -0.032 | -0.036 | -0.038 |
| 2016-04-01 00:00:00 | -0.017 | -0.009 | -0.006 | -0.012 |  0.0   | 0.007  | 0.002  | -0.01  | -0.005 | 0.001  | 0.018  |
| 2016-05-01 00:00:00 | 0.077  | 0.092  | 0.074  | 0.082  | 0.051  | 0.058  | 0.051  | 0.033  |  0.02  |  0.01  | -0.067 |
| 2016-06-01 00:00:00 | -0.012 | -0.011 | -0.029 | -0.014 | -0.022 | -0.033 | -0.007 | -0.017 | 0.031  | 0.028  | 0.041  |
| 2016-07-01 00:00:00 | 0.064  | 0.052  | 0.043  | 0.035  | 0.034  | 0.045  | 0.037  | 0.035  | 0.033  | 0.031  | -0.033 |
| 2016-08-01 00:00:00 | -0.025 | -0.015 | -0.015 | -0.021 | -0.028 | -0.028 | -0.026 | -0.029 | -0.03  | -0.034 | -0.009 |
| 2016-09-01 00:00:00 |  0.04  | 0.038  |  0.05  | 0.046  | 0.037  | 0.023  | 0.026  | 0.026  | 0.018  | 0.024  | -0.016 |
| 2016-10-01 00:00:00 |  0.03  | 0.016  | 0.029  | 0.025  | 0.014  | 0.015  | 0.016  | 0.014  | 0.036  | 0.045  | 0.015  |
| 2016-11-01 00:00:00 | -0.057 | -0.059 | -0.065 | -0.076 | -0.059 | -0.07  | -0.067 | -0.061 | -0.062 | -0.063 | -0.006 |
| 2016-12-01 00:00:00 | -0.037 | -0.036 | -0.041 | -0.035 | -0.032 | -0.03  | -0.03  | -0.018 | -0.008 | 0.012  | 0.049  |
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |  Diff  |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| Average | 0.018 | 0.016 | 0.015 | 0.014 | 0.014 | 0.011 | 0.012 | 0.009 | 0.011 | 0.009 | -0.01  |
|  T-Test | 2.397 | 2.178 | 2.063 | 1.907 | 1.945 | 1.614 |  1.8  | 1.441 |  1.72 | 1.434 | -2.028 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
```

The third dataset excludes below 30% stocks from 2000-01-01 to 2016-12-01. The size effect is **significant** since the t-test statistics is -2.028 whose absolute value is more than 2 corresponding to the significance level at 0.05. The monthly excess return is **1.0%** and the annual excess return is about 12.0%. 

```python
# %% dataset 4
# select stocks whose trading days are more than or equal to 10 days
test_data_4 = month_return[month_return['Ndaytrd']>=10]
# construct data for univariate analysis
test_data_4 = test_data_4[['emrwd', 'Msmvttl', 'Time']].dropna()
# time interval between 2000-01-01 to 2016-12-01
test_data_4 = test_data_4[(test_data_4['Time'] >= '2000-01-01') & (test_data_4['Time'] <= '2016-12-01')]
# analysis
uni_4 = Univariate(np.array(test_data_4), number=9)
uni_4.average_by_time()
uni_4.summary_and_test()
uni_4.print_summary_by_time()
uni_4.print_summary()
==========================================================================================================================
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
|         Time        |   1    |   2    |   3    |   4    |   5    |   6    |   7    |   8    |   9    |   10   |  diff  |
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
| 2000-01-01 00:00:00 | 0.164  | 0.167  | 0.126  | 0.139  | 0.131  |  0.12  | 0.118  | 0.094  | 0.113  | 0.125  | -0.039 |
| 2000-02-01 00:00:00 | 0.208  | 0.203  | 0.128  | 0.151  | 0.085  | 0.113  | 0.052  | 0.053  | 0.044  | 0.002  | -0.206 |
| 2000-03-01 00:00:00 | 0.001  | 0.035  | 0.019  | 0.006  | 0.024  | 0.012  | -0.008 | 0.017  | 0.014  | 0.032  | 0.032  |
| 2000-04-01 00:00:00 | 0.056  |  0.06  | 0.052  | 0.038  | 0.047  | 0.034  | 0.028  | 0.039  | 0.025  | 0.021  | -0.035 |
| 2000-05-01 00:00:00 | 0.019  | 0.021  | 0.032  |  0.02  | 0.044  | 0.019  | 0.024  | 0.014  | 0.031  | 0.034  | 0.015  |
| 2000-06-01 00:00:00 | 0.108  | 0.057  | 0.056  | 0.062  | 0.047  | 0.047  |  0.05  | 0.029  | 0.035  | 0.041  | -0.067 |
| 2000-07-01 00:00:00 | 0.053  | 0.039  | 0.023  | 0.009  | -0.001 | -0.002 | -0.006 | -0.015 | -0.007 | -0.021 | -0.074 |
| 2000-08-01 00:00:00 | 0.016  | -0.027 | -0.033 | -0.022 | -0.038 | -0.053 | -0.059 | -0.045 | -0.059 | -0.056 | -0.072 |
| 2000-09-01 00:00:00 | 0.065  | 0.058  | 0.049  | 0.048  | 0.034  | 0.035  | 0.026  | 0.029  | 0.014  | 0.007  | -0.057 |
| 2000-10-01 00:00:00 | 0.073  | 0.063  | 0.064  | 0.059  | 0.066  | 0.064  | 0.062  | 0.053  | 0.051  | 0.054  | -0.019 |
| 2000-11-01 00:00:00 | -0.002 | 0.028  | 0.025  | 0.008  | 0.014  | 0.005  | 0.006  | 0.011  | -0.003 | -0.024 | -0.023 |
| 2000-12-01 00:00:00 | -0.024 | -0.019 | -0.012 | -0.006 | -0.012 | -0.006 | -0.014 | -0.003 | -0.003 | -0.02  | 0.003  |
| 2001-01-01 00:00:00 | -0.098 | -0.062 | -0.067 | -0.072 | -0.062 | -0.062 | -0.052 | -0.064 | -0.051 | -0.049 |  0.05  |
| 2001-02-01 00:00:00 | 0.114  | 0.103  | 0.088  | 0.088  | 0.079  | 0.084  | 0.079  | 0.076  | 0.062  | 0.058  | -0.056 |
| 2001-03-01 00:00:00 |  0.04  | 0.019  | 0.001  | 0.012  | -0.005 | -0.003 | -0.009 | 0.002  | -0.014 | -0.015 | -0.055 |
| 2001-04-01 00:00:00 | 0.096  | 0.087  | 0.084  | 0.066  | 0.047  | 0.048  | 0.031  | 0.036  | 0.025  | 0.012  | -0.084 |
| 2001-05-01 00:00:00 | 0.016  | 0.007  | 0.017  | 0.016  |  0.01  | 0.013  | 0.011  | -0.001 | 0.005  | -0.006 | -0.022 |
| 2001-06-01 00:00:00 | -0.133 | -0.143 | -0.135 | -0.135 | -0.133 | -0.138 | -0.143 | -0.129 | -0.127 | -0.134 | -0.002 |
| 2001-07-01 00:00:00 | -0.001 | -0.013 | -0.021 | -0.03  | -0.037 | -0.037 | -0.041 | -0.04  | -0.032 | -0.043 | -0.042 |
| 2001-08-01 00:00:00 | -0.087 | -0.059 | -0.069 | -0.065 | -0.053 | -0.062 | -0.048 | -0.043 | -0.047 | -0.032 | 0.055  |
| 2001-09-01 00:00:00 | -0.057 | -0.064 | -0.059 | -0.058 | -0.056 | -0.057 | -0.065 | -0.046 | -0.056 | -0.033 | 0.024  |
| 2001-10-01 00:00:00 | 0.079  | 0.066  | 0.064  | 0.057  | 0.048  | 0.051  | 0.039  | 0.042  | 0.035  | 0.027  | -0.052 |
| 2001-11-01 00:00:00 | -0.09  | -0.083 | -0.077 | -0.073 | -0.072 | -0.075 | -0.064 | -0.067 | -0.054 | -0.047 | 0.044  |
| 2001-12-01 00:00:00 | -0.166 | -0.135 | -0.149 | -0.142 | -0.126 | -0.123 | -0.115 | -0.109 | -0.095 | -0.067 | 0.099  |
| 2002-01-01 00:00:00 | 0.095  | 0.052  | 0.041  | 0.038  | 0.044  | 0.036  | 0.029  |  0.03  | 0.018  | 0.014  | -0.081 |
| 2002-02-01 00:00:00 | 0.102  | 0.099  |  0.09  | 0.089  | 0.081  | 0.075  | 0.072  | 0.073  | 0.062  | 0.037  | -0.065 |
| 2002-03-01 00:00:00 | 0.081  | 0.067  | 0.054  | 0.057  | 0.055  | 0.041  | 0.045  | 0.032  | 0.037  | 0.031  | -0.049 |
| 2002-04-01 00:00:00 | -0.077 | -0.083 | -0.082 | -0.092 | -0.094 | -0.092 | -0.092 | -0.089 | -0.091 | -0.081 | -0.004 |
| 2002-05-01 00:00:00 | 0.091  | 0.091  | 0.106  | 0.113  | 0.114  | 0.116  | 0.118  | 0.136  | 0.133  | 0.156  | 0.065  |
| 2002-06-01 00:00:00 | -0.026 | -0.032 | -0.034 | -0.033 | -0.034 | -0.036 | -0.043 | -0.04  | -0.047 | -0.042 | -0.016 |
| 2002-07-01 00:00:00 | 0.023  | 0.014  | 0.011  |  0.01  | 0.001  | 0.003  | 0.008  | 0.009  | 0.003  | 0.004  | -0.019 |
| 2002-08-01 00:00:00 | -0.063 | -0.06  | -0.055 | -0.059 | -0.06  | -0.062 | -0.057 | -0.053 | -0.047 | -0.049 | 0.014  |
| 2002-09-01 00:00:00 | -0.051 | -0.071 | -0.06  | -0.074 | -0.057 | -0.047 | -0.054 | -0.05  | -0.044 | -0.048 | 0.004  |
| 2002-10-01 00:00:00 | -0.097 | -0.091 | -0.09  | -0.089 | -0.085 | -0.08  | -0.073 | -0.076 | -0.05  | -0.038 | 0.059  |
| 2002-11-01 00:00:00 | -0.029 | -0.053 | -0.052 | -0.056 | -0.056 | -0.054 | -0.057 | -0.054 | -0.05  | -0.047 | -0.018 |
| 2002-12-01 00:00:00 | 0.134  | 0.123  | 0.113  | 0.114  | 0.098  | 0.101  | 0.092  |  0.08  | 0.075  |  0.09  | -0.044 |
| 2003-01-01 00:00:00 | 0.018  | 0.022  | 0.023  | 0.015  | 0.016  |  0.01  | 0.013  | 0.013  | 0.009  | 0.005  | -0.013 |
| 2003-02-01 00:00:00 | -0.042 | -0.031 | -0.042 | -0.034 | -0.033 | -0.033 | -0.021 | -0.022 | -0.007 |  0.01  | 0.052  |
| 2003-03-01 00:00:00 | -0.094 | -0.067 | -0.081 | -0.067 | -0.038 | -0.051 | -0.035 | -0.011 | 0.005  | 0.021  | 0.115  |
| 2003-04-01 00:00:00 | 0.037  | 0.039  | 0.028  | 0.032  | 0.034  | 0.037  | 0.038  | 0.049  | 0.054  | 0.055  | 0.018  |
| 2003-05-01 00:00:00 | -0.055 | -0.061 | -0.068 | -0.066 | -0.07  | -0.072 | -0.075 | -0.079 | -0.057 | -0.065 | -0.01  |
| 2003-06-01 00:00:00 | -0.05  | -0.049 | -0.041 | -0.039 | -0.037 | -0.036 | -0.03  | -0.023 | -0.007 | 0.013  | 0.063  |
| 2003-07-01 00:00:00 | -0.001 | -0.014 | -0.016 | -0.017 | -0.023 | -0.037 | -0.034 | -0.033 | -0.021 | -0.043 | -0.042 |
| 2003-08-01 00:00:00 | -0.054 | -0.056 | -0.053 | -0.043 | -0.051 | -0.037 | -0.035 | -0.046 | -0.047 | -0.037 | 0.017  |
| 2003-09-01 00:00:00 | -0.114 | -0.096 | -0.086 | -0.08  | -0.075 | -0.065 | -0.066 | -0.044 | -0.028 | 0.003  | 0.117  |
| 2003-10-01 00:00:00 | 0.002  | 0.003  | 0.009  | 0.012  | 0.024  | 0.029  | 0.028  | 0.026  | 0.014  | 0.024  | 0.022  |
| 2003-11-01 00:00:00 | -0.069 | -0.038 | -0.033 | -0.016 | -0.034 | -0.006 | 0.004  | 0.025  | 0.032  |  0.07  | 0.138  |
| 2003-12-01 00:00:00 | 0.111  | 0.105  | 0.102  | 0.096  | 0.099  | 0.097  | 0.084  | 0.068  | 0.073  | 0.052  | -0.058 |
| 2004-01-01 00:00:00 | 0.145  | 0.125  | 0.102  |  0.12  |  0.08  | 0.104  | 0.091  | 0.076  | 0.074  | 0.056  | -0.089 |
| 2004-02-01 00:00:00 | 0.048  | 0.055  | 0.054  | 0.044  | 0.035  | 0.055  | 0.038  | 0.033  | 0.034  | 0.026  | -0.022 |
| 2004-03-01 00:00:00 | -0.115 | -0.124 | -0.105 | -0.098 | -0.093 | -0.098 | -0.095 | -0.084 | -0.096 | -0.107 | 0.008  |
| 2004-04-01 00:00:00 | 0.017  | -0.013 | -0.009 | -0.03  | -0.003 | -0.025 | -0.021 | -0.025 | -0.023 | -0.033 | -0.049 |
| 2004-05-01 00:00:00 | -0.139 | -0.132 | -0.13  | -0.128 | -0.134 | -0.132 | -0.13  | -0.116 | -0.122 | -0.091 | 0.048  |
| 2004-06-01 00:00:00 | -0.072 | -0.059 | -0.054 | -0.025 | -0.027 | -0.023 |  0.01  | 0.005  | 0.014  | 0.008  |  0.08  |
| 2004-07-01 00:00:00 | -0.066 | -0.061 | -0.053 | -0.05  | -0.047 | -0.055 | -0.061 | -0.064 | -0.061 | -0.032 | 0.034  |
| 2004-08-01 00:00:00 | 0.031  | 0.051  | 0.053  | 0.056  | 0.048  | 0.051  | 0.056  | 0.057  |  0.06  | 0.059  | 0.028  |
| 2004-09-01 00:00:00 | -0.129 | -0.091 | -0.081 | -0.067 | -0.066 | -0.053 | -0.064 | -0.058 | -0.028 | -0.04  | 0.089  |
| 2004-10-01 00:00:00 | 0.109  | 0.063  |  0.06  | 0.056  | 0.047  | 0.048  | 0.037  | 0.041  |  0.01  | -0.001 | -0.11  |
| 2004-11-01 00:00:00 | -0.089 | -0.092 | -0.093 | -0.077 | -0.086 | -0.08  | -0.091 | -0.08  | -0.07  | -0.056 | 0.033  |
| 2004-12-01 00:00:00 | -0.045 | -0.062 | -0.084 | -0.077 | -0.081 | -0.075 | -0.084 | -0.076 | -0.078 | -0.052 | -0.006 |
| 2005-01-01 00:00:00 | 0.114  | 0.105  | 0.112  | 0.113  | 0.109  | 0.102  | 0.118  | 0.115  | 0.094  | 0.092  | -0.022 |
| 2005-02-01 00:00:00 | -0.137 | -0.14  | -0.132 | -0.142 | -0.136 | -0.136 | -0.12  | -0.113 | -0.108 | -0.086 |  0.05  |
| 2005-03-01 00:00:00 | -0.14  | -0.125 | -0.092 | -0.096 | -0.081 | -0.053 | -0.065 | -0.037 | -0.026 | 0.004  | 0.144  |
| 2005-04-01 00:00:00 | 0.019  | -0.013 | -0.023 | -0.02  | -0.023 | -0.032 | -0.052 | -0.055 | -0.081 | -0.094 | -0.112 |
| 2005-05-01 00:00:00 | 0.001  |  0.0   | -0.001 | 0.004  | -0.003 | -0.001 | -0.006 | -0.001 | -0.002 | 0.029  | 0.028  |
| 2005-06-01 00:00:00 |  -0.1  |  -0.1  | -0.083 | -0.08  | -0.073 | -0.068 | -0.064 | -0.054 | -0.028 | 0.011  | 0.111  |
| 2005-07-01 00:00:00 | 0.258  | 0.196  | 0.192  | 0.174  | 0.173  | 0.152  | 0.136  | 0.124  | 0.119  |  0.05  | -0.208 |
| 2005-08-01 00:00:00 | 0.081  | 0.027  | 0.031  | 0.025  | -0.002 | 0.027  | 0.029  | 0.029  | 0.027  | -0.004 | -0.085 |
| 2005-09-01 00:00:00 | -0.083 | -0.056 | -0.06  | -0.067 | -0.058 | -0.052 | -0.056 | -0.056 | -0.048 | -0.052 | 0.031  |
| 2005-10-01 00:00:00 | 0.032  | 0.028  | 0.037  | 0.017  | 0.015  |  0.01  | 0.013  | -0.003 | -0.014 | -0.012 | -0.044 |
| 2005-11-01 00:00:00 | -0.011 | -0.005 | 0.001  | 0.017  | 0.012  | 0.023  | 0.032  | 0.053  | 0.067  | 0.073  | 0.085  |
| 2005-12-01 00:00:00 | -0.008 | 0.056  | 0.076  |  0.09  | 0.078  | 0.091  |  0.11  |  0.13  | 0.127  | 0.096  | 0.104  |
| 2006-01-01 00:00:00 | 0.094  | 0.047  | 0.026  | 0.032  | 0.021  | 0.022  | 0.017  | 0.019  | -0.001 | 0.043  | -0.051 |
| 2006-02-01 00:00:00 | -0.037 | -0.008 | -0.004 | -0.002 | 0.004  | 0.006  | 0.031  | 0.028  | 0.057  | 0.027  | 0.064  |
| 2006-03-01 00:00:00 | 0.139  | 0.007  | 0.082  |  0.08  | 0.099  | 0.113  | 0.105  | 0.133  | 0.139  | 0.151  | 0.011  |
| 2006-04-01 00:00:00 |  1.07  | 0.313  | 0.307  | 0.308  | 0.274  | 0.269  | 0.258  | 0.237  | 0.213  | 0.164  | -0.906 |
| 2006-05-01 00:00:00 |  0.07  | 0.079  | 0.066  | 0.083  | 0.065  | 0.071  | 0.039  | 0.053  | 0.024  | 0.021  | -0.049 |
| 2006-06-01 00:00:00 | 0.001  | 0.005  | -0.014 | -0.012 | -0.037 | -0.028 | -0.041 | -0.059 | -0.047 | -0.084 | -0.085 |
| 2006-07-01 00:00:00 | 0.022  |  0.03  | 0.025  | 0.023  | 0.032  | 0.033  | 0.035  | 0.045  |  0.04  | 0.027  | 0.005  |
| 2006-08-01 00:00:00 | 0.113  | 0.065  | 0.062  | 0.049  | 0.052  | 0.041  | 0.046  | 0.036  | 0.037  | 0.043  | -0.07  |
| 2006-09-01 00:00:00 | -0.01  | -0.013 | -0.018 | -0.002 | 0.016  | -0.017 | -0.011 |  -0.0  | 0.019  | 0.029  | 0.039  |
| 2006-10-01 00:00:00 | -0.011 | -0.007 | -0.003 | 0.022  | 0.025  | 0.035  | 0.063  | 0.059  | 0.105  | 0.171  | 0.182  |
| 2006-11-01 00:00:00 | 0.011  | 0.036  | 0.035  |  0.05  | 0.035  | 0.042  | 0.069  | 0.085  | 0.095  | 0.153  | 0.141  |
| 2006-12-01 00:00:00 | 0.305  | 0.269  |  0.26  | 0.286  | 0.257  |  0.25  | 0.224  | 0.234  | 0.241  |  0.19  | -0.115 |
| 2007-01-01 00:00:00 | 0.257  | 0.244  | 0.241  | 0.223  | 0.217  | 0.186  | 0.245  | 0.136  |  0.15  | 0.083  | -0.175 |
| 2007-02-01 00:00:00 | 0.272  | 0.261  | 0.216  | 0.204  | 0.191  | 0.164  | 0.175  | 0.143  | 0.085  | 0.087  | -0.185 |
| 2007-03-01 00:00:00 | 0.332  | 0.329  | 0.343  | 0.363  | 0.339  | 0.322  | 0.336  | 0.348  | 0.347  | 0.283  | -0.049 |
| 2007-04-01 00:00:00 | 0.199  | 0.088  | 0.089  | 0.081  | 0.071  | 0.131  | 0.111  | 0.079  | 0.106  | 0.135  | -0.064 |
| 2007-05-01 00:00:00 | -0.22  | -0.23  | -0.216 | -0.211 | -0.189 | -0.155 | -0.159 | -0.13  | -0.092 | -0.04  | 0.181  |
| 2007-06-01 00:00:00 | 0.296  | 0.287  | 0.278  | 0.244  | 0.236  | 0.236  | 0.212  | 0.186  | 0.189  | 0.185  | -0.111 |
| 2007-07-01 00:00:00 | 0.198  | 0.127  | 0.104  | 0.099  | 0.094  | 0.096  | 0.115  | 0.108  | 0.143  |  0.18  | -0.018 |
| 2007-08-01 00:00:00 | 0.046  | 0.016  | 0.018  | 0.025  | 0.035  | 0.042  | 0.029  |  0.04  | 0.054  | 0.075  | 0.029  |
| 2007-09-01 00:00:00 | -0.124 | -0.139 | -0.115 | -0.117 | -0.121 | -0.099 | -0.117 | -0.097 | -0.084 | -0.007 | 0.117  |
| 2007-10-01 00:00:00 | 0.009  | -0.013 | -0.019 | -0.052 | -0.049 | -0.075 | -0.08  |  -0.1  | -0.134 | -0.187 | -0.196 |
| 2007-11-01 00:00:00 | 0.184  | 0.205  | 0.204  | 0.208  |  0.21  |  0.21  |  0.22  | 0.216  |  0.2   | 0.148  | -0.036 |
| 2007-12-01 00:00:00 | -0.054 | -0.06  | -0.063 | -0.051 | -0.077 | -0.047 | -0.059 | -0.069 | -0.084 | -0.12  | -0.067 |
| 2008-01-01 00:00:00 | 0.116  | 0.109  | 0.117  | 0.107  | 0.101  | 0.083  | 0.076  | 0.065  | 0.043  | 0.017  | -0.099 |
| 2008-02-01 00:00:00 | -0.174 | -0.171 | -0.181 | -0.182 | -0.199 | -0.201 | -0.199 | -0.217 | -0.224 | -0.212 | -0.039 |
| 2008-03-01 00:00:00 | -0.087 | -0.091 | -0.077 | -0.075 | -0.069 | -0.051 | -0.049 | -0.006 | 0.017  | 0.043  |  0.13  |
| 2008-04-01 00:00:00 | 0.006  | -0.007 | -0.008 | -0.003 | -0.026 | -0.039 | -0.027 | -0.059 | -0.048 | -0.078 | -0.084 |
| 2008-05-01 00:00:00 | -0.239 | -0.234 | -0.266 | -0.275 | -0.249 | -0.26  | -0.239 | -0.25  | -0.234 | -0.221 | 0.018  |
| 2008-06-01 00:00:00 | 0.137  | 0.118  | 0.116  | 0.111  | 0.108  | 0.103  | 0.072  | 0.076  | 0.052  | 0.005  | -0.132 |
| 2008-07-01 00:00:00 | -0.207 | -0.224 | -0.227 | -0.233 | -0.223 | -0.238 | -0.241 | -0.238 | -0.229 | -0.194 | 0.013  |
| 2008-08-01 00:00:00 | -0.117 | -0.104 | -0.09  | -0.098 | -0.101 | -0.08  | -0.085 | -0.061 | -0.044 | -0.026 |  0.09  |
| 2008-09-01 00:00:00 | -0.225 | -0.232 | -0.249 | -0.265 | -0.247 | -0.266 | -0.272 | -0.262 | -0.275 | -0.248 | -0.023 |
| 2008-10-01 00:00:00 | 0.231  | 0.215  | 0.219  | 0.221  | 0.225  | 0.223  | 0.185  | 0.161  | 0.157  | 0.131  | -0.101 |
| 2008-11-01 00:00:00 | 0.155  |  0.13  | 0.094  | 0.097  | 0.061  | 0.068  | 0.053  | 0.065  | 0.041  | 0.013  | -0.142 |
| 2008-12-01 00:00:00 | 0.149  | 0.161  | 0.163  | 0.159  | 0.162  | 0.187  | 0.162  | 0.169  | 0.158  | 0.119  | -0.03  |
| 2009-01-01 00:00:00 | 0.124  | 0.116  | 0.094  | 0.084  | 0.092  |  0.09  | 0.073  | 0.081  | 0.057  | 0.063  | -0.061 |
| 2009-02-01 00:00:00 | 0.255  | 0.254  | 0.235  | 0.246  | 0.226  | 0.224  |  0.21  | 0.209  | 0.198  | 0.186  | -0.069 |
| 2009-03-01 00:00:00 | 0.102  |  0.11  | 0.078  | 0.074  | 0.081  | 0.073  | 0.038  | 0.066  | 0.041  |  0.05  | -0.052 |
| 2009-04-01 00:00:00 | 0.096  | 0.092  | 0.106  |  0.07  | 0.085  | 0.062  | 0.057  | 0.047  | 0.045  | 0.056  | -0.041 |
| 2009-05-01 00:00:00 | 0.112  | 0.081  | 0.061  | 0.039  |  0.04  | 0.055  | 0.039  | 0.053  | 0.078  | 0.124  | 0.012  |
| 2009-06-01 00:00:00 | 0.134  | 0.125  | 0.133  | 0.136  | 0.143  | 0.155  | 0.129  | 0.153  | 0.182  | 0.183  |  0.05  |
| 2009-07-01 00:00:00 | -0.124 | -0.141 | -0.151 | -0.144 | -0.147 | -0.139 | -0.155 | -0.171 | -0.18  | -0.236 | -0.112 |
| 2009-08-01 00:00:00 | 0.055  | 0.041  | 0.044  | 0.024  |  0.03  | 0.037  | 0.032  | 0.035  |  0.04  | 0.052  | -0.003 |
| 2009-09-01 00:00:00 | 0.124  | 0.133  | 0.129  | 0.128  |  0.12  | 0.132  |  0.12  | 0.112  | 0.108  | 0.092  | -0.032 |
| 2009-10-01 00:00:00 | 0.167  | 0.173  | 0.153  | 0.158  | 0.163  | 0.178  | 0.144  | 0.142  | 0.109  | 0.084  | -0.083 |
| 2009-11-01 00:00:00 | 0.052  | 0.039  | 0.035  | 0.029  | 0.035  | 0.032  | 0.006  | 0.005  | -0.005 | 0.004  | -0.048 |
| 2009-12-01 00:00:00 | -0.016 | -0.011 | -0.033 | -0.026 | -0.018 | -0.031 | -0.019 | -0.035 | -0.049 |  -0.1  | -0.084 |
| 2010-01-01 00:00:00 |  0.09  | 0.082  | 0.078  | 0.064  | 0.061  | 0.068  | 0.059  | 0.057  | 0.043  | 0.025  | -0.065 |
| 2010-02-01 00:00:00 | 0.086  | 0.067  | 0.064  | 0.053  | 0.039  | 0.042  | 0.046  | 0.017  | 0.017  | 0.011  | -0.075 |
| 2010-03-01 00:00:00 | -0.056 | -0.063 | -0.082 | -0.084 | -0.072 | -0.068 | -0.07  | -0.078 | -0.063 | -0.073 | -0.017 |
| 2010-04-01 00:00:00 | -0.088 | -0.08  | -0.073 | -0.088 | -0.094 | -0.077 | -0.08  | -0.065 | -0.078 | -0.089 |  -0.0  |
| 2010-05-01 00:00:00 | -0.082 | -0.083 | -0.087 | -0.083 | -0.091 | -0.094 | -0.099 | -0.101 | -0.098 | -0.081 | 0.001  |
| 2010-06-01 00:00:00 | 0.168  | 0.164  | 0.153  | 0.149  | 0.149  | 0.164  | 0.143  | 0.138  | 0.133  |  0.13  | -0.038 |
| 2010-07-01 00:00:00 | 0.107  | 0.106  |  0.09  | 0.113  | 0.097  | 0.096  | 0.084  | 0.109  | 0.075  | 0.027  | -0.08  |
| 2010-08-01 00:00:00 | 0.025  | -0.012 | -0.007 | 0.002  | 0.007  | -0.004 | -0.008 | 0.016  |  0.02  | 0.016  | -0.009 |
| 2010-09-01 00:00:00 | 0.062  | 0.078  | 0.074  | 0.098  | 0.082  | 0.091  | 0.093  | 0.098  | 0.114  | 0.156  | 0.094  |
| 2010-10-01 00:00:00 | 0.039  | 0.036  |  0.04  | 0.028  | 0.014  | 0.012  | 0.016  | 0.018  | -0.015 | -0.06  | -0.099 |
| 2010-11-01 00:00:00 | -0.007 | -0.023 | -0.015 | -0.024 | -0.029 | -0.035 | -0.027 | -0.034 | -0.018 | 0.007  | 0.014  |
| 2010-12-01 00:00:00 | -0.031 | -0.055 | -0.053 | -0.059 | -0.06  | -0.058 | -0.067 | -0.065 | -0.065 | -0.025 | 0.006  |
| 2011-01-01 00:00:00 | 0.099  | 0.104  | 0.101  | 0.093  | 0.106  | 0.096  | 0.105  | 0.102  | 0.085  | 0.059  | -0.04  |
| 2011-02-01 00:00:00 | 0.034  | 0.004  | -0.008 | -0.001 | -0.019 | -0.024 | -0.036 | -0.022 | -0.027 | -0.027 | -0.06  |
| 2011-03-01 00:00:00 | -0.029 | -0.04  | -0.039 | -0.051 | -0.046 | -0.046 | -0.029 | -0.037 | -0.034 | -0.019 |  0.01  |
| 2011-04-01 00:00:00 | -0.062 | -0.074 | -0.068 | -0.075 | -0.06  | -0.081 | -0.081 | -0.081 | -0.083 | -0.067 | -0.005 |
| 2011-05-01 00:00:00 | 0.044  | 0.045  | 0.035  |  0.03  | 0.046  | 0.025  | 0.034  | 0.032  | 0.036  | 0.029  | -0.015 |
| 2011-06-01 00:00:00 |  0.04  | 0.029  |  0.03  | 0.033  | 0.033  | 0.021  | 0.016  | 0.024  | 0.011  | -0.012 | -0.052 |
| 2011-07-01 00:00:00 | 0.008  | -0.009 | -0.014 | -0.019 | -0.031 | -0.031 | -0.035 | -0.033 | -0.047 | -0.052 | -0.06  |
| 2011-08-01 00:00:00 | -0.109 | -0.117 | -0.122 | -0.119 | -0.121 | -0.133 | -0.13  | -0.137 | -0.122 | -0.096 | 0.013  |
| 2011-09-01 00:00:00 | 0.054  | 0.044  | 0.046  |  0.04  | 0.046  | 0.044  | 0.039  | 0.046  | 0.039  | 0.035  | -0.019 |
| 2011-10-01 00:00:00 | -0.03  | -0.022 | -0.042 | -0.048 | -0.027 | -0.038 | -0.045 | -0.04  | -0.055 | -0.065 | -0.035 |
| 2011-11-01 00:00:00 | -0.177 | -0.178 | -0.169 | -0.171 | -0.172 | -0.152 | -0.164 | -0.142 | -0.12  | -0.085 | 0.092  |
| 2011-12-01 00:00:00 |  0.01  | -0.007 | -0.021 | -0.023 | -0.007 | -0.014 | -0.009 | -0.007 | -0.004 | 0.035  | 0.025  |
| 2012-01-01 00:00:00 |  0.16  | 0.155  | 0.149  | 0.142  | 0.137  | 0.136  | 0.127  | 0.127  | 0.117  | 0.082  | -0.078 |
| 2012-02-01 00:00:00 | -0.079 | -0.081 | -0.073 | -0.07  | -0.076 | -0.077 | -0.076 | -0.078 | -0.073 | -0.074 | 0.004  |
| 2012-03-01 00:00:00 | 0.061  | 0.064  | 0.069  | 0.084  | 0.065  | 0.068  | 0.072  |  0.06  | 0.057  | 0.069  | 0.008  |
| 2012-04-01 00:00:00 |  0.04  | 0.029  | 0.012  | 0.023  | 0.023  |  0.02  | 0.023  | 0.031  | 0.032  | 0.013  | -0.028 |
| 2012-05-01 00:00:00 | -0.018 | -0.035 | -0.055 | -0.058 | -0.061 | -0.07  | -0.068 | -0.071 | -0.062 | -0.061 | -0.043 |
| 2012-06-01 00:00:00 | -0.125 | -0.108 | -0.095 | -0.101 | -0.097 | -0.102 | -0.093 | -0.087 | -0.081 | -0.057 | 0.068  |
| 2012-07-01 00:00:00 | 0.068  | 0.064  | 0.055  | 0.047  | 0.032  | 0.033  | 0.013  | 0.005  | -0.023 | -0.053 | -0.121 |
| 2012-08-01 00:00:00 | 0.014  | 0.016  | -0.007 | 0.004  | 0.004  | -0.001 | -0.001 | 0.018  | 0.017  | 0.039  | 0.026  |
| 2012-09-01 00:00:00 | 0.012  |  0.01  | 0.004  | -0.001 | 0.003  |  -0.0  | -0.01  | -0.008 | -0.018 | -0.016 | -0.028 |
| 2012-10-01 00:00:00 | -0.095 | -0.12  | -0.115 | -0.12  | -0.122 | -0.116 | -0.124 | -0.116 | -0.105 | -0.066 | 0.029  |
| 2012-11-01 00:00:00 | 0.167  | 0.175  | 0.165  | 0.169  | 0.181  | 0.164  | 0.174  | 0.179  | 0.166  | 0.175  | 0.008  |
| 2012-12-01 00:00:00 | 0.062  | 0.057  | 0.073  | 0.071  | 0.071  | 0.064  | 0.059  | 0.065  | 0.056  | 0.054  | -0.008 |
| 2013-01-01 00:00:00 |  0.06  | 0.041  | 0.041  | 0.041  | 0.037  | 0.034  | 0.039  | 0.041  | 0.036  | 0.005  | -0.055 |
| 2013-02-01 00:00:00 | -0.025 | -0.026 | -0.017 | -0.03  | -0.03  | -0.025 | -0.048 | -0.045 | -0.047 | -0.053 | -0.028 |
| 2013-03-01 00:00:00 | -0.023 | -0.048 | -0.04  | -0.031 | -0.032 | -0.027 | -0.027 | -0.019 | -0.021 | -0.022 | 0.002  |
| 2013-04-01 00:00:00 | 0.177  | 0.155  | 0.157  | 0.153  | 0.153  | 0.146  | 0.151  | 0.152  | 0.132  | 0.076  | -0.102 |
| 2013-05-01 00:00:00 | -0.139 | -0.157 | -0.155 | -0.155 | -0.161 | -0.158 | -0.15  | -0.164 | -0.153 | -0.14  | -0.001 |
| 2013-06-01 00:00:00 | 0.123  | 0.086  | 0.072  | 0.075  | 0.083  | 0.063  | 0.063  | 0.072  | 0.051  | 0.028  | -0.095 |
| 2013-07-01 00:00:00 | 0.104  | 0.092  | 0.112  |  0.1   | 0.076  |  0.08  | 0.089  | 0.078  | 0.062  | 0.063  | -0.041 |
| 2013-08-01 00:00:00 | 0.076  | 0.053  | 0.052  | 0.053  | 0.059  | 0.043  | 0.056  | 0.049  | 0.056  | 0.054  | -0.021 |
| 2013-09-01 00:00:00 | -0.006 | -0.013 | -0.018 | -0.024 | -0.017 | -0.029 | -0.039 | -0.033 | -0.038 | -0.034 | -0.027 |
| 2013-10-01 00:00:00 | 0.131  | 0.128  | 0.111  | 0.086  | 0.097  | 0.083  | 0.076  | 0.068  | 0.055  | 0.044  | -0.087 |
| 2013-11-01 00:00:00 | -0.02  | -0.029 | -0.031 | -0.032 | -0.039 | -0.03  | -0.038 | -0.03  | -0.038 | -0.044 | -0.023 |
| 2013-12-01 00:00:00 | 0.035  | 0.062  | 0.024  |  0.01  | 0.031  | 0.046  | 0.007  | 0.035  | 0.004  | -0.031 | -0.066 |
| 2014-01-01 00:00:00 | 0.067  |  0.05  | 0.047  | 0.047  | 0.044  | 0.044  | 0.032  | 0.017  | 0.009  | -0.018 | -0.085 |
| 2014-02-01 00:00:00 | 0.025  | 0.003  | -0.013 | -0.021 | -0.033 | -0.037 | -0.042 | -0.043 | -0.043 | -0.036 | -0.061 |
| 2014-03-01 00:00:00 | 0.022  | 0.006  | -0.008 | -0.012 | -0.03  | -0.03  | -0.016 | -0.015 | -0.025 | -0.004 | -0.026 |
| 2014-04-01 00:00:00 | 0.115  | 0.055  | 0.048  | 0.027  | 0.036  | 0.032  | 0.037  | 0.022  |  0.02  | 0.008  | -0.107 |
| 2014-05-01 00:00:00 | 0.079  |  0.09  | 0.073  | 0.062  | 0.052  | 0.056  | 0.042  | 0.037  | 0.034  | 0.019  | -0.06  |
| 2014-06-01 00:00:00 | 0.104  | 0.075  | 0.075  | 0.083  | 0.077  | 0.069  | 0.072  | 0.072  | 0.066  | 0.077  | -0.027 |
| 2014-07-01 00:00:00 | 0.111  | 0.091  | 0.068  | 0.066  | 0.057  | 0.056  | 0.046  | 0.046  | 0.048  | 0.013  | -0.098 |
| 2014-08-01 00:00:00 | 0.211  | 0.191  | 0.158  | 0.146  | 0.146  | 0.122  |  0.12  |  0.12  | 0.104  | 0.066  | -0.145 |
| 2014-09-01 00:00:00 | 0.021  | 0.019  | 0.033  | 0.036  | 0.014  | 0.017  | 0.009  | 0.017  | 0.009  | 0.025  | 0.005  |
| 2014-10-01 00:00:00 | 0.069  | 0.075  | 0.047  | 0.064  | 0.054  |  0.07  | 0.037  | 0.048  | 0.062  | 0.109  |  0.04  |
| 2014-11-01 00:00:00 | -0.108 | -0.083 | -0.078 | -0.076 | -0.067 | -0.048 | -0.036 | 0.006  | 0.021  | 0.202  | 0.309  |
| 2014-12-01 00:00:00 | 0.116  | 0.106  | 0.112  | 0.104  |  0.09  | 0.099  | 0.074  | 0.076  | 0.075  | -0.001 | -0.116 |
| 2015-01-01 00:00:00 | 0.117  | 0.086  | 0.081  | 0.074  |  0.09  | 0.087  | 0.099  | 0.087  | 0.095  | 0.058  | -0.059 |
| 2015-02-01 00:00:00 | 0.271  | 0.243  | 0.243  | 0.251  |  0.24  | 0.242  | 0.224  | 0.225  | 0.201  | 0.153  | -0.118 |
| 2015-03-01 00:00:00 | 0.217  | 0.179  | 0.171  |  0.2   | 0.148  | 0.164  | 0.161  | 0.158  | 0.147  | 0.196  | -0.021 |
| 2015-04-01 00:00:00 | 0.373  | 0.317  | 0.294  | 0.284  | 0.276  | 0.256  | 0.253  | 0.203  | 0.158  | 0.059  | -0.314 |
| 2015-05-01 00:00:00 | -0.047 | -0.096 | -0.123 | -0.124 | -0.155 | -0.156 | -0.156 | -0.118 | -0.133 | -0.098 | -0.05  |
| 2015-06-01 00:00:00 | -0.161 | -0.178 | -0.209 | -0.209 | -0.203 | -0.19  | -0.179 | -0.152 | -0.159 | -0.164 | -0.003 |
| 2015-07-01 00:00:00 | -0.088 | -0.125 | -0.121 | -0.149 | -0.156 | -0.15  | -0.151 | -0.165 | -0.168 | -0.139 | -0.051 |
| 2015-08-01 00:00:00 | 0.004  | -0.005 | -0.003 | 0.009  | -0.011 | -0.011 | -0.01  | -0.034 | -0.046 | -0.061 | -0.065 |
| 2015-09-01 00:00:00 | 0.301  |  0.27  | 0.276  | 0.257  | 0.258  | 0.237  | 0.222  | 0.219  | 0.209  | 0.136  | -0.165 |
| 2015-10-01 00:00:00 | 0.203  | 0.193  | 0.173  | 0.148  | 0.128  | 0.111  | 0.081  | 0.061  | 0.045  | 0.013  | -0.19  |
| 2015-11-01 00:00:00 | 0.152  | 0.099  | 0.085  | 0.066  | 0.053  | 0.029  | 0.038  | 0.034  | 0.019  | 0.031  | -0.121 |
| 2015-12-01 00:00:00 | -0.303 | -0.296 | -0.309 | -0.31  | -0.306 | -0.311 | -0.305 | -0.298 | -0.301 | -0.25  | 0.053  |
| 2016-01-01 00:00:00 | 0.009  | -0.005 | -0.009 | -0.022 | -0.021 | -0.028 | -0.031 | -0.02  | -0.019 | -0.022 | -0.03  |
| 2016-02-01 00:00:00 | 0.257  | 0.223  |  0.22  | 0.201  | 0.208  | 0.214  | 0.187  | 0.179  | 0.169  | 0.137  | -0.12  |
| 2016-03-01 00:00:00 | 0.062  | 0.042  | 0.016  |  0.0   | -0.011 | -0.027 | -0.016 | -0.034 | -0.03  | -0.036 | -0.098 |
| 2016-04-01 00:00:00 | -0.035 | -0.029 | -0.023 | -0.011 | -0.01  | -0.007 | 0.003  | 0.002  | -0.005 | -0.004 | 0.031  |
| 2016-05-01 00:00:00 | 0.068  | 0.085  | 0.085  | 0.082  | 0.082  | 0.072  | 0.055  | 0.054  | 0.027  | 0.013  | -0.055 |
| 2016-06-01 00:00:00 | 0.002  | 0.001  | -0.009 | -0.014 | -0.02  | -0.02  | -0.026 | -0.011 | -0.003 | 0.034  | 0.032  |
| 2016-07-01 00:00:00 | 0.085  | 0.066  | 0.061  |  0.06  | 0.046  | 0.039  | 0.039  | 0.036  | 0.032  | 0.034  | -0.051 |
| 2016-08-01 00:00:00 | 0.057  | 0.016  | -0.005 | -0.019 | -0.014 | -0.021 | -0.031 | -0.026 | -0.031 | -0.032 | -0.089 |
| 2016-09-01 00:00:00 | 0.051  | 0.056  | 0.051  | 0.042  | 0.043  | 0.047  | 0.024  | 0.027  | 0.022  | 0.023  | -0.028 |
| 2016-10-01 00:00:00 | 0.062  | 0.055  | 0.036  | 0.025  | 0.026  | 0.021  | 0.016  | 0.016  | 0.021  | 0.044  | -0.019 |
| 2016-11-01 00:00:00 | 0.007  | -0.039 | -0.039 | -0.06  | -0.063 | -0.071 | -0.067 | -0.065 | -0.06  | -0.063 | -0.07  |
| 2016-12-01 00:00:00 | -0.043 | -0.037 | -0.043 | -0.04  | -0.037 | -0.034 | -0.03  | -0.029 | -0.021 | 0.012  | 0.055  |
+---------------------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |  Diff  |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| Average | 0.036 | 0.024 | 0.019 | 0.018 | 0.015 | 0.015 | 0.011 | 0.012 |  0.01 | 0.009 | -0.027 |
|  T-Test | 3.823 |  3.07 | 2.584 | 2.358 |  2.08 | 2.044 | 1.619 | 1.796 | 1.566 | 1.508 | -3.949 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
```

The fourth dataset includes below 30% stocks from 2000-01-01 to 2016-12-01. The size effect is **significant** since the t-test statistics is -3.949 whose absolute value is more than 2 corresponding to the significance level at 0.05. The monthly excess return is **2.7%** and the annual excess return is about 32.4%. 

The size effect provides **0.6%** excess return a month in U.S. market. 



#### Value Effect

The value effect was discovered since 1980s and became famous since the research by Fama and French (1993). The value factor, as one of systematic factors, is constructed by the variable, book to market ratio (BM). The positive correlation between the BM and the future return is widely tested by literatures (Fama and French, 1993, 1995; Stattman, 1980; Barber and Lyon, 1997). Other than BM, some value-related variables are also taken into consideration, and the most common one is earnings to price ratio, EP (Basu, 1983). Aras and Yilmaz (2008) and Cakici et al. (2013) discovered the value effect is existing in 12 and 18 emerging markets, respectively. 

As for the value effect in China market, Liu et al. (2019) argue that EP is more suitable than BM, through which they construct the value factor in China market. In this demo, the BM and EP are both tested, while some adjustment are attached to these variables, and precisely the reverse form of theses two variables are used respectively named, price to earnings ratio (PE) and price to book ratio (PB). Thus, the relation between the variables and the future return is negative.

Following the conventions, stocks are grouped by two variables, market value (size) and value variables, independently and formed a 5*5 portfolio matrix. The dataset contains monthly China A share stock between 2000-01-01 to 2021-12-31 from the CSMAR dataset. **WARNING: Do Not use dataset in this demo for any commercial purpose.**

```python
import pandas as pd
import sys, os

sys.path.append(os.path.abspath(".."))

# %% import data
# Monthly return of stocks in China security market
month_return = pd.read_hdf('.\data\month_return.h5', key='month_return')
company_data = pd.read_hdf('.\data\last_filter_pe.h5', key='data')
```

Data need some preprocessing.

```python
# %% preprocessing data
# forward the monthly return for each stock
# emrwd is the return including dividend
month_return['emrwd'] = month_return.groupby(['Stkcd'])['Mretwd'].shift(-1)
# emrnd is the return including no dividend
month_return['emrnd'] = month_return.groupby(['Stkcd'])['Mretnd'].shift(-1)
# select the A share stock
month_return = month_return[month_return['Markettype'].isin([1, 4, 16])]

# % distinguish the stocks whose size is among the up 30% stocks in each month
def percentile(stocks) :
    return stocks >= stocks.quantile(q=.3)

month_return['cap'] = month_return.groupby(['Trdmnt'])['Msmvttl'].apply(percentile)
# %% merge data
from pandas.tseries.offsets import *

month_return['Stkcd_merge'] = month_return['Stkcd'].astype(dtype='string')
month_return['Date_merge'] = pd.to_datetime(month_return['Trdmnt'])
#month_return['Date_merge'] += MonthEnd()

company_data['Stkcd_merge'] = company_data['Symbol'].dropna().astype(dtype='int').astype(dtype='string')
company_data['Date_merge'] = pd.to_datetime(company_data['TradingDate'])
company_data['Date_merge'] += MonthBegin()
```

Consistent with the size effect, the dataset starts from 2000-01. 

```python
# %% dataset starts from '2000-01'
company_data = company_data[company_data['Date_merge'] >= '2000-01']
month_return = month_return[month_return['Date_merge'] >= '2000-01']
return_company = pd.merge(company_data, month_return, on=['Stkcd_merge', 'Date_merge'])
```

Four datasets are tested. Due to specific requirement of the IPO, some dominant company would purchase a small listed company and join the A share market. Thus, in the research by Liu et al. (2016), the stocks whose size is below the 30% are abandoned. The PE and PB are both tested. 

```python
# %% construct test_data for bivariate analysis
# dataset 1 : PE
from portfolio_analysis import Bivariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_1 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
test_data_1 = test_data_1[['emrwd', 'Msmvttl', 'PE1A', 'Date_merge']].dropna()
test_data_1 = test_data_1[(test_data_1['Date_merge'] >= '2000-01-01') & (test_data_1['Date_merge'] <= '2019-12-01')]
# analysis
bi_1 = Bivariate(np.array(test_data_1), number=4)
bi_1.average_by_time()
bi_1.summary_and_test()
bi_1.print_summary_by_time()
bi_1.print_summary()
=====================================================================================
+-------+--------+--------+--------+--------+--------+--------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff  |
+-------+--------+--------+--------+--------+--------+--------+
|   1   | 0.019  | 0.017  | 0.013  | 0.013  |  0.01  | -0.009 |
|       | 3.024  | 2.693  | 2.003  |  1.89  | 1.472  | -3.551 |
|   2   | 0.014  | 0.015  | 0.011  | 0.011  | 0.009  | -0.005 |
|       |  2.25  | 2.415  | 1.779  | 1.658  | 1.374  | -1.947 |
|   3   | 0.014  |  0.01  | 0.009  | 0.009  | 0.005  | -0.009 |
|       | 2.298  | 1.648  | 1.478  |  1.36  | 0.778  | -3.19  |
|   4   | 0.011  | 0.011  | 0.009  | 0.009  | 0.005  | -0.006 |
|       | 1.901  | 1.871  | 1.507  | 1.431  | 0.799  | -1.98  |
|   5   | 0.013  | 0.009  | 0.007  | 0.006  | 0.002  | -0.011 |
|       | 2.204  | 1.678  | 1.258  | 0.988  | 0.331  | -2.984 |
|  Diff | -0.007 | -0.008 | -0.006 | -0.007 | -0.008 | -0.001 |
|       | -1.876 | -2.628 | -1.819 | -2.117 | -2.389 | -0.446 |
+-------+--------+--------+--------+--------+--------+--------+

```

The first dataset contains no tail 30% stocks from 2000-01-01 to 2019-12-01 and the value factor is PE. The value effect is **significant** since the t-test statistics for differenced portfolio are -3.551, -1.947, -3.19, -1.98, -2.984, respectively, whose absolute values are generally more than 2 corresponding to the significance level at 0.05.

```python
# %% construct test_data for bivariate analysis
# dataset 2 : PB
from portfolio_analysis import Bivariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_2 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
test_data_2 = test_data_2[['emrwd', 'Msmvttl', 'PBV1A', 'Date_merge']].dropna()
test_data_2 = test_data_2[(test_data_2['Date_merge'] >= '2000-01-01') & (test_data_2['Date_merge'] <= '2019-12-01')]
# analysis
bi_2 = Bivariate(np.array(test_data_2), number=4)
bi_2.average_by_time()
bi_2.summary_and_test()
bi_2.print_summary_by_time()
bi_2.print_summary()
=================================================================================
+-------+--------+--------+--------+--------+--------+--------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff  |
+-------+--------+--------+--------+--------+--------+--------+
|   1   | 0.016  | 0.015  | 0.012  | 0.014  | 0.008  | -0.008 |
|       |  2.41  | 2.321  | 1.904  | 1.969  | 1.135  | -2.467 |
|   2   | 0.013  | 0.012  | 0.012  | 0.011  | 0.006  | -0.007 |
|       | 2.075  |  1.87  | 1.877  | 1.645  | 0.955  | -1.902 |
|   3   | 0.012  | 0.009  | 0.008  |  0.01  | 0.007  | -0.005 |
|       | 1.898  | 1.479  | 1.302  | 1.571  | 1.075  | -1.492 |
|   4   | 0.012  | 0.011  | 0.008  | 0.006  | 0.008  | -0.004 |
|       | 1.911  | 1.804  | 1.284  | 0.996  | 1.266  | -1.075 |
|   5   | 0.011  | 0.011  | 0.008  | 0.007  | 0.006  | -0.005 |
|       | 1.975  | 1.995  | 1.423  | 1.282  | 1.111  | -1.185 |
|  Diff | -0.004 | -0.004 | -0.004 | -0.006 | -0.002 | 0.003  |
|       | -1.301 | -1.127 | -1.38  | -1.726 | -0.418 | 0.785  |
+-------+--------+--------+--------+--------+--------+--------+

```

The second dataset contains no tail 30% stocks and the value variable is PB from 2000-01-01 to 2019-12-01. The value effect is partly **significant** since the t-test statistics for differenced portfolio are -2.467, -1.902, -1.492, -1.075, -1.185, respectively, whose absolute values are generally no more than 2 corresponding to the significance level at 0.05.

```python
# %% construct test_data for bivariate analysis
# dataset 3 : PE 
from portfolio_analysis import Bivariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_3 = return_company[return_company['Ndaytrd']>=10]
test_data_3 = test_data_3[['emrwd', 'Msmvttl', 'PE1A', 'Date_merge']].dropna()
test_data_3 = test_data_3[(test_data_3['Date_merge'] >= '2000-01-01') & (test_data_3['Date_merge'] <= '2019-12-01')]
# analysis
bi_3 = Bivariate(np.array(test_data_3), number=4)
bi_3.average_by_time()
bi_3.summary_and_test()
bi_3.print_summary_by_time()
bi_3.print_summary()
==============================================================================
+-------+--------+--------+--------+--------+--------+--------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff  |
+-------+--------+--------+--------+--------+--------+--------+
|   1   | 0.023  | 0.023  | 0.022  | 0.022  | 0.022  | -0.001 |
|       | 3.492  | 3.471  | 3.239  | 3.107  | 3.043  | -0.664 |
|   2   | 0.019  | 0.017  | 0.014  | 0.013  | 0.011  | -0.008 |
|       |  3.04  | 2.619  | 2.163  | 1.915  | 1.635  | -3.531 |
|   3   | 0.014  | 0.013  | 0.011  |  0.01  | 0.009  | -0.005 |
|       | 2.296  | 2.181  | 1.723  |  1.57  | 1.338  | -2.334 |
|   4   | 0.013  | 0.009  | 0.009  | 0.007  | 0.005  | -0.008 |
|       | 2.159  | 1.626  | 1.519  | 1.138  |  0.69  | -3.141 |
|   5   | 0.012  | 0.009  | 0.007  | 0.006  | 0.003  | -0.009 |
|       | 2.098  | 1.648  | 1.273  | 0.992  | 0.521  | -2.597 |
|  Diff | -0.011 | -0.014 | -0.015 | -0.016 | -0.018 | -0.007 |
|       | -2.816 | -3.834 | -4.025 | -4.372 | -5.071 | -2.236 |
+-------+--------+--------+--------+--------+--------+--------+

```

The third dataset contains tail 30% stocks and the value variable is PE from 2000-01-01 to 2019-12-01. The value effect is partly **significant** since the t-test statistics for differenced portfolio are -0.664, -3.531, -2.334, -3.141, -2.597, respectively, whose absolute values are generally more than 2 corresponding to the significance level at 0.05.

```python
# %% construct test_data for bivariate analysis
# dataset 4 : PB
from portfolio_analysis import Bivariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_4 = return_company[(return_company['Ndaytrd']>=10)]
test_data_4 = test_data_4[['emrwd', 'Msmvttl', 'PBV1A', 'Date_merge']].dropna()
test_data_4 = test_data_4[(test_data_4['Date_merge'] >= '2000-01-01') & (test_data_4['Date_merge'] <= '2019-12-01')]
# analysis
bi_4 = Bivariate(np.array(test_data_4), number=4)
bi_4.average_by_time()
bi_4.summary_and_test()
bi_4.print_summary_by_time()
bi_4.print_summary()
===================================================================
+-------+--------+--------+--------+--------+--------+--------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff  |
+-------+--------+--------+--------+--------+--------+--------+
|   1   | 0.022  | 0.024  | 0.025  | 0.022  |  0.02  | -0.002 |
|       | 3.342  | 3.475  | 3.554  | 3.054  | 2.714  | -0.905 |
|   2   | 0.017  | 0.016  | 0.013  | 0.015  | 0.009  | -0.008 |
|       | 2.632  | 2.365  | 1.939  | 2.239  | 1.337  | -2.653 |
|   3   | 0.013  | 0.013  | 0.012  |  0.01  | 0.007  | -0.006 |
|       | 2.045  | 2.071  |  1.9   | 1.616  | 1.051  | -1.827 |
|   4   | 0.011  |  0.01  | 0.009  | 0.008  | 0.007  | -0.004 |
|       | 1.783  | 1.592  | 1.416  | 1.299  | 1.167  | -1.093 |
|   5   | 0.011  | 0.011  | 0.008  | 0.007  | 0.006  | -0.006 |
|       | 1.975  | 1.914  | 1.382  | 1.174  | 0.997  | -1.392 |
|  Diff | -0.011 | -0.013 | -0.017 | -0.015 | -0.015 | -0.004 |
|       | -2.803 | -3.498 | -4.532 | -3.934 | -3.144 | -0.891 |
+-------+--------+--------+--------+--------+--------+--------+

```

The fourth dataset contains tail 30% stocks and the value variable is PB from 2000-01-01 to 2019-12-01. The value effect is partly **significant** since the t-test statistics for differenced portfolio are -0.905, -2.653, -1.827, -1.093, -1.392, respectively, whose absolute values are generally no more than 2 corresponding to the significance level at 0.05.



#### Profitability Factor

The relation of profitability and future return is more discussed in literature (Fama and French, 2015; Hou et al., 2015), through which the profitability factor is constituted and included in two main asset pricing model, **Fama-French 5 factor model** and **HXZ's model.** There are many proxy variables for profitability factor. These variables are highly correlated and the most common one is return on equity (ROE). Besides the ROE, ROA is supported by several literatures (Novy-Marx, 2013; Ball et al., 2015). Another substitution is return on tangible capital (ROTC), which is proposed by Greenblatt (2006, 2010). Through empirical evidence, it is suggested that profitability is positively related with future return in American stock market, while in China stock market the relation needs further discussion.

In this demo, the ROE(TTM) is used as the proxy variable for profitability factor. The dataset starts from Jan, 2004 and is collected from CSMAR dataset. **WARNING: Do Not use dataset in this demo for any commercial purpose.** 

```python
# %% import package
import pandas as pd
import sys, os

sys.path.append(os.path.abspath(".."))

# %% import data
# Monthly return of stocks in China security market
month_return = pd.read_hdf('.\data\month_return.h5', key='month_return')
company_data = pd.read_hdf('.\data\last_filter_pe.h5', key='data')
```

The data needs some preprocessing.

```python
# %% preprocessing data
# forward the monthly return for each stock
# emrwd is the return including dividend
month_return['emrwd'] = month_return.groupby(['Stkcd'])['Mretwd'].shift(-1)
# emrnd is the return including no dividend
month_return['emrnd'] = month_return.groupby(['Stkcd'])['Mretnd'].shift(-1)
# select the A share stock
month_return = month_return[month_return['Markettype'].isin([1, 4, 16])]

# % distinguish the stocks whose size is among the up 30% stocks in each month
def percentile(stocks) :
    return stocks >= stocks.quantile(q=.3)

month_return['cap'] = month_return.groupby(['Trdmnt'])['Msmvttl'].apply(percentile)

# %% prepare merge data
from pandas.tseries.offsets import *

month_return['Stkcd_merge'] = month_return['Stkcd'].astype(dtype='string')
month_return['Date_merge'] = pd.to_datetime(month_return['Trdmnt'])
month_return['Yearmonth'] = month_return['Date_merge'].map(lambda x : 1000*x.year + x.month)
#month_return['Date_merge'] += MonthEnd()

# in this demo, the ROE(TTM) are used
# ROE(TTM) = PBV1B/PE(TTM) 
company_data['ROE(TTM)'] = company_data['PBV1B']/company_data['PE1TTM']
company_data['Stkcd_merge'] = company_data['Symbol'].dropna().astype(dtype='int').astype(dtype='string')
company_data['Date_merge'] = pd.to_datetime(company_data['TradingDate'])
company_data['Yearmonth'] = company_data['Date_merge'].map(lambda x : 1000*x.year + x.month)
company_data['Date_merge'] += MonthBegin()

# %% dataset starts from '2000-01'
company_data = company_data[company_data['Date_merge'] >= '2000-01']
month_return = month_return[month_return['Date_merge'] >= '2000-01']
return_company = pd.merge(company_data, month_return, on=['Stkcd_merge', 'Date_merge'])

```

Two datasets are constituted. One includes tail 30% stock, while one includes not. Univariate analysis and Bivariate analysis are attached.

```python
# %% construct test_data for bivariate analysis
# dataset 1 : no tail stocks & ROE Bivariate
from portfolio_analysis import Bivariate, Univariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_1 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
test_data_1 = test_data_1[['emrwd', 'Msmvttl', 'ROE(TTM)', 'Date_merge']].dropna()
test_data_1 = test_data_1[(test_data_1['Date_merge'] >= '2004-01-01') & (test_data_1['Date_merge'] <= '2019-12-01')]

# Univariate analysis
uni_1 = Univariate(np.array(test_data_1[['emrwd', 'ROE(TTM)', 'Date_merge']]), number=9)
uni_1.summary_and_test()
uni_1.print_summary_by_time()
uni_1.print_summary()
====================================================================================================
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |  Diff |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| Average | 0.012 | 0.011 | 0.013 | 0.013 | 0.013 | 0.015 | 0.016 | 0.015 | 0.017 | 0.017 | 0.005 |
|  T-Test | 1.465 | 1.372 | 1.648 | 1.826 | 1.884 | 2.048 | 2.354 |  2.3  | 2.548 | 2.494 | 1.473 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
====================================================================================================

# Bivariate analysis
bi_1 = Bivariate(np.array(test_data_1), number=4)
bi_1.average_by_time()
bi_1.summary_and_test()
bi_1.print_summary_by_time()
bi_1.print_summary()
===============================================================
+-------+--------+--------+--------+--------+--------+-------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff |
+-------+--------+--------+--------+--------+--------+-------+
|   1   | 0.014  | 0.017  | 0.021  | 0.023  |  0.02  | 0.006 |
|       | 1.683  | 2.197  | 2.712  | 3.026  | 2.519  | 2.308 |
|   2   | 0.014  | 0.015  | 0.017  | 0.018  | 0.019  | 0.005 |
|       | 1.702  | 1.895  | 2.228  | 2.604  | 2.567  | 1.699 |
|   3   | 0.008  | 0.011  | 0.012  | 0.016  | 0.018  |  0.01 |
|       | 1.091  | 1.373  | 1.712  | 2.246  | 2.624  | 3.775 |
|   4   | 0.008  | 0.011  |  0.01  | 0.014  | 0.016  | 0.008 |
|       | 1.002  | 1.442  | 1.468  | 2.109  | 2.305  |  2.41 |
|   5   | 0.004  | 0.009  | 0.008  |  0.01  | 0.016  | 0.012 |
|       | 0.565  | 1.271  | 1.257  | 1.613  | 2.417  | 3.234 |
|  Diff | -0.009 | -0.008 | -0.012 | -0.013 | -0.004 | 0.005 |
|       | -2.446 | -2.151 | -3.025 | -3.231 | -0.917 | 1.502 |
+-------+--------+--------+--------+--------+--------+-------+
===============================================================

```

The result from dataset #1 is interesting that in univariate analysis the differenced return is not significant since the t-value is below 2.3, while in bivariate analysis the differenced return in most part is significant since the t-value is greater than 2.3, suggesting that profitability factor provides excess return. 

```python
# %% construct test_data for bivariate analysis
# dataset 2 : tail stocks & ROE Bivariate  
from portfolio_analysis import Bivariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_2 = return_company[return_company['Ndaytrd']>=10]
test_data_2 = test_data_2[['emrwd', 'Msmvttl', 'ROE(TTM)', 'Date_merge']].dropna()
test_data_2 = test_data_2[(test_data_2['Date_merge'] >= '2004-01-01') & (test_data_2['Date_merge'] <= '2019-12-01')]

# Univariate analysis
uni_2 = Univariate(np.array(test_data_2[['emrwd', 'ROE(TTM)', 'Date_merge']]), number=9)
uni_2.summary_and_test()
uni_2.print_summary_by_time()
uni_2.print_summary()
====================================================================================================
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |  Diff |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| Average | 0.017 | 0.016 | 0.016 | 0.017 | 0.017 | 0.016 | 0.017 | 0.017 | 0.017 | 0.017 |  0.0  |
|  T-Test | 2.132 | 2.032 | 2.037 |  2.2  | 2.298 | 2.293 | 2.392 | 2.549 | 2.586 | 2.572 | 0.019 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
====================================================================================================

# analysis
bi_2 = Bivariate(np.array(test_data_2), number=4)
bi_2.average_by_time()
bi_2.summary_and_test()
bi_2.print_summary_by_time()
bi_2.print_summary()
================================================================
+-------+--------+--------+--------+--------+--------+--------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff  |
+-------+--------+--------+--------+--------+--------+--------+
|   1   | 0.025  | 0.026  | 0.026  | 0.028  | 0.024  | -0.001 |
|       | 3.043  | 3.195  | 3.306  | 3.489  | 2.874  | -0.434 |
|   2   | 0.015  | 0.018  | 0.019  | 0.023  | 0.021  | 0.006  |
|       | 1.833  | 2.238  | 2.488  | 3.105  | 2.701  | 2.495  |
|   3   | 0.013  | 0.011  | 0.016  | 0.017  | 0.019  | 0.006  |
|       | 1.626  | 1.466  | 2.135  |  2.38  |  2.65  | 2.073  |
|   4   | 0.009  | 0.011  | 0.012  | 0.015  | 0.016  | 0.008  |
|       | 1.086  | 1.359  | 1.656  | 2.101  | 2.394  | 2.546  |
|   5   | 0.006  | 0.008  | 0.009  |  0.01  | 0.015  |  0.01  |
|       | 0.748  | 1.091  | 1.321  | 1.638  | 2.377  | 2.831  |
|  Diff | -0.019 | -0.018 | -0.017 | -0.018 | -0.009 | 0.011  |
|       | -4.676 | -4.202 | -3.963 | -3.927 | -1.68  | 2.951  |
+-------+--------+--------+--------+--------+--------+--------+
================================================================

```

The result from dataset #2 is interesting that in univariate analysis the differenced return is not significant since the t-value is below 2.3, while in bivariate analysis the differenced return in most part is significant since the t-value is greater than 2.3, suggesting that profitability factor provides excess return. 



#### Investment Factor

The investment factor gradually becomes popular since the introduction by Fama and French (2015). It is also included in the HXZ's model (2015) and Zhang (2017) expands it to ICAPM. Before its popularity, Titman et al. (2014) is among the early research of the factor, who use abnormal capital investment as proxy variable. However, in subsequent literature, most research uses asset growth rate as proxy variable, including Fama and French (2015) and Hou et al. (2015). In market of developed countries, investment factor is negatively correlated with future return, while in most developing country, the relation is much more tender. In China market, there exists no significant investment effect by most literatures (Guo et al., 2017; Qiao, 2019; Liu et al., 2019).

In this demo, annual asset growth rate is used as the proxy variable for profitability factor, which is calculated from the financial data and derivative ratios. The dataset starts from Jan, 2004 and is collected from CSMAR dataset. **WARNING: Do Not use dataset in this demo for any commercial purpose.** 

```python
# %% import package
from numpy import dtype
import pandas as pd
import sys, os

sys.path.append(os.path.abspath(".."))

# %% import data
# Monthly return of stocks in China security market
month_return = pd.read_hdf('.\data\month_return.h5', key='month_return')
company_data = pd.read_hdf('.\data\last_filter_pe.h5', key='data')
```

The data needs some preprocessing.

```python
# %% preprocessing data
# forward the monthly return for each stock
# emrwd is the return including dividend
month_return['emrwd'] = month_return.groupby(['Stkcd'])['Mretwd'].shift(-1)
# emrnd is the return including no dividend
month_return['emrnd'] = month_return.groupby(['Stkcd'])['Mretnd'].shift(-1)
# select the A share stock
month_return = month_return[month_return['Markettype'].isin([1, 4, 16])]

# % distinguish the stocks whose size is among the up 30% stocks in each month
def percentile(stocks) :
    return stocks >= stocks.quantile(q=.3)

month_return['cap'] = month_return.groupby(['Trdmnt'])['Msmvttl'].apply(percentile)
```

Annual asset growth rate is used as the proxy variable for profitability factor, which is calculated from the financial data and derivative ratios. 

```python
# %% calculate the total asset
# asset = debt + equity
# debt = company_value - market_value
# equity = market_value / PB
company_data['debt'] = company_data['EV1'] - company_data['MarketValue']
company_data['equity'] = company_data['MarketValue']/company_data['PBV1A']
company_data['asset'] = company_data['debt'] + company_data['equity']

# asset growth rate
company_data['asset_growth_rate'] = company_data['asset'].groupby(['Symbol']).diff(12)/company_data['asset']
```

Continue data preprocessing.

```python
# %% prepare merge data
from pandas.tseries.offsets import *

month_return['Stkcd_merge'] = month_return['Stkcd'].astype(dtype='string')
month_return['Date_merge'] = pd.to_datetime(month_return['Trdmnt'])
#month_return['Yearmonth'] = month_return['Date_merge'].map(lambda x : 1000*x.year + x.month)
#month_return['Date_merge'] += MonthEnd()

company_data['Stkcd_merge'] = company_data['Symbol'].dropna().astype(dtype='int').astype(dtype='string')
company_data['Date_merge'] = pd.to_datetime(company_data['TradingDate'])
#company_data['Yearmonth'] = company_data['Date_merge'].map(lambda x : 1000*x.year + x.month)
company_data['Date_merge'] += MonthBegin()

# %% dataset starts from '2000-01'
company_data = company_data[company_data['Date_merge'] >= '2000-01']
month_return = month_return[month_return['Date_merge'] >= '2000-01']
return_company = pd.merge(company_data, month_return, on=['Stkcd_merge', 'Date_merge'])
```

Two datasets are constituted. One includes tail 30% stock, while one includes not. Univariate analysis and Bivariate analysis are attached.

```python
# %% construct test_data for bivariate analysis
# dataset 1 : no tail stocks & ROE Bivariate
from portfolio_analysis import Bivariate, Univariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_1 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
test_data_1 = test_data_1[['emrwd', 'Msmvttl', 'asset_growth_rate', 'Date_merge']].dropna()
test_data_1 = test_data_1[(test_data_1['Date_merge'] >= '2004-01-01') & (test_data_1['Date_merge'] <= '2019-12-01')]

# Univariate analysis
uni_1 = Univariate(np.array(test_data_1[['emrwd', 'asset_growth_rate', 'Date_merge']]), number=9)
uni_1.summary_and_test()
uni_1.print_summary_by_time()
uni_1.print_summary()
====================================================================================================
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |  Diff |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| Average | 0.011 | 0.012 | 0.013 | 0.013 | 0.015 | 0.014 | 0.013 | 0.015 | 0.015 | 0.016 | 0.005 |
|  T-Test | 1.393 | 1.655 | 1.783 | 1.879 | 2.054 | 1.985 | 1.955 | 2.162 | 2.064 | 2.152 | 1.907 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
====================================================================================================

# Bivariate analysis
bi_1 = Bivariate(np.array(test_data_1), number=4)
bi_1.average_by_time()
bi_1.summary_and_test()
bi_1.print_summary_by_time()
bi_1.print_summary()
==============================================================
+-------+--------+--------+--------+--------+--------+-------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff |
+-------+--------+--------+--------+--------+--------+-------+
|   1   | 0.015  | 0.017  | 0.018  | 0.018  |  0.02  | 0.005 |
|       | 1.848  | 2.119  | 2.336  | 2.404  | 2.482  | 1.985 |
|   2   | 0.012  | 0.014  | 0.017  | 0.015  | 0.019  | 0.007 |
|       | 1.509  | 1.784  | 2.301  | 1.984  | 2.434  |  2.8  |
|   3   |  0.01  | 0.012  | 0.015  | 0.014  | 0.014  | 0.004 |
|       | 1.314  | 1.695  | 2.026  | 1.884  | 1.912  | 1.862 |
|   4   | 0.009  |  0.01  | 0.011  | 0.013  | 0.015  | 0.006 |
|       | 1.194  | 1.507  | 1.579  | 1.831  | 2.009  |  2.45 |
|   5   | 0.007  |  0.01  | 0.011  | 0.014  | 0.012  | 0.005 |
|       |  1.03  | 1.517  | 1.685  | 2.106  | 1.749  |  1.7  |
|  Diff | -0.008 | -0.007 | -0.008 | -0.005 | -0.007 |  0.0  |
|       | -1.902 | -1.646 | -1.897 | -1.213 | -1.771 | 0.088 |
+-------+--------+--------+--------+--------+--------+-------+
==============================================================
```

The result from dataset #1 is consistent with literatures that in univariate analysis the differenced return is not significant since the t-value is below 2.3, while in bivariate analysis the differenced return in most part is insignificant since the t-value is less than 2.3, suggesting that investment factor provides no excess return. 

```python
# %% construct test_data for bivariate analysis
# dataset 2 : tail stocks & ROE Bivariate  
from portfolio_analysis import Bivariate, Univariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_2 = return_company[return_company['Ndaytrd']>=10]
test_data_2 = test_data_2[['emrwd', 'Msmvttl', 'asset_growth_rate', 'Date_merge']].dropna()
test_data_2 = test_data_2[(test_data_2['Date_merge'] >= '2004-01-01') & (test_data_2['Date_merge'] <= '2019-12-01')]

# Univariate analysis
uni_2 = Univariate(np.array(test_data_2[['emrwd', 'asset_growth_rate', 'Date_merge']]), number=9)
uni_2.summary_and_test()
uni_2.print_summary_by_time()
uni_2.print_summary()
====================================================================================================
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |  Diff |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| Average | 0.017 | 0.017 | 0.017 | 0.017 | 0.017 | 0.017 | 0.016 | 0.017 | 0.017 | 0.018 | 0.001 |
|  T-Test | 2.052 | 2.204 | 2.301 | 2.303 | 2.323 |  2.33 | 2.249 | 2.392 | 2.283 | 2.411 | 0.313 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
====================================================================================================

# Bivariate analysis
bi_2 = Bivariate(np.array(test_data_2), number=4)
bi_2.average_by_time()
bi_2.summary_and_test()
bi_2.print_summary_by_time()
bi_2.print_summary()
===============================================================
+-------+--------+--------+--------+--------+--------+-------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff |
+-------+--------+--------+--------+--------+--------+-------+
|   1   | 0.027  | 0.026  | 0.027  | 0.027  | 0.027  |  0.0  |
|       | 3.113  |  3.25  | 3.257  | 3.312  | 3.372  | 0.079 |
|   2   | 0.015  | 0.019  |  0.02  | 0.021  | 0.021  | 0.006 |
|       | 1.885  | 2.331  | 2.482  | 2.706  | 2.674  | 2.551 |
|   3   | 0.012  | 0.014  | 0.017  | 0.015  | 0.017  | 0.005 |
|       | 1.561  | 1.788  | 2.198  | 2.067  | 2.286  | 2.264 |
|   4   | 0.009  |  0.01  | 0.013  | 0.013  | 0.015  | 0.005 |
|       | 1.271  | 1.475  | 1.745  | 1.888  | 1.999  | 2.397 |
|   5   | 0.007  | 0.011  |  0.01  | 0.012  | 0.013  | 0.006 |
|       | 0.987  | 1.729  | 1.582  | 1.882  |  1.83  |  2.2  |
|  Diff | -0.02  | -0.015 | -0.017 | -0.014 | -0.014 | 0.006 |
|       | -4.431 | -3.522 | -3.695 | -3.205 | -3.197 | 1.813 |
+-------+--------+--------+--------+--------+--------+-------+
===============================================================
```

The result from dataset #2 is consistent with literatures that in univariate analysis the differenced return is not significant since the t-value is below 2.3, while in bivariate analysis the differenced return in most part is insignificant since the t-value is less than 2.3, suggesting that investment factor provides no excess return. 



#### Momentum Effect

The momentum factor starts from Jegadeesh and Titman (1993) and exists widely in global stock markets (Jegadeesh and Titman, 2001; Rouwenhorst, 1998, 1999; De Groot et al., 2012; Asness et al., 2013) as well as in other markets, like commodity market (Narayan et al., 2015) and bond market (Isreal et al., 2018). However, in China stock market, it is suggested that there exist no such effect (Liu and Lee, 2001; Li et al., 2010).

The momentum effect is quite simple that stocks perform well in past would continue good performance in the future and vice versa. The conventional proxy variable for momentum effect is total yield from past 12 month to past 1 month. Since there may exist short term reversal effect, the last month yield is excluded.

In this demo, the conventional proxy variable in preceding text is chosen. The dataset starts from Jan, 2000 and is collected from CSMAR dataset. **WARNING: Do Not use dataset in this demo for any commercial purpose.** 

```python
# %% import package
import pandas as pd
import sys, os

sys.path.append(os.path.abspath(".."))

# %% import data
# Monthly return of stocks in China security market
month_return = pd.read_hdf('.\data\month_return.h5', key='month_return')
#month_return = month_return.set_index(['Stkcd', 'Trdmnt'], drop=False)
```

Data need some preprocessing.

```python
# %% preprocessing data
# forward the monthly return for each stock
# emrwd is the return including dividend
month_return['emrwd'] = month_return.groupby(['Stkcd'])['Mretwd'].shift(-1)
# emrnd is the return including no dividend
month_return['emrnd'] = month_return.groupby(['Stkcd'])['Mretnd'].shift(-1)
# select the A share stock
month_return = month_return[month_return['Markettype'].isin([1, 4, 16])]

# % distinguish the stocks whose size is among the up 30% stocks in each month
def percentile(stocks) :
    return stocks >= stocks.quantile(q=.3)

month_return['cap'] = month_return.groupby(['Trdmnt'])['Msmvttl'].apply(percentile)
```

Construct momentum proxy variable.

```python
# %% construct momentum variable
import numpy as np

month_return['rolling_12'] = np.array(month_return.groupby(['Stkcd'])['Mretwd'].rolling(12).sum())
month_return['momentum'] = month_return['rolling_12'] - month_return['Mretwd']
```

Attach some further data preprocessing.

```python
# %% construct label
month_return['Stkcd_merge'] = month_return['Stkcd'].astype(dtype='string')
month_return['Date_merge'] = pd.to_datetime(month_return['Trdmnt'])
# data starts from 2000-01
return_company = month_return[month_return['Date_merge']>='2000-01']
```

Two datasets are constituted. One includes tail 30% stock, while one includes not. Univariate analysis and Bivariate analysis are attached.

```python
# %% construct test_data for bivariate analysis
# dataset 1
from portfolio_analysis import Bivariate, Univariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_1 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
test_data_1 = test_data_1[['emrwd', 'Msmvttl', 'momentum', 'Date_merge']].dropna()
test_data_1 = test_data_1[(test_data_1['Date_merge'] >= '2000-01-01') & (test_data_1['Date_merge'] <= '2019-12-01')]

# Univariate analysis
uni_1 = Univariate(np.array(test_data_1[['emrwd', 'momentum', 'Date_merge']]), number=9)
uni_1.summary_and_test()
uni_1.print_summary_by_time()
uni_1.print_summary()
===================================================================================================
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+------+-------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |  10  |  Diff |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+------+-------+
| Average | 0.008 |  0.01 |  0.01 | 0.012 | 0.011 | 0.011 | 0.011 | 0.012 | 0.011 | 0.01 | 0.002 |
|  T-Test | 1.304 | 1.542 | 1.625 | 1.935 |  1.86 | 1.874 | 1.849 | 1.944 | 1.779 | 1.63 | 0.517 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+------+-------+
===================================================================================================

# Bivariate analysis
bi_1 = Bivariate(np.array(test_data_1), number=4)
bi_1.average_by_time()
bi_1.summary_and_test()
bi_1.print_summary_by_time()
bi_1.print_summary()
==============================================================
+-------+--------+--------+--------+--------+--------+-------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff |
+-------+--------+--------+--------+--------+--------+-------+
|   1   | 0.012  | 0.015  | 0.014  | 0.015  | 0.013  | 0.001 |
|       | 1.781  | 2.256  |  2.24  | 2.234  | 1.916  | 0.467 |
|   2   |  0.01  | 0.013  | 0.012  | 0.012  | 0.011  |  0.0  |
|       | 1.599  | 2.074  | 1.873  | 1.836  | 1.613  |  0.14 |
|   3   | 0.009  | 0.009  | 0.009  | 0.011  |  0.01  | 0.001 |
|       |  1.42  | 1.514  | 1.447  | 1.711  |  1.58  | 0.329 |
|   4   | 0.007  | 0.008  |  0.01  | 0.011  | 0.008  | 0.002 |
|       | 1.064  | 1.401  | 1.735  | 1.831  | 1.378  | 0.492 |
|   5   | 0.006  | 0.008  | 0.009  | 0.008  | 0.009  | 0.003 |
|       | 1.002  | 1.395  |  1.58  | 1.403  |  1.67  |  0.99 |
|  Diff | -0.006 | -0.007 | -0.006 | -0.007 | -0.004 | 0.002 |
|       | -1.875 | -2.071 | -1.829 | -1.895 | -1.016 | 0.584 |
+-------+--------+--------+--------+--------+--------+-------+
```

The result from dataset #1 is consistent with literatures that in univariate analysis the differenced return is insignificant since the t-value is below 2.3, while in bivariate analysis the differenced return in most part is insignificant since the t-value is less than 2.3, suggesting that momentum factor provides no excess return. 

```python
# %% construct test_data for bivariate analysis
# dataset 2
from portfolio_analysis import Bivariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_2 = return_company[return_company['Ndaytrd']>=10]
test_data_2 = test_data_2[['emrwd', 'Msmvttl', 'momentum', 'Date_merge']].dropna()
test_data_2 = test_data_2[(test_data_2['Date_merge'] >= '2005-01-01') & (test_data_2['Date_merge'] <= '2019-12-01')]

# Univariate analysis
uni_2 = Univariate(np.array(test_data_1[['emrwd', 'momentum', 'Date_merge']]), number=9)
uni_2.summary_and_test()
uni_2.print_summary_by_time()
uni_2.print_summary()
===================================================================================================
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+------+-------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |  10  |  Diff |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+------+-------+
| Average | 0.008 |  0.01 |  0.01 | 0.012 | 0.011 | 0.011 | 0.011 | 0.012 | 0.011 | 0.01 | 0.002 |
|  T-Test | 1.304 | 1.542 | 1.625 | 1.935 |  1.86 | 1.874 | 1.849 | 1.944 | 1.779 | 1.63 | 0.517 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+------+-------+
===================================================================================================

# Bivariate analysis
bi_2 = Bivariate(np.array(test_data_2), number=4)
bi_2.average_by_time()
bi_2.summary_and_test()
bi_2.print_summary_by_time()
bi_2.print_summary()
=================================================
+-------+--------+--------+--------+--------+--------+--------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff  |
+-------+--------+--------+--------+--------+--------+--------+
|   1   | 0.037  | 0.033  | 0.033  | 0.032  | 0.034  | -0.003 |
|       | 3.631  | 3.617  | 3.778  | 3.489  | 3.164  | -0.953 |
|   2   |  0.02  | 0.023  | 0.023  | 0.023  |  0.02  |  0.0   |
|       | 2.359  | 2.748  | 2.837  | 2.712  | 2.307  | 0.057  |
|   3   | 0.017  |  0.02  | 0.018  | 0.017  | 0.018  | 0.001  |
|       | 2.077  | 2.441  | 2.355  | 2.136  | 2.107  | 0.281  |
|   4   | 0.014  | 0.013  | 0.015  | 0.016  | 0.016  | 0.002  |
|       | 1.702  | 1.798  | 1.975  | 2.047  | 2.029  | 0.687  |
|   5   |  0.01  | 0.013  | 0.014  | 0.012  | 0.013  | 0.003  |
|       | 1.424  | 1.859  | 2.104  | 1.751  | 1.824  | 0.654  |
|  Diff | -0.026 | -0.02  | -0.018 | -0.02  | -0.021 | 0.006  |
|       | -4.106 | -3.852 | -4.186 | -3.809 | -2.916 | 1.186  |
+-------+--------+--------+--------+--------+--------+--------+
```

The result from dataset #2 is consistent with literatures that in univariate analysis the differenced return is insignificant since the t-value is below 2.3, while in bivariate analysis the differenced return in most part is insignificant since the t-value is less than 2.3, suggesting that momentum factor provides no excess return. 



#### Turnover Factor

Trading volume would effect the stock performance, which has a long history in industry while in academic research is burgeoning. Instead of trading volume, turnover is a standard substitution. The common sense is that turnover is generally negative correlated with the future return (Chordia et al., 2001). While Subrahmanyam (2005) found the asymmetric structure that for poor performance stock, the correlation is negative; for good performance stock, the correlation is positive. In other global market, Hu (1997) and Chang et al. (2010) find negative correlation in Japan market; Dey (2005) find positive correlation in emerging market. In China market, Liu et al. (2019) find negative correlation, which can explain the short term reversal effect.

In this demo, the proxy variable for turnover factor is abnormal turnover, which is the ratio of average turnover in past 1 month to average turnover in past 12 month. he dataset starts from Jan, 2000 and is collected from CSMAR dataset. **WARNING: Do Not use dataset in this demo for any commercial purpose.** 

```python
# %% import package
import pandas as pd
import sys, os

sys.path.append(os.path.abspath(".."))

# %% import data
# Monthly return of stocks in China security market
month_return = pd.read_hdf('.\data\month_return.h5', key='month_return')
trade_data = pd.read_hdf('.\data\mean_filter_trade.h5', key='data')
```

Conduct some data preprocessing.

```python
# %% preprocessing data
# forward the monthly return for each stock
# emrwd is the return including dividend
month_return['emrwd'] = month_return.groupby(['Stkcd'])['Mretwd'].shift(-1)
# emrnd is the return including no dividend
month_return['emrnd'] = month_return.groupby(['Stkcd'])['Mretnd'].shift(-1)
# select the A share stock
month_return = month_return[month_return['Markettype'].isin([1, 4, 16])]

# % distinguish the stocks whose size is among the up 30% stocks in each month
def percentile(stocks) :
    return stocks >= stocks.quantile(q=.3)

month_return['cap'] = month_return.groupby(['Trdmnt'])['Msmvttl'].apply(percentile)
```

Construct the proxy variable.

```python
# %% constrcut variable
import numpy as np
trade_data['rolling_Turnover'] = np.array(trade_data['Turnover'].groupby('Symbol').rolling(12).mean())
trade_data['specific_Turnover'] = trade_data['Turnover'] / trade_data['rolling_Turnover']
```

Some further data processing.

```python
# %% prepare merge data
from pandas.tseries.offsets import *

month_return['Stkcd_merge'] = month_return['Stkcd'].astype(dtype='string')
month_return['Date_merge'] = pd.to_datetime(month_return['Trdmnt'])
#month_return['Yearmonth'] = month_return['Date_merge'].map(lambda x : 1000*x.year + x.month)
#month_return['Date_merge'] += MonthEnd()

trade_data['Stkcd_merge'] = trade_data['Symbol'].dropna().astype(dtype='int').astype(dtype='string')
trade_data['TradingDate'] = trade_data.index.map(lambda x : x[1])
trade_data['Date_merge'] = pd.to_datetime(trade_data['TradingDate'])
#company_data['Yearmonth'] = company_data['Date_merge'].map(lambda x : 1000*x.year + x.month)
trade_data['Date_merge'] += MonthBegin()

# %% dataset starts from '2000-01'
trade_data = trade_data[trade_data['Date_merge'] >= '2000-01']
month_return = month_return[month_return['Date_merge'] >= '2000-01']
return_company = pd.merge(trade_data, month_return, on=['Stkcd_merge', 'Date_merge'])
```

Two datasets are constituted. One includes tail 30% stock, while one includes not. Univariate analysis and Bivariate analysis are attached.

```python
# %% construct test_data for bivariate analysis
# dataset 1 : 
from portfolio_analysis import Bivariate, Univariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_1 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
test_data_1 = test_data_1[['emrwd', 'Msmvttl', 'specific_Turnover', 'Date_merge']].dropna()
test_data_1 = test_data_1[(test_data_1['Date_merge'] >= '2000-01-01') & (test_data_1['Date_merge'] <= '2019-12-01')]

# Univariate analysis
uni_1 = Univariate(np.array(test_data_1[['emrwd', 'specific_Turnover', 'Date_merge']]), number=9)
uni_1.summary_and_test()
uni_1.print_summary_by_time()
uni_1.print_summary()
=====================================================================================================
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |  Diff  |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| Average | 0.009 | 0.011 | 0.012 | 0.013 | 0.012 | 0.012 | 0.011 | 0.011 | 0.009 | 0.005 | -0.004 |
|  T-Test | 1.644 | 1.945 | 2.088 | 2.132 |  2.02 | 1.997 |  1.87 |  1.74 | 1.545 | 0.841 | -1.426 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
=====================================================================================================

# Bivariate analysis
bi_1 = Bivariate(np.array(test_data_1), number=4)
bi_1.average_by_time()
bi_1.summary_and_test()
bi_1.print_summary_by_time()
bi_1.print_summary()
================================================================
+-------+--------+--------+--------+--------+--------+--------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff  |
+-------+--------+--------+--------+--------+--------+--------+
|   1   | 0.014  | 0.016  | 0.015  | 0.014  | 0.009  | -0.004 |
|       | 2.153  | 2.447  | 2.307  | 2.139  | 1.412  | -1.827 |
|   2   | 0.011  | 0.013  | 0.013  | 0.011  | 0.009  | -0.002 |
|       | 1.878  | 2.081  | 2.029  | 1.661  | 1.364  | -0.882 |
|   3   |  0.01  |  0.01  | 0.011  |  0.01  | 0.005  | -0.005 |
|       | 1.732  | 1.628  | 1.768  | 1.665  | 0.842  | -1.928 |
|   4   | 0.009  | 0.011  |  0.01  | 0.009  | 0.007  | -0.002 |
|       | 1.656  | 1.857  | 1.679  | 1.587  |  1.13  | -0.723 |
|   5   | 0.008  | 0.011  |  0.01  | 0.009  | 0.005  | -0.003 |
|       | 1.515  | 2.045  | 1.935  |  1.63  | 0.854  | -1.275 |
|  Diff | -0.005 | -0.005 | -0.004 | -0.005 | -0.005 | 0.001  |
|       | -1.561 | -1.536 | -1.264 | -1.361 | -1.333 | 0.367  |
+-------+--------+--------+--------+--------+--------+--------+
================================================================
```

The result from dataset #1 is not completely consistent with literatures that in univariate analysis the differenced return is insignificant since the absolute t-value is below 2.3, while in bivariate analysis the differenced return in most part is insignificant since the absolute t-value is less than 2.3, suggesting that turnover factor provides no excess return.

```python
# %% construct test_data for bivariate analysis
# dataset 2 : 
from portfolio_analysis import Bivariate
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_2 = return_company[return_company['Ndaytrd']>=10]
test_data_2 = test_data_2[['emrwd', 'Msmvttl', 'specific_Turnover', 'Date_merge']].dropna()
test_data_2 = test_data_2[(test_data_2['Date_merge'] >= '2004-01-01') & (test_data_2['Date_merge'] <= '2019-12-01')]

# Univariate analysis
uni_2 = Univariate(np.array(test_data_2[['emrwd', 'specific_Turnover', 'Date_merge']]), number=9)
uni_2.summary_and_test()
uni_2.print_summary_by_time()
uni_2.print_summary()
=====================================================================================================
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
|  Group  |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |  Diff  |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| Average | 0.016 | 0.018 | 0.019 |  0.02 | 0.019 | 0.019 | 0.018 | 0.016 | 0.016 | 0.012 | -0.004 |
|  T-Test | 2.218 | 2.511 |  2.59 | 2.648 | 2.566 | 2.555 | 2.422 | 2.217 | 2.077 | 1.454 | -1.353 |
+---------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
=====================================================================================================

# Bivariate analysis
bi_2 = Bivariate(np.array(test_data_2), number=4)
bi_2.average_by_time()
bi_2.summary_and_test()
bi_2.print_summary_by_time()
bi_2.print_summary()
================================================================
+-------+--------+--------+--------+--------+--------+--------+
| Group |   1    |   2    |   3    |   4    |   5    |  Diff  |
+-------+--------+--------+--------+--------+--------+--------+
|   1   | 0.029  |  0.03  | 0.033  | 0.026  | 0.025  | -0.004 |
|       | 3.507  | 3.455  | 3.075  | 3.203  | 2.579  | -1.289 |
|   2   | 0.018  | 0.021  | 0.022  | 0.018  | 0.013  | -0.004 |
|       | 2.334  | 2.697  | 2.715  | 2.257  | 1.631  | -1.955 |
|   3   | 0.015  | 0.016  | 0.017  | 0.015  | 0.012  | -0.003 |
|       | 2.115  | 2.237  | 2.255  | 1.969  | 1.529  | -1.119 |
|   4   | 0.012  | 0.013  | 0.013  | 0.014  | 0.009  | -0.003 |
|       |  1.86  | 1.759  | 1.822  | 1.858  | 1.177  | -1.216 |
|   5   | 0.011  | 0.015  | 0.012  | 0.012  | 0.009  | -0.002 |
|       | 1.729  | 2.289  | 1.812  | 1.752  | 1.254  | -0.724 |
|  Diff | -0.018 | -0.015 | -0.021 | -0.015 | -0.016 | 0.002  |
|       | -3.758 | -3.114 | -2.752 | -3.186 | -2.481 |  0.48  |
+-------+--------+--------+--------+--------+--------+--------+
```

The result from dataset #2 is not completely consistent with literatures that in univariate analysis the differenced return is insignificant since the absolute t-value is below 2.3, while in bivariate analysis the differenced return in most part is insignificant since the absolute t-value is less than 2.3, suggesting that turnover factor provides no excess return.



### fama_macbeth

#### Factor mimicking portfolio

##### factor: Size (SMB) and Value (HML)

Following Fama and French (1993), the SMB and HML portfolio and corresponding risk premium are calculated through the class **Factor_mimicking_portfolio.** The detail are introduced in EAP.fama_macbeth.Factor_mimicking_portfolio.

The data are collected from CSMAR dataset, by which SMB and HML in China stock market is constituted. **WARNING: Do Not use dataset in this demo for any commercial purpose.** 

```python
import sys,os
sys.path.append(os.path.abspath(".."))

# %% import data
# Monthly return of stocks in China security market
import pandas as pd

month_return = pd.read_hdf('.\data\month_return.h5', key='month_return')
company_data = pd.read_hdf('.\data\last_filter_pe.h5', key='data')
trade_data = pd.read_hdf('.\data\mean_filter_trade.h5', key='data')
```

Data need some preprocessing.

```python
# %% data preprocessing
# select the A share stock
month_return = month_return[month_return['Markettype'].isin([1, 4, 16])]

# % distinguish the stocks whose size is among the up 30% stocks in each month
def percentile(stocks) :
    return stocks >= stocks.quantile(q=.3)

month_return['cap'] = month_return.groupby(['Trdmnt'])['Msmvttl'].apply(percentile)
```

Construct proxy variable

```python
# %% Construct proxy variable
import numpy as np

# RMW
# in this demo, the ROE(TTM) are used
# ROE(TTM) = PBV1B/PE(TTM) 
company_data['ROE(TTM)'] = company_data['PBV1B']/company_data['PE1TTM']

# CMA
# % calculate the total asset
# asset = debt + equity
# debt = company_value - market_value
# equity = market_value / PB
company_data['debt'] = company_data['EV1'] - company_data['MarketValue']
company_data['equity'] = company_data['MarketValue']/company_data['PBV1A']
company_data['asset'] = company_data['debt'] + company_data['equity']
# asset growth rate
company_data['asset_growth_rate'] = company_data['asset'].groupby(['Symbol']).diff(12)/company_data['asset']

# Momentum
month_return['rolling_12'] = np.array(month_return.groupby(['Stkcd'])['Mretwd'].rolling(12).sum())
month_return['momentum'] = month_return['rolling_12'] - month_return['Mretwd']

# Turnover  
trade_data['rolling_Turnover'] = np.array(trade_data['Turnover'].groupby('Symbol').rolling(12).mean())
trade_data['specific_Turnover'] = trade_data['Turnover'] / trade_data['rolling_Turnover']
```

Some further data preprocessing.

```python
# %% merge data
from pandas.tseries.offsets import *

month_return['Stkcd_merge'] = month_return['Stkcd'].astype(dtype='string')
month_return['Date_merge'] = pd.to_datetime(month_return['Trdmnt'])
#month_return['Date_merge'] += MonthEnd()

company_data['Stkcd_merge'] = company_data['Symbol'].dropna().astype(dtype='int').astype(dtype='string')
company_data['Date_merge'] = pd.to_datetime(company_data['TradingDate'])
company_data['Date_merge'] += MonthBegin()

trade_data['Stkcd_merge'] = trade_data['Symbol'].dropna().astype(dtype='int').astype(dtype='string')
trade_data['TradingDate'] = trade_data.index.map(lambda x : x[1])
trade_data['Date_merge'] = pd.to_datetime(trade_data['TradingDate'])
#company_data['Yearmonth'] = company_data['Date_merge'].map(lambda x : 1000*x.year + x.month)
trade_data['Date_merge'] += MonthBegin()

# %% dataset starts from '2000-01'
company_data = company_data[company_data['Date_merge'] >= '2000-01']
month_return = month_return[month_return['Date_merge'] >= '2000-01']
return_company = pd.merge(company_data, month_return, on=['Stkcd_merge', 'Date_merge'])
return_company = pd.merge(return_company, trade_data, on=['Stkcd_merge', 'Date_merge'])
```

Construct factor mimicking portfolio and calculate factor risk premium.

```python
# %% SMB and HML
from fama_macbeth import Factor_mimicking_portfolio as fmp
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_1 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
# construct data for univariate analysis
test_data_1 = test_data_1[['Mretwd', 'Msmvttl', 'PE1A', 'Date_merge', 'Msmvttl']].dropna()
test_data_1 = test_data_1[(test_data_1['Date_merge'] >= '2000-01-01') & (test_data_1['Date_merge'] <= '2019-12-01')]

# factor mimicking portfolio
fmp_1 = fmp(np.array(test_data_1))
SMB, HML = fmp_1.portfolio_return()
SMB = -SMB

plt.figure('SMB')
plt.plot(SMB, label='SMB')
plt.ylabel('risk premium')
plt.xlabel('time')
plt.legend()

plt.figure('HML')
plt.plot(HML, label='HML')
plt.ylabel('risk premium')
plt.xlabel('time')
plt.legend()
===========================================================
![SMB](G:\Python\EAP\demo\SMB.png)

```



##### factor: Profitability

The profitability factor (RMW) is constituted by the same procedure with HML, using proxy variable ROE(TTM).

```python
# Continue the previous code
# %% RMW
from fama_macbeth import Factor_mimicking_portfolio as fmp
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_2 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
# construct data for univariate analysis
test_data_2 = test_data_2[['Mretwd', 'Msmvttl', 'ROE(TTM)', 'Date_merge', 'Msmvttl']].dropna()
test_data_2 = test_data_2[(test_data_2['Date_merge'] >= '2004-01-01') & (test_data_2['Date_merge'] <= '2019-12-01')]

# factor mimicking portfolio
fmp_2 = fmp(np.array(test_data_2))
Row_fac, RMW = fmp_2.portfolio_return()

plt.figure('RMW')
plt.plot(RMW, label='RMW')
plt.ylabel('risk premium')
plt.xlabel('time')
plt.legend()
===============================================================
![RMW](G:\Python\EAP\demo\RMW.png)
```



##### factor: Investment

The investment factor (CMA) is constituted by the same procedure with HML, using proxy variable, asset_growth_rate.

```python
# %% CMA
from fama_macbeth import Factor_mimicking_portfolio as fmp
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_3 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
# construct data for univariate analysis
test_data_3 = test_data_3[['Mretwd', 'Msmvttl', 'asset_growth_rate', 'Date_merge', 'Msmvttl']].dropna()
test_data_3 = test_data_3[(test_data_3['Date_merge'] >= '2000-01-01') & (test_data_3['Date_merge'] <= '2019-12-01')]

# factor mimicking portfolio
fmp_3 = fmp(np.array(test_data_3))
Row_fac, CMA = fmp_3.portfolio_return()

plt.figure('CMA')
plt.plot(CMA, label='CMA')
plt.ylabel('risk premium')
plt.xlabel('time')
plt.legend()
==============================================================
![CMA](G:\Python\EAP\demo\CMA.png)
```



##### factor: Momentum

The momentum factor (MOM) is constituted by the same procedure with HML, using proxy variable, sum of past 12 month return.

```python
# %% Momentum
from fama_macbeth import Factor_mimicking_portfolio as fmp
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_4 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
# construct data for univariate analysis
test_data_4 = test_data_4[['Mretwd', 'Msmvttl', 'momentum', 'Date_merge', 'Msmvttl']].dropna()
test_data_4 = test_data_4[(test_data_4['Date_merge'] >= '2000-01-01') & (test_data_4['Date_merge'] <= '2019-12-01')]

# factor mimicking portfolio
fmp_4 = fmp(np.array(test_data_4))
Row_fac, MOM = fmp_4.portfolio_return()

plt.figure('MOM')
plt.plot(MOM, label='MOM')
plt.ylabel('risk premium')
plt.xlabel('time')
plt.legend()
===================================================
![MOM](G:\Python\EAP\demo\MOM.png)
```



##### factor: Turnover

The turnover factor (Turn) is constituted by the same procedure with HML, using proxy variable, abnormal turnover rate.

```python
# %% Turnover
from fama_macbeth import Factor_mimicking_portfolio as fmp
import numpy as np

# select stocks whose size is among the up 30% stocks in each month and whose trading 
# days are more than or equal to 10 days
test_data_5 = return_company[(return_company['cap']==True) & (return_company['Ndaytrd']>=10)]
# construct data for univariate analysis
test_data_5 = test_data_5[['Mretwd', 'Msmvttl', 'specific_Turnover', 'Date_merge', 'Msmvttl']].dropna()
test_data_5 = test_data_5[(test_data_5['Date_merge'] >= '2000-01-01') & (test_data_5['Date_merge'] <= '2019-12-01')]

# factor mimicking portfolio
fmp_5 = fmp(np.array(test_data_5))
Row_fac, Turn = fmp_5.portfolio_return()

plt.figure('Turnover')
plt.plot(Turn, label='Turnover')
plt.ylabel('risk premium')
plt.xlabel('time')
plt.legend()
=======================================================================
![Turn](G:\Python\EAP\demo\Turn.png)
```





